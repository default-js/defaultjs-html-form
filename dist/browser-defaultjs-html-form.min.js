!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=25)}([function(t,e,n){"use strict";n.r(e),n.d(e,"HTML_TAG_PREFIX",(function(){return i})),n.d(e,"TRIGGER_TIMEOUT",(function(){return r})),n.d(e,"EVENTHANDLE_TIMEOUT",(function(){return a})),n.d(e,"EVENTHANDLE_INPUT_TIMEOUT",(function(){return s})),n.d(e,"NODENAMES",(function(){return o})),n.d(e,"FORMSTATES",(function(){return l})),n.d(e,"REQUIREDSTATES",(function(){return u})),n.d(e,"EVENT_PREFIX",(function(){return c})),n.d(e,"EVENTS",(function(){return d})),n.d(e,"SPECIALVARS",(function(){return h})),n.d(e,"ATTRIBUTE_NAME",(function(){return f})),n.d(e,"ATTRIBUTE_ENDPOINT",(function(){return p})),n.d(e,"ATTRIBUTE_METHOD",(function(){return T})),n.d(e,"ATTRIBUTE_STATE",(function(){return E})),n.d(e,"ATTRIBUTE_STEP",(function(){return g})),n.d(e,"ATTRIBUTE_USE_SUMMARY_PAGE",(function(){return v})),n.d(e,"ATTRIBUTE_INPUT_MODE_AFTER_SUBMIT",(function(){return m})),n.d(e,"ATTRIBUTE_REQUIRED",(function(){return A})),n.d(e,"ATTRIBUTE_REQUIRED_ON_ACTIVE_ONLY",(function(){return y})),n.d(e,"ATTRIBUTE_CONDITION",(function(){return _})),n.d(e,"ATTRIBUTE_ACTIVE",(function(){return N})),n.d(e,"ATTRIBUTE_DISABLED",(function(){return b})),n.d(e,"ATTRIBUTE_EDITABLE",(function(){return S})),n.d(e,"ATTRIBUTE_EDITABLE_CONDITION",(function(){return I})),n.d(e,"ATTRIBUTE_READONLY",(function(){return O})),n.d(e,"ATTRIBUTE_NOVALUE",(function(){return R})),n.d(e,"ATTRIBUTE_VALID",(function(){return M})),n.d(e,"ATTRIBUTE_INVALID",(function(){return D})),n.d(e,"ATTRIBUTE_CONDITION_VALID",(function(){return V})),n.d(e,"ATTRIBUTE_CONDITION_INVALID",(function(){return w})),n.d(e,"ATTRIBUTE_MAX",(function(){return U})),n.d(e,"ATTRIBUTE_PROGRESS",(function(){return x}));const i="d-",r=10,a=10,s=50*a,o={Form:i+"form",Control:i+"control",BackButton:i+"control-back",NextButton:i+"control-next",SummaryButton:i+"control-summary",SubmitButton:i+"control-submit",CancelButton:i+"control-cancel",Page:i+"page",Field:i+"field",WrapperField:i+"wrapper-field",List:i+"list",ListRows:i+"rows",ListRow:i+"row",ButtonAddRow:i+"add-row",ButtonDeleteRow:i+"delete-row",Container:i+"container",Validation:i+"validation",Message:i+"message",ProgressBar:i+"progress-bar",Step:i+"step"},l={init:"init",input:"input",summary:"summary",finished:"finished"},u={always:"always",onActive:"on-active"},c=i+"form-",d={initialize:c+"initialize",input:c+"field-input",valueChanged:c+"field-value-changed",executeValidate:c+"execute-validate",activeStateChanged:c+"active-state-changed",conditionStateChanged:c+"condition-state-changed",validStateChanged:c+"valid-state-changed",siteChanged:c+"site-changed",formStateChanged:c+"state-changed",allPublishValue:c+"all-publish-value",submit:c+"submit",progressbarChanged:c+"progress-bar-changed",added:c+"added",change:c+"change",changeAttributeEventBuilder:t=>c+"change-attribute-"+t,changeActive:c+"change-active",changeValue:c+"change-value",changeCondition:c+"change-condition",changeValidation:c+"change-validation",listRowAdd:c+"list-row-add",listRowDelete:c+"list-row-delete",editableStateChanged:c+"editable-state-changed"},h={CURRENTVALUE:"$value",CURRENTLISTROW:"$item"},f="name",p="endpoint",T="method",E="state",g="step",v="use-summary-page",m="input-mode-after-submit",A="required",y="required-on-active-only",_="condition",N="active",b="disabled",S="editable",I="editable-condition",O="readonly",R="no-value",M="valid",D="invalid",V="condition-valid",w="condition-invalid",U="max",x="progress"},function(t,e,n){"use strict";n.r(e),e.default=t=>{window.customElements.get(t.NODENAME)||window.customElements.define(t.NODENAME,t)}},function(t,e,n){"use strict";n.r(e),n.d(e,"toEvents",(function(){return r})),n.d(e,"toTimeoutHandle",(function(){return a}));var i=n(0);const r=function(){return Array.from(arguments).join(" ")},a=(t,e,n,r)=>{let a=null;return function(s){a&&clearTimeout(a),a=setTimeout(()=>{a=null,t(s)},r||i.EVENTHANDLE_TIMEOUT),e&&s.preventDefault(),n&&s.stopPropagation()}}},function(t,e,n){"use strict";n.r(e);n(24);const i=(t,e)=>{let n="unsupported";if("string"==typeof e)n=e;else if(e instanceof HTMLElement)n=e.nodeName;else{if("string"!=typeof e.NODENAME)throw new Error(typeof e+" is not supported as pram node!");n=e.NODENAME}return n.toLowerCase()+"-"+t};const r=new class{constructor(){this.weakmap=new WeakMap}data(t){let e=this.weakmap.get(t);return e||(e={},this.weakmap.set(t,e)),e}value(t,e,n){if(2==arguments.length)return this.data(t)[e];this.data(t)[e]=n}};class a extends HTMLElement{constructor(){super(),this.ready=(()=>{let t,e=null;const n=new Promise((n,i)=>{t=n,e=i});return n.resolved=!1,n.error=!1,n.resolve=()=>{n.resolved=!0,n.resolve=()=>{},t()},n.reject=()=>{n.resolved=!0,n.error=!0,n.reject=()=>{},e()},n})()}async init(){}connectedCallback(){this.ownerDocument==document&&(t=>{const e=r.data(t);e.initialize&&clearTimeout(e.initialize),e.initialize=setTimeout(async()=>{delete e.initialize,await t.init(),t.ready.resolve(),t.trigger(i("initialzed",t))},100)})(this)}adoptedCallback(){this.connectedCallback()}attributeChangedCallback(t,e,n){e!=n&&this.isConnected&&(this.trigger(100,i("attribute--"+t,this)),this.trigger(100,i("change",this)))}}e.default=a},function(t,e,n){"use strict";n.r(e),n.d(e,"findParentField",(function(){return d}));var i=n(0),r=(n(2),n(7)),a=n(13),s=n(9),o=(n(17),n(10)),l=n(14);var u=class{constructor(t){this.inital=!0,this.base=t,this.customChecks=[],this.validations=Object(o.findValidations)(t)||[],this.condition=t.attr(i.ATTRIBUTE_CONDITION),this.editableCondition=t.attr(i.ATTRIBUTE_EDITABLE_CONDITION)}addCustomCheck(t){this.customChecks.push(t)}get form(){return this.base.form}async validate(){const{base:t,validations:e,customChecks:n,condition:a,editableCondition:o}=this,{hasValue:u,required:c,requiredOnlyOnActive:d}=t,h=(n.length>0||e.length,Object(l.evaluationData)(t)),f=!a||await s.default.resolve(a,h,!1);Object(r.updateConditionState)(t,f,this.inital);let p=!c||u;if(f){if(p)for(let e of n){await e({data:h,base:t})||(p=!1)}for(let t of e)if(p&&u){const e=await s.default.resolve(t.condition,h,!0);t.active=!e,e||(p=!1)}else t.active=!1;(async({data:t,valid:e,base:n,condition:r})=>{const{form:a}=n;if(a.state==i.FORMSTATES.input)if(e){if(r){const e=await s.default.resolve(r,t,!1);return n.editable=e,e}}else n.readonly=!1;return e})({data:h,valid:p,base:t,condition:o})||(p=!0),Object(r.updateValidState)(t,p,this.inital),this.inital=!1}return p}};const c=[i.ATTRIBUTE_NAME,i.ATTRIBUTE_REQUIRED,i.ATTRIBUTE_NOVALUE],d=t=>{let e=t.parentNode;for(;e;){if(e instanceof h)return e;e=e.parentNode}return null};class h extends a.default{static get observedAttributes(){return c.concat(a.default.observedAttributes)}constructor(t=null){super(),this.__value__=t}async init(){await this.initBaseField()}async initBaseField(){await this.initBase(),this.parentField=d(this),this.validator=new u(this),this.on(i.EVENTS.conditionStateChanged,t=>{t.target==this&&this.conditionUpdated()}),this.on(i.EVENTS.input,t=>{t.target==this&&(this.__value__=t.detail?t.detail[0]:null,this.validate(),this.publishValue())}),this.form.on(i.EVENTS.executeValidate,async t=>{if(t.detail[0].indexOf(this)<0){this.valid!=await this.validate()&&this.publishValue()}}),this.form.on(i.EVENTS.allPublishValue,()=>{this.publishValue()}),this.validate()}conditionUpdated(){this.active=this.condition}get name(){return this.getAttribute(i.ATTRIBUTE_NAME)}get required(){return this.hasAttribute(i.ATTRIBUTE_REQUIRED)}get hasValue(){const t=this.value;return null!=t&&void 0!==t}get value(){return this.__value__}set value(t){this.ready.then(()=>{this.__value__!=t&&this.acceptValue(t)&&(t=this.normalizeValue(t),this.__value__!=t&&(this.__value__=t,this.updatedValue(t),this.validate(),this.publishValue()))})}async validate(){var t;if(t=this.hasValue,this.attr(i.ATTRIBUTE_NOVALUE,t?null:""),!this.validator)return!1;return await this.validator.validate()}async publishValue(t=[]){t.push(this);let e=null;e=this.value,setTimeout(()=>{this.trigger(i.EVENTS.valueChanged,t)},i.TRIGGER_TIMEOUT)}acceptValue(t){return!0}normalizeValue(t){return t}async updatedValue(){}}e.default=h},function(t,e,n){"use strict";n.r(e);var i=n(0),r=n(3);const a=[i.ATTRIBUTE_ACTIVE,i.ATTRIBUTE_DISABLED];class s extends r.default{static get observedAttributes(){return a}static init(t){t.form=t.parent(i.NODENAMES.Form),t.active=!1,t.disabled=!1,t.on("click",e=>{t.active&&!t.disabled&&t.execute(),e.preventDefault(),e.stopPropagation()})}constructor(){super()}async init(){s.init(this)}get active(){return this.hasAttribute(i.ATTRIBUTE_ACTIVE)}set active(t){t?this.attr(i.ATTRIBUTE_ACTIVE,""):this.attr(i.ATTRIBUTE_ACTIVE,null)}get disabled(){return this.hasAttribute(i.ATTRIBUTE_DISABLED)}set disabled(t){t?this.attr(i.ATTRIBUTE_DISABLED,""):this.attr(i.ATTRIBUTE_DISABLED,null)}execute(){console.log("execute")}}e.default=s},function(t,e,n){"use strict";n.r(e),function(t){const n={global:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},globalVar:function(t,e){return 2===arguments.length&&void 0===n.global[t]&&(n.global[t]=e),n.global[t]}};e.default=n}.call(this,n(19))},function(t,e,n){"use strict";n.r(e),n.d(e,"updateValidState",(function(){return r})),n.d(e,"updateConditionState",(function(){return a})),n.d(e,"updateActiveState",(function(){return s})),n.d(e,"updateEditableState",(function(){return o}));var i=n(0);const r=(t,e,n=!1)=>{const r=t.valid;void 0===e||null==e?(t.attr(i.ATTRIBUTE_INVALID,null),t.attr(i.ATTRIBUTE_VALID,null)):e?(t.attr(i.ATTRIBUTE_INVALID,null),t.attr(i.ATTRIBUTE_VALID,"")):(t.attr(i.ATTRIBUTE_INVALID,""),t.attr(i.ATTRIBUTE_VALID,null)),(r!=e||n)&&t.trigger(i.TRIGGER_TIMEOUT,i.EVENTS.validStateChanged)},a=(t,e,n=!1)=>{const r=t.condition;e?(t.attr(i.ATTRIBUTE_CONDITION_INVALID,null),t.attr(i.ATTRIBUTE_CONDITION_VALID,"")):(t.attr(i.ATTRIBUTE_CONDITION_VALID,null),t.attr(i.ATTRIBUTE_CONDITION_INVALID,"")),(r!=e||n)&&t.trigger(i.TRIGGER_TIMEOUT,i.EVENTS.conditionStateChanged)},s=(t,e,n=!1)=>{const r=t.active;e?t.attr(i.ATTRIBUTE_ACTIVE,""):t.attr(i.ATTRIBUTE_ACTIVE,null),(r!=e||n)&&t.trigger(i.TRIGGER_TIMEOUT,i.EVENTS.activeStateChanged)},o=(t,e,n=!1)=>{const r=t.editable;e?(t.attr(i.ATTRIBUTE_EDITABLE,""),t.attr(i.ATTRIBUTE_READONLY,null)):(t.attr(i.ATTRIBUTE_EDITABLE,null),t.attr(i.ATTRIBUTE_READONLY,"")),(r!=e||n)&&t.trigger(i.TRIGGER_TIMEOUT,i.EVENTS.editableStateChanged)}},function(t,e,n){"use strict";n.r(e);var i=n(11),r=n(0),a=n(10),s=n(4),o=n(1);const l=[],u=/\./g,c=function(t,e,n){if(null==t||void 0===t)return null;const i=arguments.length>2,r=e.split(u);for(;r.length>1;){const e=r.shift();let n=t[e];const a="undefiend"!=typeof n&&null!=n;if(!a&&!i)return null;!a&&i&&(n=t[e]={}),t=n}if(!i)return t[r[0]]?t[r[0]]:null;t[r[0]]=n};class d extends s.default{static get observedAttributes(){return l.concat(s.default.observedAttributes)}static get NODENAME(){return r.NODENAMES.Container}constructor(t=null){super(t||{}),this.fields=[],this.on(r.EVENTS.valueChanged,t=>{if(t.target!=this){const{name:e,value:n}=t.target;e?c(this.__value__,e,n):null!=n&&i.default.merge(this.__value__,n),this.validate(),this.publishValue(t.detail[0]),t.preventDefault(),t.stopPropagation()}})}async init(){await this.initContainer()}async initContainer(){await this.initBaseField(),this.fields=Object(a.findFields)(this),this.on(r.EVENTS.initialize,t=>{if(t.target!=this){const e=t.target;e instanceof s.default&&(this.fields.indexOf(e)<0&&this.fields.push(e),t.preventDefault(),t.stopPropagation())}}),this.validator.addCustomCheck(async({data:t,base:e})=>{const{fields:n}=e;if(n){const t=n.length;for(let e=0;e<t;e++){const t=n[e];if(t.condition&&!t.valid)return!1}}return!0})}readonlyUpdated(){const{readonly:t,fields:e}=this;if(e)for(let n of e)n.readonly=t}async updatedValue(t){this.__value__={};const{fields:e}=this;if(e)for(let n of e)n.name?n.value=c(t,n.name):n instanceof d&&(n.value=t)}}Object(o.default)(d),e.default=d},function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return g}));var i=n(23);class r{constructor(t,e){this.key=t,this.context=e}get keyDefined(){return this.key in this.context}get hasValue(){return!!this.context[this.key]}get value(){return this.context[this.key]}set value(t){this.context[this.key]=t}set append(t){if(this.hasValue){const e=this.value;e instanceof Array?e.push(t):this.value=[this.value,t]}else this.value=t}remove(){delete this.context[this.key]}static load(t,e,n=!0){let i=t;const a=e.split(".");let s=a.shift().trim();for(;a.length>0;){if(!i[s]){if(!n)return null;i[s]={}}i=i[s],s=a.shift().trim()}return new r(s,i)}}const a=function(t){return void 0!==t&&null!=t&&"Object"===t.constructor.name},s=function(t){for(let e=1;e<arguments.length;e++){const n=arguments[e];Object.getOwnPropertyNames(n).forEach(e=>{a(t[e])?s(t[e],n[e]):t[e]=n[e]})}return t},o=function(){const[t,e,{deep:n=!1,recursive:i=!0,parents:r=[]}={}]=arguments,a={};for(name in t){const s=t[name],l=e(name,s,t);if(!l||n&&null!=s){if(l&&n){"object"!==typeof s||s instanceof Array||s instanceof Map||s instanceof Set||s instanceof RegExp||r.includes[s]||s==t?a[name]=s:a[name]=o(s,e,{deep:n,recursive:i,parents:r.concat(t)})}}else a[name]=s}return a};var l={isPojo:a,append:function(t,e,n){if(void 0!==e){r.load(n,t,!0).append=e}return n},merge:s,filter:o,buildPropertyFilter:function({names:t,allowed:e}){return(n,i,r)=>t.includes(n)===e}};class u{constructor(t){this.hasValue=1==arguments.length,this.value=t}}class c{constructor(t,e){this.data=t,this.resolver=e,this.cache=new Map}updateData(t){this.data=t,this.cache=new Map}resetCache(){this.cache=new Map}getPropertyDef(t,e=!0){if(this.cache.has(t))return this.cache.get(t);let n=null;if(this.data&&t in this.data)n={data:this.data,resolver:this.resolver,defined:!0};else{if(!e)return null;n=((t,e)=>{for(;t;){const n=t.proxy.handle.getPropertyDef(e,!1);if(n)return n;t=t.parent}return{data:null,resolver:null,defined:!1}})(this.resolver.parent,t)}return n.defined&&this.cache.set(t,n),n}hasProperty(t){const{defined:e}=this.getPropertyDef(t);return e}getProperty(t){const{data:e}=this.getPropertyDef(t);return e?e[t]:void 0}setProperty(t,e){const{data:n,defined:i}=this.getPropertyDef(t);i?n[t]=e:(this.data||(this.data={}),this.data[t]=e,this.cache.set(t,{data:this.data,resolver:this.resolver,defined:!0}))}deleteProperty(t){throw new Error("unsupported function!")}}class d{constructor(t,e){this.handle=new c(t,e),this.data=new Proxy(this.handle,{has:function(t,e){return t.hasProperty(e)},get:function(t,e){return t.getProperty(e)},set:function(t,e,n){return t.setProperty(e,n)},deleteProperty:function(t,e){return t.deleteProperty(e)}})}updateData(t){this.handle.updateData(t)}resetCache(){this.handle.resetCache()}}const h=/\$\{(([a-zA-Z0-9\-_\s]+)::)?([^\{\}]+)\}/,f=new u,p=t=>t instanceof u?t:new u(t),T=async function(t,e,n,i){if(n&&t.name!=n)return t.parent?T(t.parent,e,n,i):null;const r=await async function(t,e){if("string"!=typeof t)return t;const n=new Function("context",`\nreturn (async (context) => {\n\ttry{ \n\t\twith(context){\n\t\t\t return ${t}\n\t\t}\n\t}catch(e){\n\t\tthrow e;\n\t}\n})(context)`);let i=setTimeout(()=>{i=null,console.warn("long running statement:",t,new Error)},1e3);const r=await n(e);return i&&clearTimeout(i),r}(e,t.proxy.data);return null!=r?r:i instanceof u&&i.hasValue?i.value:r},E=t=>t?0==(t=t.trim()).length?null:t:null;class g{constructor({context:t=i.default,parent:e=null,name:n=null}){this.parent=e instanceof g?e:null,this.name=n,this.context=t,this.proxy=new d(this.context,this)}get chain(){return this.parent?this.parent.chain+"/"+this.name:"/"+this.name}get effectiveChain(){return this.context?this.parent?this.parent.effectiveChain+"/"+this.name:"/"+this.name:this.parent?this.parent.effectiveChain:""}get contextChain(){const t=[];let e=this;for(;e;)e.context&&t.push(e.context),e=e.parent;return t}getData(t,e){if(t){if(!e||e==this.name){const e=r.load(this.context,t,!1);return e?e.value:null}this.parent&&this.parent.getData(t,e)}}updateData(t,e,n){if(t)if(n&&n!=this.name)this.parent&&this.parent.updateData(t,e,n);else{null!=this.context&&void 0!==this.context||(this.context={},this.proxy.updateData(this.context));r.load(this.context,t).value=e,this.proxy.resetCache()}}mergeContext(t,e){e&&e!=this.name?this.parent&&this.parent.mergeContext(t,e):this.context=this.context?l.merge(this.context,t):t}async resolve(t,e){const n=2==arguments.length?p(e):f;try{const e=h.exec(t);return e?await T(this,e[3],E(e[2]),n):await T(this,E(t),null,n)}catch(e){return console.error('error at executing statment"',t,'":',e),n.hasValue?n.value:t}}async resolveText(t,e){let n=t,i=t,r=h.exec(n);const a=2==arguments.length?p(e):f;for(;null!=r;){const t=await this.resolve(r[0],a);i=i.split(r[0]).join(),n=n.split(r[0]).join(void 0===t?"undefined":null==t?"null":t),r=h.exec(i)}return n}static async resolve(t,e,n,i){const r=new g({context:e}),a=arguments.length>2?p(n):f;return"number"==typeof i&&i>0?new Promise(e=>{setTimeout(()=>{e(r.resolve(t,a))},i)}):r.resolve(t,a)}static async resolveText(t,e,n,i){const r=new g({context:e}),a=arguments.length>2?p(n):f;return"number"==typeof i&&i>0?new Promise(e=>{setTimeout(()=>{e(r.resolveText(t,a))},i)}):r.resolveText(t,a)}static buildSecure({context:t,propFilter:e,option:n={deep:!0},name:i,parent:r}){return t=l.filter({data:t,propFilter:e,option:n}),new g({context:t,name:i,parent:r})}}},function(t,e,n){"use strict";n.r(e),n.d(e,"treeFilter",(function(){return a})),n.d(e,"findFields",(function(){return s})),n.d(e,"findValidations",(function(){return o}));var i=n(4),r=n(17);const a=({root:t,filter:e})=>{let n=[];return t.children.forEach(t=>{const{accept:i,stop:r=!1}=e(t);if(i&&n.push(t),!r){const i=a({root:t,filter:e});i instanceof Array?n=n.concat(i):i&&n.push(i)}}),n},s=t=>a({root:t,filter:t=>t instanceof i.default?{accept:!0,stop:!0}:{accept:!1}}),o=t=>a({root:t,filter:e=>{if(t!=e){if(e instanceof i.default)return{accept:!1,stop:!0};if(e instanceof r.default)return{accept:!0,stop:!0}}return{accept:!1}}})},function(t,e,n){"use strict";n.r(e),n.d(e,"append",(function(){return r})),n.d(e,"isPojo",(function(){return a})),n.d(e,"merge",(function(){return s})),n.d(e,"filter",(function(){return o}));class i{constructor(t,e){this.key=t,this.context=e}get keyDefined(){return this.key in this.context}get hasValue(){return!!this.context[this.key]}get value(){return this.context[this.key]}set value(t){this.context[this.key]=t}set append(t){if(this.hasValue){const e=this.value;e instanceof Array?e.push(t):this.value=[this.value,t]}else this.value=t}remove(){delete this.context[this.key]}static load(t,e,n=!0){let r=t;const a=e.split(".");let s=a.shift().trim();for(;a.length>0;){if(!r[s]){if(!n)return null;r[s]={}}r=r[s],s=a.shift().trim()}return new i(s,r)}}const r=function(t,e,n){if(void 0!==e){i.load(n,t,!0).append=e}return n},a=function(t){return void 0!==t&&null!=t&&"Object"===t.constructor.name},s=function(t){for(let e=1;e<arguments.length;e++){const n=arguments[e];Object.getOwnPropertyNames(n).forEach(e=>{a(t[e])?s(t[e],n[e]):t[e]=n[e]})}return t},o=function(){const[t,e,{deep:n=!1,recursive:i=!0,parents:r=[]}={}]=arguments,a={};for(name in t){const s=t[name],l=e(name,s,t);if(!l||n&&null!=s){if(l&&n){"object"!==typeof s||s instanceof Array||s instanceof Map||s instanceof Set||s instanceof RegExp||r.includes[s]||s==t?a[name]=s:a[name]=o(s,e,{deep:n,recursive:i,parents:r.concat(t)})}}else a[name]=s}return a};e.default={isPojo:a,append:r,merge:s,filter:o,buildPropertyFilter:function({names:t,allowed:e}){return(n,i,r)=>t.includes(n)===e}}},function(t,e,n){"use strict";n.r(e);var i=n(0),r=n(8),a=n(1);const s=[i.ATTRIBUTE_STEP];class o extends r.default{static get observedAttributes(){return s.concat(r.default.observedAttributes)}static get NODENAME(){return i.NODENAMES.Page}constructor(){super()}async init(){await this.initPage()}async initPage(){await this.initContainer()}get step(){return this.attr(i.ATTRIBUTE_STEP)}conditionUpdated(){}}Object(a.default)(o),e.default=o},function(t,e,n){"use strict";n.r(e);var i=n(0),r=n(3),a=n(7);const s=[i.ATTRIBUTE_ACTIVE,i.ATTRIBUTE_READONLY,i.ATTRIBUTE_CONDITION,i.ATTRIBUTE_CONDITION_VALID,i.ATTRIBUTE_CONDITION_INVALID,i.ATTRIBUTE_EDITABLE_CONDITION];class o extends r.default{static get observedAttributes(){return s}constructor(){super()}async init(){await this.initBase()}async initBase(){}get form(){return this.__form__||(this.__form__=this.parent(i.NODENAMES.Form)),this.__form__}get active(){return this.hasAttribute(i.ATTRIBUTE_ACTIVE)}set active(t){this.active!=t&&(Object(a.updateActiveState)(this,t),this.activeUpdated())}activeUpdated(){}get readonly(){return this.hasAttribute(i.ATTRIBUTE_READONLY)}set readonly(t){Object(a.updateEditableState)(this,!t,!this.ready.resolved),this.readonlyUpdated()}readonlyUpdated(){}get editable(){return this.hasAttribute(i.ATTRIBUTE_EDITABLE)}set editable(t){Object(a.updateEditableState)(this,t,!this.ready.resolved),this.editableUpdated()}editableUpdated(){this.readonlyUpdated()}get condition(){return!this.hasAttribute(i.ATTRIBUTE_CONDITION_INVALID)}conditionUpdated(){}get valid(){return this.hasAttribute(i.ATTRIBUTE_VALID)}}e.default=o},function(t,e,n){"use strict";n.r(e),n.d(e,"evaluationData",(function(){return a}));var i=n(11),r=n(0);const a=t=>{const e={};e[r.SPECIALVARS.CURRENTVALUE]=t.value;let n=t.parent(r.NODENAMES.ListRow),a=e;for(;n;)a[r.SPECIALVARS.CURRENTLISTROW]=n.value,a=a[r.SPECIALVARS.CURRENTLISTROW],n=n.parent(r.NODENAMES.ListRow);return i.default.merge(e,t.form.data)}},function(t,e,n){"use strict";n.r(e),n.d(e,"noValue",(function(){return i})),n.d(e,"emtpyOrNoValueString",(function(){return r}));const i=t=>null==t||void 0===t,r=t=>i(t)||0==t.trim().length;e.default={noValue:i,emtpyOrNoValueString:r}},function(t,e,n){"use strict";n.r(e);var i=n(4);n.d(e,"BaseField",(function(){return i.default}));var r=n(21);n.d(e,"Field",(function(){return r.default}));var a=n(8);n.d(e,"Container",(function(){return a.default}));var s=n(22);n.d(e,"List",(function(){return s.default}));var o=n(12);n.d(e,"Page",(function(){return o.default}));var l=n(20);n.d(e,"Form",(function(){return l.default}))},function(t,e,n){"use strict";n.r(e),n.d(e,"ATTRIBUTE_ACTIVE",(function(){return s})),n.d(e,"ATTRIBUTE_CONDITION",(function(){return o}));var i=n(0),r=n(3),a=n(1);const s="active",o="condition",l=[s,o];class u extends r.default{static get observedAttributes(){return l}static get NODENAME(){return i.NODENAMES.Validation}constructor(){super()}async init(){this.active=!1}get active(){return this.hasAttribute(s)}set active(t){t?this.attr(s,""):this.attr(s,void 0)}get condition(){return this.attr(o)}}Object(a.default)(u),e.default=u},function(t,e,n){"use strict";n.r(e),function(t){const n=void 0!==t?t:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{};e.default=n}.call(this,n(19))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";n.r(e);var i=n(3),r=n(9),a=n(11),s=n(0),o=n(1),l=n(13),u=(n(2),n(14));const c=["active","condition"];class d extends i.default{static get observedAttributes(){return c}static get NODENAME(){return s.NODENAMES.Message}constructor(){super()}async init(){this.reference=(t=>{let e=t.parentNode;for(;e;){if(e instanceof l.default)return e;e=e.parentNode}return null})(this),this.form=this.parent(s.NODENAMES.Form),this.form.on(s.EVENTS.executeValidate,()=>{this.update()}),this.update()}get active(){return this.hasAttribute("active")}set active(t){t?this.attr("active",""):this.attr("active",void 0)}get condition(){return this.attr("condition")}async update(){await this.ready;const t=Object(u.evaluationData)(this.reference);this.active=await r.default.resolve(this.condition,t,!1)}}Object(o.default)(d);var h=n(12),f=n(5);const p=[];class T extends f.default{static get observedAttributes(){return p}static get NODENAME(){return s.NODENAMES.BackButton}constructor(){super()}execute(){this.form.toPrevPage()}}Object(o.default)(T);const E=[];class g extends f.default{static get observedAttributes(){return E}static get NODENAME(){return s.NODENAMES.NextButton}constructor(){super()}execute(){this.form.toNextPage()}}Object(o.default)(g);const v=[];class m extends f.default{static get observedAttributes(){return v}static get NODENAME(){return s.NODENAMES.SummaryButton}constructor(){super()}execute(){this.form.toNextPage()}}Object(o.default)(m);const A=[];class y extends f.default{static get observedAttributes(){return A}static get NODENAME(){return s.NODENAMES.SubmitButton}constructor(){super()}execute(){this.form.submit()}}Object(o.default)(y);const _=[];class N extends i.default{static get observedAttributes(){return _}static get NODENAME(){return s.NODENAMES.Control}constructor(){super()}async init(){this.form=this.parent(s.NODENAMES.Form),this.back=this.find(s.NODENAMES.BackButton).first(),this.next=this.find(s.NODENAMES.NextButton).first(),this.summary=this.find(s.NODENAMES.SummaryButton).first(),this.submit=this.find(s.NODENAMES.SubmitButton).first(),this.form.on([s.EVENTS.validStateChanged,s.EVENTS.conditionStateChanged],t=>{t.target instanceof h.default&&this.update()}),this.form.on([s.EVENTS.formStateChanged,s.EVENTS.siteChanged],t=>{this.update()})}update(){const{back:t,next:e,summary:n,submit:i,form:r}=this,{activePageIndex:a,activePage:o,nextPage:l,pages:u,useSummaryPage:c,state:d}=r;t.active=!0,t.disabled=!0,e.active=!1,e.disabled=!0,n.active=!1,n.disabled=!0,i.active=!1,i.disabled=!0,d==s.FORMSTATES.finished?(t.disabled=!0,i.active=!0):d==s.FORMSTATES.summary?(t.disabled=!1,i.active=!0,i.disabled=!r.valid):d==s.FORMSTATES.input&&(t.disabled=a<=0,l||!o.valid&&a+1<u.length?(e.active=!0,e.disabled=!o.valid):c&&d==s.FORMSTATES.input?(n.active=!0,n.disabled=!o.valid):(i.active=!0,i.disabled=!r.valid))}}Object(o.default)(N);var b=n(7);const S=[s.ATTRIBUTE_NAME,s.ATTRIBUTE_ACTIVE,s.ATTRIBUTE_READONLY];class I extends HTMLElement{static get observedAttributes(){return S}static get NODENAME(){return s.NODENAMES.Step}constructor(){super()}get name(){return this.attr(s.ATTRIBUTE_NAME)}get active(){return this.hasAttribute(s.ATTRIBUTE_ACTIVE)}set active(t){this.active!=t&&Object(b.updateActiveState)(this,t)}get readonly(){return this.hasAttribute(s.ATTRIBUTE_READONLY)}set readonly(t){t?this.attr(s.ATTRIBUTE_READONLY,""):this.attr(s.ATTRIBUTE_READONLY,null)}}Object(o.default)(I);const O=[s.ATTRIBUTE_PROGRESS];class R extends i.default{static get observedAttributes(){return O}static get NODENAME(){return s.NODENAMES.ProgressBar}constructor(){super(),this.on("click",({target:t})=>{if(!this.form)return;if(t==this)return;const e=t.is(s.NODENAMES.Step)?t:t.parent(s.NODENAMES.Step).first();if(!e)return;const n=this.form.state,i=this.form.pages,r=(this.form.activePageIndex,this.form.activePage),a=e.name;if(n==s.FORMSTATES.input||n==s.FORMSTATES.summary){const t=((t,e,n)=>{for(let i of t){if(i.step==e&&i.condition)return i;if(i==n)return}return null})(i,a,r);t&&(this.form.activePage=t)}})}async init(){this.progress=0,this.form=this.parent(s.NODENAMES.Form),this.steps=this.find(s.NODENAMES.Step),this.form.on([s.EVENTS.initialize,s.EVENTS.siteChanged,s.EVENTS.formStateChanged],()=>{const t=this.form.state,e=this.form.activePage;if(!e)return;const n=this.form.activePageIndex,i=this.form.pages.length,r=e?e.step:s.FORMSTATES.init,a=Math.floor(100*n/i);for(let e of this.steps){const n=e.name;t==s.FORMSTATES.input?(e.active=n==r,e.readonly=!1):t==s.FORMSTATES.summary?(e.active=n==s.FORMSTATES.summary,e.readonly=!1):(e.active=n==s.FORMSTATES.finished,e.readonly=!0)}this.progress=t==s.FORMSTATES.summary||t==s.FORMSTATES.finished?100:a,this.trigger(s.EVENTS.progressbarChanged)})}get progress(){return this.attr(s.ATTRIBUTE_PROGRESS)}set progress(t){this.style.setProperty&&this.style.setProperty("--progress",t+"%"),this.attr(s.ATTRIBUTE_PROGRESS,Math.max(0,Math.min(t,100)))}}Object(o.default)(R);const M=[s.ATTRIBUTE_NAME,s.ATTRIBUTE_USE_SUMMARY_PAGE,s.ATTRIBUTE_ENDPOINT,s.ATTRIBUTE_METHOD,s.ATTRIBUTE_STATE,s.ATTRIBUTE_INPUT_MODE_AFTER_SUBMIT],D=(t,e)=>{for(let n of t.pages)n.readonly=e,n.active=e};class V extends i.default{static get observedAttributes(){return M}static get NODENAME(){return s.NODENAMES.Form}constructor(){super(),this.__initialized__=!1,this.__data__={},this.__state__=null,this.on(s.EVENTS.valueChanged,t=>{const{name:e,value:n}=t.target;e?this.__data__[e]=n:null!=n&&a.default.merge(this.__data__,n),this.trigger(s.EVENTS.executeValidate,t.detail[0]),t.preventDefault(),t.stopPropagation()})}async init(){this.__initialized__?this.state=s.FORMSTATES.init:(this.__data__={},this.state=s.FORMSTATES.init,this.useSummaryPage=this.hasAttribute(s.ATTRIBUTE_USE_SUMMARY_PAGE),this.activePageIndex=-1,this.state=s.FORMSTATES.init,this.useSummaryPage=this.hasAttribute(s.ATTRIBUTE_USE_SUMMARY_PAGE),this.pages=this.find(s.NODENAMES.Page)),this.activePageIndex=-1,this.pages.length>0&&this.toNextPage(),this.__initialized__=!0}get state(){return this.__state__}set state(t){const e=this.state;e==s.FORMSTATES.input&&t!=s.FORMSTATES.input?D(this,!0):e!=s.FORMSTATES.input&&t==s.FORMSTATES.input&&(D(this,!1),this.activePage&&(this.activePage.active=!0)),this.__state__=t,e!=t&&this.trigger(s.EVENTS.formStateChanged),this.attr(s.ATTRIBUTE_STATE,this.__state__)}get valid(){for(let t of this.pages)if(!t.valid)return!1;return!0}get data(){return this.__data__}set data(t){if(this.state==s.FORMSTATES.input){this.__data__={};for(let e of this.pages)e.name?e.value=t[e.name]:e.value=t;this.trigger(s.EVENTS.allPublishValue)}}get activePage(){return 0<=this.activePageIndex&&this.activePageIndex<this.pages.length?this.pages[this.activePageIndex]:null}set activePage(t){const e=this.activePage;t!=e&&(e&&(e.active=!1),this.activePageIndex=this.pages.indexOf(t),t.active=!0,this.state!=s.FORMSTATES.input&&(this.state=s.FORMSTATES.input),this.trigger(s.EVENTS.siteChanged))}get prevPage(){for(let t=this.activePageIndex-1;t>=0;t--){const e=this.pages[t];if(e.condition)return e}return null}get nextPage(){if(this.pages){for(let t=this.activePageIndex+1;t<this.pages.length;t++){const e=this.pages[t];if(e.condition)return e}}return null}async toPrevPage(){if(this.state!=s.FORMSTATES.input)this.state=s.FORMSTATES.input;else{const t=await this.prevPage;t&&(this.activePage=t)}}async toNextPage(){const t=await this.nextPage;t?(this.activePage=t,this.state==s.FORMSTATES.init&&(this._state=s.FORMSTATES.input)):this.useSummaryPage?this.summary():this.submit()}async summary(){this.state=s.FORMSTATES.summary}async submit(){this.state=this.hasAttribute(s.ATTRIBUTE_INPUT_MODE_AFTER_SUBMIT)?s.FORMSTATES.input:s.FORMSTATES.finished;const t=this.data;let e=this.attr(s.ATTRIBUTE_ENDPOINT);if(e){e=await r.default.resolveText(e,t,e);const n=new URL(e,location.href);return await fetch(n.toString(),{method:(this.attr(s.ATTRIBUTE_METHOD)||"post").toLowerCase(),credentials:"include",mode:"cors",headers:{"content-type":"application/json"},body:JSON.stringify(t)})}this.trigger(s.EVENTS.submit,t)}}Object(o.default)(V);e.default=V},function(t,e,n){"use strict";n.r(e);var i=n(0),r=n(4),a=n(15),s=n(2);class o{static findInput(t){return null}constructor(t,e){this.field=t,this.input=e,this.init()}init(){}set readonly(t){}acceptValue(t){return!0}normalizeValue(t){return t}updatedValue(){}get value(){return null}get valid(){return!0}}const l={accept:t=>t instanceof Date,value:t=>t.valueAsDate,normalize:t=>t||null},u={text:{accept:t=>"string"==typeof t,value:t=>t.value,normalize:t=>t&&(t=t.trim()).length>0?t:null},number:{accept:t=>"number"==typeof t,value:t=>t.valueAsNumber,normalize:t=>Object(a.noValue)(t)||Number.isNaN(t)?null:t},date:l,time:l};const c=()=>Math.floor(Math.random()*Date.now());const d=(t,e)=>new Promise((n,i)=>{const r=new FileReader;r.addEventListener("loadend",()=>{n({name:t.name,type:t.type,size:t.size,data:r.result})},!1),r[e](t)}),h={"form-input":async t=>(t.format="form-input",t),"data-url-base64":async t=>{const e=await d(t,"readAsDataURL");return e.format="data-url-base64",e},base64:async t=>{const e=await d(t,"readAsDataURL");return e.data=e.data.substr(e.data.indexOf(",")+1),e.format="base64",e}},f=async(t,e,n)=>{let i=[];for(let n of t)i.push(await h[e](n));return 0==i.length?null:n?i:i[0]};const p=[class extends o{static findInput(t){return t.find('input:not([type="file"]):not([type="radio"]):not([type="checkbox"]) ,input:not([type]), textarea').first()}constructor(t,e){super(t,e)}init(){const{field:t,input:e}=this,n=(t.attr("input-type")||e.attr("type")||"text").trim().toLowerCase();this.type=u[n]||u.text,e.on("input",Object(s.toTimeoutHandle)(()=>{t.trigger(i.EVENTS.input,this.normalizeValue(this.value))},!1,!0,i.EVENTHANDLE_INPUT_TIMEOUT)),t.trigger(i.EVENTS.input,this.normalizeValue(this.value))}acceptValue(t){return null==t||void 0===t||this.type.accept(t)}normalizeValue(t){return null==t&&void 0===t?null:this.type.normalize(t)}updatedValue(t){this.field.value!=this.input.value&&this.input.val(t||null)}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){return this.type.value(this.input)}get valid(){return this.input.checkValidity()}},class extends o{static findInput(t){const e=t.find('input[type="checkbox"]');return 0==e.length?null:1==e.length?e.first():e}constructor(t,e){super(t,e)}init(){const{field:t,input:e}=this;this.multiple=e instanceof NodeList,e.on("input",Object(s.toTimeoutHandle)(()=>{t.trigger(i.EVENTS.input,this.normalizeValue(this.value))},!1,!0,i.EVENTHANDLE_INPUT_TIMEOUT)),t.trigger(i.EVENTS.input,this.normalizeValue(this.value))}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){const t=this.input.val();if(!(t instanceof Map))return t;if(0==t.size)return null;const e=[];return t.forEach(t=>{e.push(t)}),e}normalizeValue(t){return t?this.multiple?0!=(t=t.filter(t=>!!t)).length?t:null:t:null}acceptValue(t){if(null==t||void 0===t)return!0;if(this.multiple)return t instanceof Array;{const e=typeof t;return"string"===e||"boolean"===e}}updatedValue(t){this.field.value!=this.value&&this.input.val(t||null)}},class extends o{static findInput(t){const e=t.find('input[type="radio"]');return 0==e.length?null:e}constructor(t,e){super(t,e)}init(){const{field:t,input:e}=this,n=t.name+c();for(let t of e)t.name=n;e.on("input",Object(s.toTimeoutHandle)(()=>{t.trigger(i.EVENTS.input,this.normalizeValue(this.value))},!1,!0,i.EVENTHANDLE_INPUT_TIMEOUT)),t.trigger(i.EVENTS.input,this.normalizeValue(this.value))}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){const t=this.input.val();return t instanceof Map?0==t.size?null:t.values().next().value:t}normalizeValue(t){return t||null}acceptValue(t){if(null==t||void 0===t)return!0;{const e=typeof t;return"string"===e||"boolean"===e}}updatedValue(t){this.field.value!=this.value&&this.input.val(t||null)}},class extends o{static findInput(t){return t.find('input[type="file"]').first()}constructor(t,e){super(t,e)}async init(){const{field:t,input:e}=this;this.multiple=e.multiple,this.format=t.attr("file-format")||"form-input",this.filenameTarget=t.attr("file-name-target"),this.filenameTarget=this.filenameTarget?t.find(this.filenameTarget).first():null;const{format:n,multiple:r}=this;e.on("input",Object(s.toTimeoutHandle)(async()=>{this.updatedValue(await f(e.files,n,r)),t.trigger(i.EVENTS.input,this.value)},!1,!0)),e.files&&0!=e.files.length&&this.updatedValue(await f(e.files,n,r)),t.trigger(i.EVENTS.input,this.value)}set readonly(t){this.input.attr("disabled",t?"":null)}acceptValue(t){return null==t||void 0===t||(this.multiple?t instanceof Array:t instanceof"object")}normalizeValue(t){return null==t||void 0===t?null:this.multiple?0!=t.length?t:null:t}updatedValue(t){if(t!=this.__value__&&(this.__value__=t,this.filenameTarget&&t))if(this.multiple)for(let e of t)this.filenameTarget.append(`<span>${e.name}</span>`);else this.filenameTarget.append(`<span>${t.name}</span>`)}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){return this.__value__}get valid(){return this.input.checkValidity()}},class extends o{static findInput(t){return t.find("select").first()}constructor(t,e){super(t,e)}init(){const{field:t,input:e}=this;e.on("input, changed",Object(s.toTimeoutHandle)(()=>{t.trigger(i.EVENTS.input,this.value)},!1,!0,i.EVENTHANDLE_INPUT_TIMEOUT)),t.trigger(i.EVENTS.input,this.value)}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){return this.normalizeValue(this.input.multiple?this.input.val():this.input.value)}normalizeValue(t){return t?this.input.multiple?0!=(t=t.filter(t=>t&&t.trim().length>0)).length?t:null:0!=(t=t.trim()).length?t:null:null}acceptValue(t){return null==t||void 0===t||(this.input.multiple?t instanceof Array:"string"==typeof t)}updatedValue(t){this.field.value!=this.value&&this.input.val(t||null)}}];var T=n(1);const E=["file-format"];class g extends r.default{static get observedAttributes(){return E.concat(r.default.observedAttributes)}static get NODENAME(){return i.NODENAMES.Field}constructor(){super()}async init(){await this.initField()}async initField(){await this.initBaseField(),this.wrapper=(t=>{for(let e of p){const n=e.findInput(t);if(n)return new e(t,n)}return null})(this),this.wrapper&&this.validator.addCustomCheck(async()=>this.wrapper.valid)}readonlyUpdated(){this.wrapper&&(this.wrapper.readonly=this.readonly)}acceptValue(t){return!!this.wrapper&&this.wrapper.acceptValue(t)}normalizeValue(t){return this.wrapper?this.wrapper.normalizeValue(t):t}updatedValue(t){this.wrapper&&this.wrapper.updatedValue(t)}}Object(T.default)(g);e.default=g},function(t,e,n){"use strict";n.r(e);var i=n(0),r=n(15),a=(n(2),n(10)),s=n(1),o=n(4),l=n(8),u=n(5);const c=[];class d extends u.default{static get observedAttributes(){return c.concat(c)}static get NODENAME(){return i.NODENAMES.ButtonDeleteRow}constructor(){super()}async init(){u.default.init(this),this.active=!0}execute(){this.trigger(100,i.EVENTS.listRowDelete)}}Object(s.default)(d);const h=[];class f extends l.default{static get observedAttributes(){return h.concat(l.default.observedAttributes)}static get NODENAME(){return i.NODENAMES.ListRow}constructor(){super()}get active(){return!0}set active(t){}get condition(){return!0}get name(){return null}}customElements.define(f.NODENAME,f);var p=f;const T=[];class E extends u.default{static get observedAttributes(){return T.concat(T)}static get NODENAME(){return i.NODENAMES.ButtonAddRow}constructor(){super()}async init(){u.default.init(this),this.active=!0}execute(){this.trigger(100,i.EVENTS.listRowAdd)}}Object(s.default)(E);var g=E,v=n(3);const m=[];class A extends v.default{static get observedAttributes(){return m.concat(m)}static get NODENAME(){return i.NODENAMES.ListRows}constructor(){super()}}customElements.define(A.NODENAME,A);const y=[i.ATTRIBUTE_MAX],_=(t,e)=>{const{container:n,template:r}=t,a=document.importNode(r.content,!0).children[0];return n.append(a),e&&setTimeout(()=>{a.value=e},i.TRIGGER_TIMEOUT),a};class N extends o.default{static get observedAttributes(){return y.concat(o.default.observedAttributes)}static get NODENAME(){return i.NODENAMES.List}constructor(t=null){super(t||[]),this.on([i.EVENTS.valueChanged,i.EVENTS.initialize],t=>{if(t.target instanceof p){const e=this.rows,n=t.target,{value:i}=n,r=e.indexOf(n);this.__value__[r]=i,this.validate(),this.publishValue(t.detail?t.detail[0]:[n]),t.preventDefault(),t.stopPropagation()}})}async init(){this.initList()}async initList(){await this.initBaseField(),this.__value__=[],this.template=this.find("template").first(),this.container=this.find(i.NODENAMES.ListRows).first();const{container:t,template:e,validator:n}=this,r=(s=this,Object(a.treeFilter)({root:s,filter:t=>t instanceof g?{accept:!0,stop:!0}:t instanceof o.default?{accept:!1,stop:!0}:{accept:!1}})[0]);var s;n.addCustomCheck(async({})=>{const{rows:t,max:e,readonly:n}=this,i=t.length;return n||(i==e?r.disabled=!0:i<e&&(r.disabled=!1)),i<=e}),n.addCustomCheck(async()=>{const{rows:t}=this;if(t)for(let e of t)if(!e.valid)return!1;return!0}),this.on(i.EVENTS.listRowAdd,t=>{const{readonly:e,__value__:n}=this;if(!e){const t=_(this);n.push(t.value),this.validate(),this.publishValue()}t.preventDefault(),t.stopPropagation()}),this.on(i.EVENTS.listRowDelete,t=>{const{rows:e,readonly:n,__value__:r}=this;if(!n){const n=t.target.parent(i.NODENAMES.ListRow),a=e.indexOf(n);a>=0&&(n.remove(),e.splice(a,1),r.splice(a,1),this.validate(),this.publishValue())}t.preventDefault(),t.stopPropagation()}),this.validate(),this.publishValue()}readonlyUpdated(){const{readonly:t}=this;for(let e of this.rows)e.readonly=t}get rows(){return Array.from(this.container.children)}get max(){return this.hasAttribute(i.ATTRIBUTE_MAX)?parseInt(this.attr(i.ATTRIBUTE_MAX)):Number.MAX_SAFE_INTEGER}acceptValue(t){return t instanceof Array}normalizeValue(t){return t.filter(t=>!!t)}get value(){return this.__value__.length>0?this.__value__:null}set value(t){const e=Object(r.noValue)(t);if((e||this.acceptValue(t))&&(this.container.children.remove(),this.__value__=[],!e)){t=this.normalizeValue(t);for(let e of t)_(this,e)}}}Object(s.default)(N);e.default=N},function(t,e,n){"use strict";n.r(e),function(t){const n=void 0!==t?t:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{};e.default=n}.call(this,n(19))},function(t,e,n){"use strict";n.r(e);var i=function(){const t=Array.from(arguments),e=t.shift();for(;t.length>0;){t.shift()(e)}},r=n(6);const a=r.default.globalVar("___DOM_API_EXTENSION_MAP___",{});var s=function(t,e){return function(n){let i=a[n.name];i||(i=a[n.name]={}),i[t]?console.warn('duplicated load of extension "'+t+'"!'):(i[t]=!0,e(n.prototype))}};const o=s("EventSupport",t=>{const e=/(\s+)|(\s*,\s*)/,n=t=>(t.__wrapperhandlemap__||(t.__wrapperhandlemap__=new Map),t.__wrapperhandlemap__),i=t=>(t.___EVENTTRIGGERTIMEOUTS___||(t.___EVENTTRIGGERTIMEOUTS___={}),t.___EVENTTRIGGERTIMEOUTS___),r=(t,i,r)=>{const{wrapper:a,option:s,events:o,handle:l}=i,u=s.capture;if(r){r="string"==typeof r?r.split(e):r;for(let e of r){const i=o.indexOf(e);i>=0&&(t.removeEventListener(e,a,u),o.splice(i,1)),0==o.length&&n(t).delete(l)}}else{for(let e of o)t.removeEventListener(e,a,u);n(t).delete(l)}};t.on=function(){if(arguments.length<2)throw new Error("Too less arguments!");const t=Array.from(arguments);let i="string"==typeof t[0]?t.shift().split(e):t.shift();const a="string"==typeof t[0]?t.shift():null,s=t.shift(),o=void 0===t[0]?{capture:!1,once:!1,passive:!1}:"boolean"==typeof t[0]?{capture:t.shift(),once:!1,passive:!1}:t.shift(),l=function(t){if(a){if("function"==typeof event.target.is&&!t.target.is(a))return!0}const e=s.apply(null,arguments);return o.once&&r(this,l),e};n(this).set(s,{handle:s,wrapper:l,events:i,option:o});for(let t of i)this.addEventListener(t,l,o);return this},t.removeOn=function(t,e,i){const a=n(this).get(t);return a?r(this,a,e):this.removeEventListener(t,e,i),this},t.trigger=function(){const t=Array.from(arguments),e="number"==typeof t[0]?t.shift():-1;if(e>=0){const n=t[0],r=i(this),a=r[n];a&&clearTimeout(a),r[n]=setTimeout(()=>{delete r[n],this.trigger.apply(this,t)},e)}else{const e=t.shift(),n=t[0]instanceof Event?t.shift():null,i=t.length>=1?0==t.length?t.shift():t:n,r=i?new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:i}):new Event(e,{bubbles:!0,cancelable:!0});n&&(r.delegatedEvent=n),this.dispatchEvent(r)}return this}});i(EventTarget,o);var l=s("DataSupport",t=>{t.data=function(){const t={};if(void 0!==this.dataset)for(name in this.dataset)t[name]=this.dataset[name];return this.data=function(){return 0==arguments.length?t:1==arguments.length?t[arguments[0]]:(void 0===arguments[1]||null==arguments[1]?delete t[arguments[0]]:t[arguments[0]]=arguments[1],this)}.bind(this),this.data.apply(null,arguments)}});var u=s("ManipulationSupport",t=>{t.empty=function(){let t=this.childNodes;for(;0!=t.length;)t[0].remove(!0);return this},t.content=function(){return this.childNodes},t.html=function(){return 0==arguments.length?this.innerHTML:1==arguments.length&&"boolean"==typeof arguments[0]?arguments[0]?this.outerHTML:this.innerHTML:(Array.from(arguments).forEach(t=>{this.empty(),("string"==typeof t||t instanceof Node||t instanceof NodeList||t instanceof HTMLCollection)&&this.append(t)}),this)};const e=function(){const e=t.appendChild.bind(this);for(let t=0;t<arguments.length;t++){let n=arguments[t];n instanceof Node?this.appendChild(n):"string"==typeof n?create(n).forEach(e):"function"==typeof n.forEach&&n.forEach(e)}};t.append=e;const n=function(t,e){this.insertBefore(e,t)};t.prepend=function(){if(0==this.childNodes.length)e.apply(this,arguments);else{const t=this.childNodes.first(),e=n.bind(this,t);for(let t=0;t<arguments.length;t++){const n=arguments[t];n instanceof Node?e(n):("string"==typeof n||"function"==typeof n.forEach)&&n.forEach(e)}}},t.replace=function(){if(arguments.length<1)throw new Error("Insufficient arguments! One or two nodes required!");const t=1==arguments.length?this.parentNode:this,e=1==arguments.length?this:arguments[0],n=1==arguments.length?arguments[0]:arguments[1];n instanceof Array||n instanceof NodeList||n instanceof HTMLCollection?(n.forEach(n=>t.insertBefore(n,e)),e.remove()):t.replaceChild(n,e)},t.after=function(){if(null==this.parentNode)throw new Error("Can't insert nodes after this node! Parent node not available!");const e=this.parentNode,n=this.nextSibling;n?t.before.apply(n,arguments):t.append.apply(e,arguments)},t.before=function(){if(null==this.parentNode)throw new Error("Can't insert nodes after this node! Parent node not available!");const t=this.parentNode,e=e=>{t.insertBefore(e,this)};for(let t=0;t<arguments.length;t++){const n=arguments[t];n instanceof Node?e(n):("string"==typeof n||"function"==typeof n.forEach)&&n.forEach(e)}}});i(Node,l,u);const c=/:parent(\(\"([^\)]*)\"\))?/i,d=function(t,e){let n=c.exec(e);if(!n)return t.querySelectorAll(e);{let i=t;if(n.index>0&&(i=t.querySelectorAll(e.substr(0,n.index)),0==i.length))return;if(i=i.parent(n[2]),i){let t=e.substr(n.index+n[0].length).trim();return t.length>0&&(i=i.find(t)),i}}};var h=s("QuerySupport",t=>{t.find=function(){let t=[],e=Array.from(arguments),n=e.shift();for(;n;){if("string"==typeof n){let e=d(this,n);e&&t.push(e)}n=e.shift()}let i=NodeList.from.apply(null,t);return i},t.is=function(){if(this instanceof Document||this instanceof DocumentFragment)return!1;if(1==arguments.length){if("string"==typeof arguments[0])return this.matches(arguments[0]);if("number"==typeof arguments[0].length){let t=arguments[0];for(let e=0;e<t.length;e++)if(this.matches(t[e]))return!0}}else if(arguments.length>1)return this.is(Array.from(arguments));return!1},t.parent=function(){if(this.parentNode){if("string"==typeof arguments[0]){let t=this.parentNode;try{for(;t&&!t.is(arguments[0]);)t=t.parent(arguments[0])}catch(e){console.error("this:",this,"parent:",t,"error:",e)}return t}return this.parentNode}},t.parents=function(){let e=new Array,n=t.parent.apply(this,arguments);for(;n;)e.push(n),n=t.parent.apply(n,arguments);return NodeList.from(e)},t.selector=function(){if(!(this instanceof Document||this instanceof DocumentFragment)){if(this.id)return"#"+this.id;{let t=this.tagName.toLowerCase(),e=this.parent();if(e){let n=e.find(":scope>"+t);if(n instanceof NodeList){let e=n.indexOf(this);e>0&&(t+=":nth-child("+(e+1)+")")}let i=e.selector();return i?i+">"+t:t}return t}}},t.closest=function(t){let e=this;for(;e;){let n=e.find(t);if(n&&n.length>0)return n;if(e.is(t))return NodeList.from(e);e=e.parent()}},t.nested=function(t){if(this.is(t))return NodeList.from(this);let e=this.find(t);return e&&e.length>0?e:NodeList.from(this.parent(t))}});const f=s("AttributeSupport",t=>{t.attr=function(){return 0==arguments.length?this.hasAttributes()?(()=>{const t={};return this.getAttributeNames().forEach(e=>{t[e]=this.getAttribute(e)}),t})():void 0:1==arguments.length?this.getAttribute(arguments[0]):(void 0===arguments[1]||null==arguments[1]?this.removeAttribute(arguments[0]):this.setAttribute(arguments[0],arguments[1]),this)}});i(Element,h,f,u);const p=s("ReadyEventSupport",t=>{t.ready=function(t,e){return this.on("ready",t,e),"complete"==document.readyState&&this.trigger("ready"),this}});i(Document,h,p),document.addEventListener("DOMContentLoaded",()=>document.trigger("ready")),i(DocumentFragment,h,u);var T=s("HtmlClassSupport",t=>{t.addClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach(t=>this.classList.add(t)):arguments.length>1&&Array.prototype.forEach.call(arguments,t=>this.classList.add(t)),this},t.removeClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach(t=>this.classList.remove(t)):arguments.length>1&&Array.prototype.forEach.call(arguments,t=>this.classList.remove(t)),this},t.toggleClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach(t=>this.classList.toggle(t)):arguments.length>1&&Array.prototype.forEach.call(arguments,t=>this.classList.toggle(t)),this}});const E=t=>"none"===t.style.display,g=t=>{let e=E(t)?"":t.style.display;return t.show=function(){return this.style.display=e,this}.bind(t),t.hide=function(){return this.style.display="none",this}.bind(t),t},v=s("ShowHideSupport",t=>{t.show=function(){return g(this).show.apply(null,arguments)},t.hide=function(){return g(this).hide.apply(null,arguments)},t.toggleShow=function(){return E(this)?this.show():this.hide()}});i(HTMLElement,T,v);const m=[{selector:"select",get:function(){const t=[];return this.find("option").forEach(e=>{e.selected&&t.push(e.value)}),t},set:function(){let t=[];const e=Array.from(arguments);let n=e.shift();for(;n;)Array.isArray(n)?t=t.concat(n):t.push(n),n=e.shift();this.value=t,this.find("option").forEach(e=>e.selected=t.indexOf(e.value)>=0),this.trigger("changed")}},{selector:'input[type="checkbox"], input[type="radio"]',get:function(){return"on"==this.value||"off"==this.value?this.checked:this.checked?this.value:void 0},set:function(t){"boolean"==typeof t?this.checked=t:"string"==typeof t?this.checked=this.value==t:Array.isArray(t)&&(this.checked=t.indexOf(this.value)>=0),this.trigger("changed")}}],A={get:function(){return this.value},set:function(t){this.value=t,this.trigger("input")}},y=function(t){for(let e=0;e<m.length;e++)if(t.is(m[e].selector))return m[e];return A};var _=s("ValueSupport",t=>{t.val=function(){let t=y(this);return 0==arguments.length?t.get.apply(this,arguments):(t.set.apply(this,arguments),this)}});i(HTMLInputElement,_),i(HTMLTextAreaElement,s("ValueSupport",t=>{t.val=function(){return 0==arguments.length?this.value:(this.value=arguments[0],this)}})),i(HTMLSelectElement,_);var N=function(){const t=Array.from(arguments),e=t.shift(),n=t.shift();t.forEach(t=>{Object.getOwnPropertyNames(t).forEach(i=>{const r=Object.getOwnPropertyDescriptor(t,i);void 0===n[i]&&"function"==typeof r.value&&(n[i]=function(){return e.call(this,i,arguments)})})})};var b=s("ListSupport",t=>{t.indexOf=function(){for(let t=0;t<this.length;t++)if(this[t]==arguments[0])return t;return-1},t.forEach=function(){return Array.prototype.forEach.apply(Array.from(this),arguments)},t.map=function(){return Array.prototype.map.apply(Array.from(this),arguments)},t.filter=function(){return Array.prototype.filter.apply(Array.from(this),arguments)},t.first=function(){if(this.length>0)return this[0]},t.last=function(){if(this.length>0)return this[this.length-1]}});i(NodeList,b),NodeList.prototype.applyTo=function(){const t=Array.from(arguments),e=t.shift(),n="function"==typeof e,i=[];for(let r=0;r<this.length;r++){const a=this[r];let s;n?s=e.apply([a].concat(t)):"function"==typeof a[e]&&(s=a[e].apply(a,t)),s&&i.push(s)}return i},NodeList.prototype.val=function(){if(0==arguments.length){if(this.length>0){const t=new Map;return this.forEach(e=>{if("function"==typeof e.val){e.val()&&t.set(e.name||e.id||e.selector(),e.val())}}),t}}else NodeList.prototype.applyTo.apply(this,["val"].concat(Array.from(arguments)))},NodeList.from=function(){const t=Array.from(arguments),e={};let n=0;for(;t.length>0;){const i=t.shift();if(void 0!==i&&null!=i)if(i instanceof Node)e[n++]={value:i,enumerable:!0};else if(i instanceof NodeList||i instanceof HTMLCollection||i instanceof Array)for(let t=0;t<i.length;t++)i[t]&&i[t]instanceof Node&&(e[n++]={value:i[t],enumerable:!0})}return e.length={value:n},Object.create(NodeList.prototype,e)},N((function(t,e){let n=[];return this.forEach(i=>{if(i&&"function"==typeof i[t]){const r=i[t].apply(i,e);r&&(r instanceof NodeList?n=n.concat(Array.from(r)):n.push(r))}}),0===n.length?void 0:n[0]instanceof Node||n[0]instanceof NodeList?NodeList.from(n):n}),NodeList.prototype,Node.prototype,HTMLElement.prototype,HTMLInputElement.prototype,Element.prototype,EventTarget.prototype),i(HTMLCollection,b),HTMLCollection.prototype.applyTo=function(){const t=Array.from(arguments),e=t.shift(),n="function"==typeof e,i=[];for(let r=0;r<this.length;r++){const a=this[r];let s;n?s=e.apply([a].concat(t)):"function"==typeof a[e]&&(s=a[e].apply(a,t)),s&&i.push(s)}return i},HTMLCollection.prototype.val=function(){if(0==arguments.length){if(this.length>0){const t=new Map;return this.forEach(e=>{if("function"==typeof e.val){e.val()&&t.set(e.name||e.id||e.selector(),e.val())}}),t}}else HTMLCollection.prototype.applyTo.apply(this,["val"].concat(Array.from(arguments)))},HTMLCollection.from=function(){const t=Array.from(arguments),e={};let n=0;for(;t.length>0;){const i=t.shift();if(void 0!==i&&null!=i)if(i instanceof HTMLElement)e[n++]={value:i,enumerable:!0};else if(i instanceof HTMLCollection||i instanceof NodeList||i instanceof Array)for(let t=0;t<i.length;t++)i[t]&&i[t]instanceof HTMLElement&&(e[n++]={value:i[t],enumerable:!0})}return e.length={value:n},Object.create(HTMLCollection.prototype,e)},N((function(t,e){let n=[];return this.forEach(i=>{if(i&&"function"==typeof i[t]){let r=i[t].apply(i,e);r&&(r instanceof HTMLCollection?n=n.concat(Array.from(r)):n.push(r))}}),0===n.length?void 0:n[0]instanceof HTMLElement||n[0]instanceof HTMLCollection?HTMLCollection.from.apply(null,n):n}),HTMLCollection.prototype,Node.prototype,HTMLElement.prototype,HTMLInputElement.prototype,Element.prototype,EventTarget.prototype),r.default.global.defaultjs=r.default.global.defaultjs||{},r.default.global.defaultjs.extdom=r.default.global.defaultjs.extdom||{VERSION:"1.0.0-beta.10",utils:{Utils:r.default}},r.default.global.find=function(){return document.find.apply(document,arguments)},r.default.global.ready=function(){return document.ready.apply(document,arguments)},r.default.global.create=function(t,e){if("string"!=typeof arguments[0])throw new Error("The first argument must be a string!");const n=document.createElement("template");return n.innerHTML=t,e?n:document.importNode(n.content,!0).childNodes},r.default.global.script=function(t,e){return t instanceof Array?Promise.all(t.map(t=>r.default.global.script(t,e))):"string"==typeof t?new Promise((n,i)=>{const r=document.createElement("script");r.async=!0,r.onload=function(){n()},r.onerror=function(){throw new Error("load error!")},e?e.append(r):document.body.append(r),r.src=t}):Promise.reject("First parameter must be an array of strings or a string!")}},function(t,e,n){"use strict";n.r(e);var i=n(18),r=n(16);i.default.defaultjs=i.default.defaultjs||{},i.default.defaultjs.html=i.default.defaultjs.html||{},i.default.defaultjs.html.form=i.default.defaultjs.html.form||{VERSION:"1.0.0-beta.10",Form:r.Form,Page:r.Page,BaseField:r.BaseField,Field:r.Field,Container:r.Container,List:r.List}}]);
//# sourceMappingURL=browser-defaultjs-html-form.min.js.map