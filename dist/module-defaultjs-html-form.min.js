!function(t){var e={};function i(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e),i.d(e,"Form",(function(){return $t})),i.d(e,"Page",(function(){return Pt})),i.d(e,"BaseField",(function(){return U})),i.d(e,"Field",(function(){return Y})),i.d(e,"List",(function(){return wt})),i.d(e,"Container",(function(){return at}));const n={Form:"d-form",Control:"d-control",BackButton:"d-control-back",NextButton:"d-control-next",SummaryButton:"d-control-summary",SubmitButton:"d-control-submit",CancelButton:"d-control-cancel",Page:"d-page",Field:"d-field",WrapperField:"d-wrapper-field",List:"d-list",ListRows:"d-rows",ListRow:"d-row",ButtonAddRow:"d-add-row",ButtonDeleteRow:"d-delete-row",Container:"d-container",Validation:"d-validation",Message:"d-message",ProgressBar:"d-progress-bar",Step:"d-step"},a="init",s="input",r="summary",o="finished",l={initialize:"d-event-initialize",input:"d-event-input",valueChanged:"d-event-value-changed",executeValidate:"d-event-execute-validate",activeStateChanged:"d-event-active-state-changed",conditionStateChanged:"d-event-condition-state-changed",validStateChanged:"d-event-valid-state-changed",siteChanged:"d-event-site-changed",formStateChanged:"d-event-form-state-changed",allPublishValue:"d-event-all-publish-value",submit:"d-event-submit",progressbarChanged:"d-event-progress-bar-changed",added:"d-event-added",change:"d-event-change",changeAttributeEventBuilder:t=>"d-event-change-attribute-"+t,changeActive:"d-event-change-active",changeValue:"d-event-change-value",changeCondition:"d-event-change-condition",changeValidation:"d-event-change-validation",listRowAdd:"d-event-list-row-add",listRowDelete:"d-event-list-row-delete"},u="$value",c="$item",d=(t,e,i)=>{let n=null;return function(a){n&&clearTimeout(n),n=setTimeout((function(){n=null,t(a)}),10),e&&a.preventDefault(),i&&a.stopPropagation()}},h=(t,e,i=!1)=>{const n=t.active;e?t.attr("active",""):t.attr("active",null),(n!=e||i)&&t.trigger(10,l.activeStateChanged)},p=["active","readonly","condition","condition-valid","condition-invalid"];class f extends HTMLElement{static get observedAttributes(){return p}constructor(){super()}async init(){await this.initBase()}async initBase(){this.form=this.parent(n.Form)}connectedCallback(){Promise.resolve(this.init()).then(()=>{this.trigger(l.initialize)})}adoptedCallback(){this.connectedCallback()}attributeChangedCallback(t,e,i){e!=i&&(this.trigger(10,l.changeAttributeEventBuilder(t)),this.trigger(10,l.change))}get active(){return this.hasAttribute("active")}set active(t){this.active!=t&&(h(this,t),this.activeUpdated())}activeUpdated(){}get readonly(){return this.hasAttribute("readonly")}set readonly(t){t?this.attr("readonly",""):this.attr("readonly",null),this.readonlyUpdated()}readonlyUpdated(){}get condition(){return!this.hasAttribute("condition-invalid")}conditionUpdated(){}get valid(){return this.hasAttribute("valid")}}var g=f,v=i(4);class m{constructor(t,e){this.key=t,this.context=e}get keyDefined(){return this.key in this.context}get hasValue(){return!!this.context[this.key]}get value(){return this.context[this.key]}set value(t){this.context[this.key]=t}set append(t){if(this.hasValue){const e=this.value;e instanceof Array?e.push(t):this.value=[this.value,t]}else this.value=t}remove(){delete this.context[this.key]}static load(t,e,i=!0){let n=t;const a=e.split(".");let s=a.shift().trim();for(;a.length>0;){if(!n[s]){if(!i)return null;n[s]={}}n=n[s],s=a.shift().trim()}return new m(s,n)}}const b=function(t){return void 0!==t&&null!=t&&"Object"===t.constructor.name},y=function(t){for(let e=1;e<arguments.length;e++){const i=arguments[e];Object.getOwnPropertyNames(i).forEach(e=>{b(t[e])?y(t[e],i[e]):t[e]=i[e]})}return t},x=function(){const[t,e,{deep:i=!1,recursive:n=!0,parents:a=[]}={}]=arguments,s={};for(name in t){const r=t[name],o=e(name,r,t);if(!o||i&&null!=r){if(o&&i){"object"!==typeof r||r instanceof Array||r instanceof Map||r instanceof Set||r instanceof RegExp||a.includes[r]||r==t?s[name]=r:s[name]=x(r,e,{deep:i,recursive:n,parents:a.concat(t)})}}else s[name]=r}return s};var w={isPojo:b,append:function(t,e,i){if(void 0!==e){m.load(i,t,!0).append=e}return i},merge:y,filter:x,buildPropertyFilter:function({names:t,allowed:e}){return(i,n,a)=>t.includes(i)===e}};class _{constructor(t){this.hasValue=1==arguments.length,this.value=t}}class C{constructor(t,e){this.data=t,this.resolver=e,this.cache=new Map}updateData(t){this.data=t,this.cache=new Map}resetCache(){this.cache=new Map}getPropertyDef(t,e=!0){if(this.cache.has(t))return this.cache.get(t);let i=null;if(this.data&&t in this.data)i={data:this.data,resolver:this.resolver,defined:!0};else{if(!e)return null;i=((t,e)=>{for(;t;){const i=t.proxy.handle.getPropertyDef(e,!1);if(i)return i;t=t.parent}return{data:null,resolver:null,defined:!1}})(this.resolver.parent,t)}return i.defined&&this.cache.set(t,i),i}hasProperty(t){const{defined:e}=this.getPropertyDef(t);return e}getProperty(t){const{data:e}=this.getPropertyDef(t);return e?e[t]:void 0}setProperty(t,e){const{data:i,defined:n}=this.getPropertyDef(t);n?i[t]=e:(this.data||(this.data={}),this.data[t]=e,this.cache.set(t,{data:this.data,resolver:this.resolver,defined:!0}))}deleteProperty(t){throw new Error("unsupported function!")}}class P{constructor(t,e){this.handle=new C(t,e),this.data=new Proxy(this.handle,{has:function(t,e){return t.hasProperty(e)},get:function(t,e){return t.getProperty(e)},set:function(t,e,i){return t.setProperty(e,i)},deleteProperty:function(t,e){return t.deleteProperty(e)}})}updateData(t){this.handle.updateData(t)}resetCache(){this.handle.resetCache()}}const V=/\$\{(([a-zA-Z0-9\-_\s]+)::)?([^\{\}]+)\}/,A=new _,E=t=>t instanceof _?t:new _(t),k=async function(t,e,i,n){if(i&&t.name!=i)return t.parent?k(t.parent,e,i,n):null;const a=await function(t,e){if("string"!=typeof t)return t;return new Function("context",`try{with(context){return ${t}}}catch(e){throw e;}`)(e)}(e,t.proxy.data);return null!=a?a:n instanceof _&&n.hasValue?n.value:a},T=t=>t?0==(t=t.trim()).length?null:t:null;class B{constructor({context:t=v.default,parent:e=null,name:i=null}){this.parent=e instanceof B?e:null,this.name=i,this.context=t,this.proxy=new P(this.context,this)}get chain(){return this.parent?this.parent.chain+"/"+this.name:"/"+this.name}get effectiveChain(){return this.context?this.parent?this.parent.effectiveChain+"/"+this.name:"/"+this.name:this.parent?this.parent.effectiveChain:""}get contextChain(){const t=[];let e=this;for(;e;)e.context&&t.push(e.context),e=e.parent;return t}getData(t,e){if(t){if(!e||e==this.name){const e=m.load(this.context,t,!1);return e?e.value:null}this.parent&&this.parent.getData(t,e)}}updateData(t,e,i){if(t)if(i&&i!=this.name)this.parent&&this.parent.updateData(t,e,i);else{null!=this.context&&void 0!==this.context||(this.context={},this.proxy.updateData(this.context));m.load(this.context,t).value=e,this.proxy.resetCache()}}mergeContext(t,e){e&&e!=this.name?this.parent&&this.parent.mergeContext(t,e):this.context=this.context?w.merge(this.context,t):t}async resolve(t,e){const i=2==arguments.length?E(e):A;try{const e=V.exec(t);return e?await k(this,e[3],T(e[2]),i):await k(this,T(t),null,i)}catch(e){return console.error('error at executing statment"',t,'":',e),i.hasValue?i.value:t}}async resolveText(t,e){let i=t,n=t,a=V.exec(i);const s=2==arguments.length?E(e):A;for(;null!=a;){const t=await this.resolve(a[0],s);n=n.split(a[0]).join(),i=i.split(a[0]).join(void 0===t?"undefined":null==t?"null":t),a=V.exec(n)}return i}static async resolve(t,e,i,n){const a=new B({context:e}),s=arguments.length>2?E(i):A;return"number"==typeof n&&n>0?new Promise(e=>{setTimeout(()=>{e(a.resolve(t,s))},n)}):a.resolve(t,s)}static async resolveText(t,e,i,n){const a=new B({context:e}),s=arguments.length>2?E(i):A;return"number"==typeof n&&n>0?new Promise(e=>{setTimeout(()=>{e(a.resolveText(t,s))},n)}):a.resolveText(t,s)}static buildSecure({context:t,propFilter:e,option:i={deep:!0},name:n,parent:a}){return t=w.filter({data:t,propFilter:e,option:i}),new B({context:t,name:n,parent:a})}}const S=["active","condition"];class z extends HTMLElement{static get observedAttributes(){return S}static init(t){(t=>{t.active=!1})(t)}constructor(){super()}connectedCallback(){z.init(this)}attributeChangedCallback(t,e,i){e!=i&&(this.trigger(l.changeAttributeEventBuilder(t)),this.trigger(l.change))}get active(){return this.hasAttribute("active")}set active(t){t?this.attr("active",""):this.attr("active",void 0)}get condition(){return this.attr("condition")}}window.customElements.define(n.Validation,z);var D=z;const R=({root:t,filter:e})=>{let i=[];return t.children.forEach(t=>{const{accept:n,stop:a=!1}=e(t);if(n&&i.push(t),!a){const n=R({root:t,filter:e});n instanceof Array?i=i.concat(n):n&&i.push(n)}}),i},M=function(t){return void 0!==t&&null!=t&&"Object"===t.constructor.name},L=function(t){for(let e=1;e<arguments.length;e++){const i=arguments[e];Object.getOwnPropertyNames(i).forEach(e=>{M(t[e])?L(t[e],i[e]):t[e]=i[e]})}return t};var F={isPojo:M,append:function(t,e,i){if(void 0!==e){const n=t.toLowerCase().trim();if(void 0===i[n])i[n]=e;else{const t=i[n];t instanceof Array?t.push(e):i[n]=[i[n],e]}}return i},merge:L};const I=t=>{const e={};e[u]=t.value;let i=t.parent(n.ListRow),a=e;for(;i;)a[c]=i.value,a=a[c],i=i.parent(n.ListRow);return F.merge(e,t.form.data)};var O=class{constructor(t){var e;this.inital=!0,this.target=t,this.customChecks=[],this.validations=R({root:e=t,filter:t=>{if(e!=t){if(t instanceof U)return{accept:!1,stop:!0};if(t instanceof D)return{accept:!0,stop:!0}}return{accept:!1}}})||[],this.condition=t.attr("condition")}addCustomCheck(t){this.customChecks.push(t)}get form(){return this.target.form}async validate(){const{target:t,validations:e,customChecks:i,condition:n}=this,{hasValue:a,required:s,requiredOnlyOnActive:r}=t,o=(i.length>0||e.length,I(t));((t,e,i=!1)=>{const n=t.condition;e?(t.attr("condition-invalid",null),t.attr("condition-valid","")):(t.attr("condition-valid",null),t.attr("condition-invalid","")),(n!=e||i)&&t.trigger(10,l.conditionStateChanged)})(t,!n||await B.resolve(n,o,!1),this.inital);let u=!s||a;if(u)for(let e of i){await e({data:o,target:t})||(u=!1)}for(let t of e)if(u&&a){const e=await B.resolve(t.condition,o,!0);t.active=!e,e||(u=!1)}else t.active=!1;return((t,e,i=!1)=>{const n=t.valid;void 0===e||null==e?(t.attr("invalid",null),t.attr("valid",null)):e?(t.attr("invalid",null),t.attr("valid","")):(t.attr("invalid",""),t.attr("valid",null)),(n!=e||i)&&t.trigger(10,l.validStateChanged)})(t,u,this.inital),this.inital=!1,u}};const N=["name","required","no-value"];class j extends g{static get observedAttributes(){return N.concat(g.observedAttributes)}constructor(t=null){super(),this.__value__=t}async init(){await this.initBaseField()}async initBaseField(){await this.initBase(),this.parentField=(t=>{let e=t.parentNode;for(;e;){if(e instanceof j)return e;e=e.parentNode}return null})(this),this.validator=new O(this),this.on(l.conditionStateChanged,t=>{t.target==this&&this.conditionUpdated()}),this.on(l.input,t=>{t.target==this&&(this.__value__=t.detail?t.detail[0]:null,this.validate(),this.publishValue())}),this.form.on(l.executeValidate,async t=>{if(t.detail[0].indexOf(this)<0){this.valid!=await this.validate()&&this.publishValue()}}),this.form.on(l.allPublishValue,()=>{this.publishValue()}),this.validate()}conditionUpdated(){this.active=this.condition}get name(){return this.getAttribute("name")}get required(){return this.hasAttribute("required")}get hasValue(){const t=this.value;return null!=t&&void 0!==t}get value(){return this.__value__}set value(t){this.__value__!=t&&this.acceptValue(t)&&(t=this.normalizeValue(t),this.__value__!=t&&(this.__value__=t,this.updatedValue(t),this.validate(),this.publishValue()))}async validate(){var t;if(t=this.hasValue,this.attr("no-value",t?null:""),!this.validator)return!1;return await this.validator.validate()}async publishValue(t=[]){t.push(this);let e=null;e=this.value,setTimeout(()=>{this.trigger(l.valueChanged,t)},10)}acceptValue(t){return!0}normalizeValue(t){return t}async updatedValue(){}}var U=j;class G{static findInput(t){return null}constructor(t,e){this.field=t,this.input=e,this.init()}init(){}set readonly(t){}acceptValue(t){return!0}normalizeValue(t){return t}updatedValue(){}get value(){return null}get valid(){return!0}}const H={accept:t=>t instanceof Date,value:t=>t.valueAsDate,normalize:t=>t||null},$={text:{accept:t=>"string"==typeof t,value:t=>t.value,normalize:t=>t&&(t=t.trim()).length>0?t:null},number:{accept:t=>"number"==typeof t,value:t=>t.valueAsNumber,normalize:t=>t&&!Number.isNaN(t)?t:null},date:H,time:H};const q=()=>Math.floor(Math.random()*Date.now());const J=(t,e)=>new Promise((i,n)=>{const a=new FileReader;a.addEventListener("loadend",()=>{i({name:t.name,type:t.type,size:t.size,data:a.result})},!1),a[e](t)}),W={"form-input":async t=>(t.format="form-input",t),"data-url-base64":async t=>{const e=await J(t,"readAsDataURL");return e.format="data-url-base64",e},base64:async t=>{const e=await J(t,"readAsDataURL");return e.data=e.data.substr(e.data.indexOf(",")+1),e.format="base64",e}},X=async(t,e,i)=>{let n=[];for(let i of t)n.push(await W[e](i));return 0==n.length?null:i?n:n[0]};const Z=[class extends G{static findInput(t){return t.find('input:not([type="file"]):not([type="radio"]):not([type="checkbox"]) ,input:not([type]), textarea').first()}constructor(t,e){super(t,e)}init(){const{field:t,input:e}=this,i=(t.attr("input-type")||e.attr("type")||"text").trim().toLowerCase();this.type=$[i]||$.text,e.on("input",d(()=>{t.trigger(l.input,this.normalizeValue(this.value))},!1,!0)),t.trigger(l.input,this.normalizeValue(this.value))}acceptValue(t){return null==t||void 0===t||this.type.accept(t)}normalizeValue(t){return null==t&&void 0===t?null:this.type.normalize(t)}updatedValue(t){this.field.value!=this.input.value&&this.input.val(t||null)}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){return this.type.value(this.input)}get valid(){return this.input.checkValidity()}},class extends G{static findInput(t){const e=t.find('input[type="checkbox"]');return 0==e.length?null:1==e.length?e.first():e}constructor(t,e){super(t,e)}init(){const{field:t,input:e}=this;this.multiple=e instanceof NodeList,e.on("input",d(()=>{t.trigger(l.input,this.normalizeValue(this.value))},!1,!0)),t.trigger(l.input,this.normalizeValue(this.value))}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){const t=this.input.val();if(!(t instanceof Map))return t;if(0==t.size)return null;const e=[];return t.forEach(t=>{e.push(t)}),e}normalizeValue(t){return t?this.multiple?0!=(t=t.filter(t=>!!t)).length?t:null:t:null}acceptValue(t){if(null==t||void 0===t)return!0;if(this.multiple)return t instanceof Array;{const e=typeof t;return"string"===e||"boolean"===e}}updatedValue(t){this.field.value!=this.value&&this.input.val(t||null)}},class extends G{static findInput(t){const e=t.find('input[type="radio"]');return 0==e.length?null:e}constructor(t,e){super(t,e)}init(){const{field:t,input:e}=this,i=t.name+q();for(let t of e)t.name=i;e.on("input",d(()=>{t.trigger(l.input,this.normalizeValue(this.value))},!1,!0)),t.trigger(l.input,this.normalizeValue(this.value))}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){const t=this.input.val();return t instanceof Map?0==t.size?null:t.values().next().value:t}normalizeValue(t){return t||null}acceptValue(t){if(null==t||void 0===t)return!0;{const e=typeof t;return"string"===e||"boolean"===e}}updatedValue(t){this.field.value!=this.value&&this.input.val(t||null)}},class extends G{static findInput(t){return t.find('input[type="file"]').first()}constructor(t,e){super(t,e)}async init(){const{field:t,input:e}=this;this.multiple=e.multiple,this.format=t.attr("file-format")||"form-input",this.filenameTarget=t.attr("file-name-target"),this.filenameTarget=this.filenameTarget?t.find(this.filenameTarget).first():null;const{format:i,multiple:n}=this;e.on("input",d(async()=>{this.updatedValue(await X(e.files,i,n)),t.trigger(l.input,this.value)},!1,!0)),e.files&&0!=e.files.length&&this.updatedValue(await X(e.files,i,n)),t.trigger(l.input,this.value)}set readonly(t){this.input.attr("disabled",t?"":null)}acceptValue(t){return null==t||void 0===t||(this.multiple?t instanceof Array:t instanceof"object")}normalizeValue(t){return null==t||void 0===t?null:this.multiple?0!=t.length?t:null:t}updatedValue(t){if(t!=this.__value__&&(this.__value__=t,this.filenameTarget&&t))if(this.multiple)for(let e of t)this.filenameTarget.append(`<span>${e.name}</span>`);else this.filenameTarget.append(`<span>${t.name}</span>`)}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){return this.__value__}get valid(){return this.input.checkValidity()}},class extends G{static findInput(t){return t.find("select").first()}constructor(t,e){super(t,e)}init(){const{field:t,input:e}=this;e.on("input, changed",d(()=>{t.trigger(l.input,this.value)},!1,!0)),t.trigger(l.input,this.value)}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){return this.normalizeValue(this.input.multiple?this.input.val():this.input.value)}normalizeValue(t){return t?this.input.multiple?0!=(t=t.filter(t=>t&&t.trim().length>0)).length?t:null:0!=(t=t.trim()).length?t:null:null}acceptValue(t){return null==t||void 0===t||(this.input.multiple?t instanceof Array:"string"==typeof t)}updatedValue(t){this.field.value!=this.value&&this.input.val(t||null)}}],K=["file-format"];class Q extends U{static get observedAttributes(){return K.concat(U.observedAttributes)}constructor(){super()}async init(){await this.initField()}async initField(){await this.initBaseField(),this.wrapper=(t=>{for(let e of Z){const i=e.findInput(t);if(i)return new e(t,i)}return null})(this),this.wrapper&&this.validator.addCustomCheck(async()=>this.wrapper.valid)}readonlyUpdated(){this.wrapper&&(this.wrapper.readonly=this.readonly)}acceptValue(t){return!!this.wrapper&&this.wrapper.acceptValue(t)}normalizeValue(t){return this.wrapper?this.wrapper.normalizeValue(t):t}updatedValue(t){this.wrapper&&this.wrapper.updatedValue(t)}}customElements.define(n.Field,Q);var Y=Q;const tt=[],et=/\./g,it=function(t,e,i){if(null==t||void 0===t)return null;const n=arguments.length>2,a=e.split(et);for(;a.length>1;){const e=a.shift();let i=t[e];const s="undefiend"!=typeof i&&null!=i;if(!s&&!n)return null;!s&&n&&(i=t[e]={}),t=i}if(!n)return t[a[0]]?t[a[0]]:null;t[a[0]]=i};class nt extends U{static get observedAttributes(){return tt.concat(U.observedAttributes)}constructor(t=null){super(t||{}),this.fields=[],this.on(l.valueChanged,t=>{if(t.target!=this){const{name:e,value:i}=t.target;e?it(this.__value__,e,i):null!=i&&F.merge(this.__value__,i),this.validate(),this.publishValue(t.detail[0]),t.preventDefault(),t.stopPropagation()}})}async init(){await this.initContainer()}async initContainer(){await this.initBaseField(),this.fields=R({root:this,filter:t=>t instanceof U?{accept:!0,stop:!0}:{accept:!1}}),this.on(l.initialize,t=>{if(t.target!=this){const e=t.target;e instanceof U&&(this.fields.indexOf(e)<0&&this.fields.push(e),t.preventDefault(),t.stopPropagation())}}),this.validator.addCustomCheck(async({data:t,target:e})=>{const{fields:i}=e;if(i){const t=i.length;for(let e=0;e<t;e++){const t=i[e];if(t.condition&&!t.valid)return!1}}return!0})}readonlyUpdated(){const{readonly:t,fields:e}=this;if(e)for(let i of e)i.readonly=t}updatedValue(t){this.__value__={};const{fields:e}=this;if(e)for(let i of e)i.name?i.value=it(t,i.name):i instanceof nt&&(i.value=t)}}customElements.define(n.Container,nt);var at=nt;const st=["active","disabled"];class rt extends HTMLElement{static get observedAttributes(){return st}static init(t){var e;(e=t).form=e.parent(n.Form),e.active=!1,e.disabled=!1,e.on("click",t=>{e.active&&!e.disabled&&e.execute(),t.preventDefault(),t.stopPropagation()})}constructor(){super()}connectedCallback(){rt.init(this)}attributeChangedCallback(t,e,i){e!=i&&(this.trigger(TRIGGER_TIMEOUT,EVENTS.changeAttributeEventBuilder(t)),this.trigger(TRIGGER_TIMEOUT,EVENTS.change))}get active(){return this.hasAttribute("active")}set active(t){t?this.attr("active",""):this.attr("active",null)}get disabled(){return this.hasAttribute("disabled")}set disabled(t){t?this.attr("disabled",""):this.attr("disabled",null)}execute(){console.log("execute")}}var ot=rt;const lt=[];class ut extends ot{static get observedAttributes(){return lt.concat(lt)}static init(t){ot.init(t),t.active=!0}constructor(){super()}connectedCallback(){ut.init(this)}execute(){this.trigger(100,l.listRowDelete)}}customElements.define(n.ButtonDeleteRow,ut);const ct=[];class dt extends at{static get observedAttributes(){return ct.concat(at.observedAttributes)}constructor(){super()}get active(){return!0}set active(t){}get condition(){return!0}get name(){return null}}customElements.define(n.ListRow,dt);var ht=dt;const pt=[];class ft extends ot{static get observedAttributes(){return pt.concat(pt)}static init(t){ot.init(t),t.active=!0}constructor(){super()}connectedCallback(){ft.init(this)}execute(){this.trigger(100,l.listRowAdd)}}customElements.define(n.ButtonAddRow,ft);var gt=ft;const vt=[];class mt extends HTMLElement{static get observedAttributes(){return vt.concat(vt)}static init(t){}constructor(){super()}connectedCallback(){mt.init(this)}}customElements.define(n.ListRows,mt);const bt=["max"],yt=(t,e)=>{const{container:i,template:n}=t,a=document.importNode(n.content,!0).children[0];return i.append(a),e&&setTimeout(()=>{a.value=e},10),a};class xt extends U{static get observedAttributes(){return bt.concat(U.observedAttributes)}constructor(t=null){super(t||[]),this.template=this.find("template").first(),this.container=this.find(n.ListRows).first(),this.on([l.valueChanged,l.initialize],t=>{if(t.target instanceof ht){const e=this.rows,i=t.target,{value:n}=i,a=e.indexOf(i);this.__value__[a]=n,this.validate(),this.publishValue(t.detail?t.detail[0]:[i]),t.preventDefault(),t.stopPropagation()}})}async init(){this.initList()}async initList(){await this.initBaseField();const{container:t,template:e,validator:i}=this,a=R({root:this,filter:t=>t instanceof gt?{accept:!0,stop:!0}:t instanceof U?{accept:!1,stop:!0}:{accept:!1}})[0];i.addCustomCheck(async({})=>{const{rows:t,max:e,readonly:i}=this,n=t.length;return i||(n==e?a.disabled=!0:n<e&&(a.disabled=!1)),n<=e}),i.addCustomCheck(async()=>{const{rows:t}=this;if(t)for(let e of t)if(!e.valid)return!1;return!0}),this.on(l.listRowAdd,t=>{const{readonly:e,__value__:i}=this;if(!e){const t=yt(this);i.push(t.value),this.validate(),this.publishValue()}t.preventDefault(),t.stopPropagation()}),this.on(l.listRowDelete,t=>{const{rows:e,readonly:i,__value__:a}=this;if(!i){const i=t.target.parent(n.ListRow),s=e.indexOf(i);s>=0&&(i.remove(),e.splice(s,1),a.splice(s,1),this.validate(),this.publishValue())}t.preventDefault(),t.stopPropagation()}),this.validate(),this.publishValue()}readonlyUpdated(){const{readonly:t}=this;for(let e of this.rows)e.readonly=t}get rows(){return Array.from(this.container.children)}get max(){return this.hasAttribute("max")?parseInt(this.attr("max")):Number.MAX_SAFE_INTEGER}acceptValue(t){return!t||t instanceof Array}normalizeValue(t){return t.filter(t=>!!t)}get value(){return this.__value__.length>0?this.__value__:null}set value(t){if(this.acceptValue(t)&&(t=this.normalizeValue(t),this.container.children.remove(),this.__value__=[],t))for(let e of t)yt(this,e)}}customElements.define(n.List,xt);var wt=xt;const _t=["step"];class Ct extends at{static get observedAttributes(){return _t.concat(at.observedAttributes)}constructor(){super()}async init(){await this.initPage()}async initPage(){await this.initContainer()}get step(){return this.attr("step")}conditionUpdated(){}}window.customElements.define(n.Page,Ct);var Pt=Ct;const Vt=["active","condition"],At=t=>{t.reference=(t=>{let e=t.parentNode;for(;e;){if(e instanceof g)return e;e=e.parentNode}return null})(t),t.form=t.parent(n.Form),t.form.on(function(){return Array.from(arguments).join(" ")}(l.executeValidate),e=>{t.update()}),t.update()};class Et extends HTMLElement{static get observedAttributes(){return Vt}static init(t){At(t)}constructor(){super()}connectedCallback(){Et.init(this)}attributeChangedCallback(t,e,i){e!=i&&(this.trigger(10,l.changeAttributeEventBuilder(t)),this.trigger(10,l.change))}get active(){return this.hasAttribute("active")}set active(t){t?this.attr("active",""):this.attr("active",void 0)}get condition(){return this.attr("condition")}async update(){const t=I(this.reference);this.active=await B.resolve(this.condition,t,!1)}}window.customElements.define(n.Message,Et);const kt=[];class Tt extends ot{static get observedAttributes(){return kt}static init(t){ot.init(t)}constructor(){super()}execute(){this.form.toPrevPage()}}window.customElements.define(n.BackButton,Tt);const Bt=[];class St extends ot{static get observedAttributes(){return Bt}static init(t){ot.init(t)}constructor(){super()}execute(){this.form.toNextPage()}}window.customElements.define(n.NextButton,St);const zt=[];class Dt extends ot{static get observedAttributes(){return zt}static init(t){ot.init(t)}constructor(){super()}execute(){this.form.toNextPage()}}window.customElements.define(n.SummaryButton,Dt);const Rt=[];class Mt extends ot{static get observedAttributes(){return Rt}static init(t){ot.init(t)}constructor(){super()}execute(){this.form.submit()}}window.customElements.define(n.SubmitButton,Mt);const Lt=[];class Ft extends HTMLElement{static get observedAttributes(){return Lt}static init(t){(t=>{t.form=t.parent(n.Form),t.back=t.find(n.BackButton).first(),t.next=t.find(n.NextButton).first(),t.summary=t.find(n.SummaryButton).first(),t.submit=t.find(n.SubmitButton).first(),t.form.on([l.validStateChanged,l.conditionStateChanged],e=>{e.target instanceof Pt&&t.update()}),t.form.on([l.formStateChanged,l.siteChanged],e=>{t.update()})})(t)}constructor(){super()}connectedCallback(){Ft.init(this)}attributeChangedCallback(t,e,i){e!=i&&(this.trigger(TRIGGER_TIMEOUT,l.changeAttributeEventBuilder(t)),this.trigger(TRIGGER_TIMEOUT,l.change))}update(){const{back:t,next:e,summary:i,submit:n,form:a}=this,{activePageIndex:l,activePage:u,nextPage:c,pages:d,useSummaryPage:h,state:p}=a;t.active=!0,t.disabled=!0,e.active=!1,e.disabled=!0,i.active=!1,i.disabled=!0,n.active=!1,n.disabled=!0,p==o?(t.disabled=!0,n.active=!0):p==r?(t.disabled=!1,n.active=!0,n.disabled=!a.valid):p==s&&(t.disabled=l<=0,c||!u.valid&&l+1<d.length?(e.active=!0,e.disabled=!u.valid):h&&p==s?(i.active=!0,i.disabled=!u.valid):(n.active=!0,n.disabled=!a.valid))}}window.customElements.define(n.Control,Ft);const It=["name","active","readonly"];class Ot extends HTMLElement{static get observedAttributes(){return It}constructor(){super()}connectedCallback(){}adoptedCallback(){this.connectedCallback()}attributeChangedCallback(t,e,i){e!=i&&(this.trigger(10,l.changeAttributeEventBuilder(t)),this.trigger(10,l.change))}get name(){return this.attr("name")}get active(){return this.hasAttribute("active")}set active(t){this.active!=t&&h(this,t)}get readonly(){return this.hasAttribute("readonly")}set readonly(t){t?this.attr("readonly",""):this.attr("readonly",null)}}window.customElements.define(n.Step,Ot);const Nt=["progress"];class jt extends HTMLElement{static get observedAttributes(){return Nt}constructor(){super(),this.progress=0,this.on("click",({target:t})=>{if(!this.form)return;if(t==this)return;const e=t.is(n.Step)?t:t.parent(n.Step).first();if(!e)return;const i=this.form.state,a=this.form.pages,o=(this.form.activePageIndex,this.form.activePage),l=e.name;if(i==s||i==r){const t=((t,e,i)=>{for(let n of t){if(n.step==e&&n.condition)return n;if(n==i)return}return null})(a,l,o);t&&(this.form.activePage=t)}})}connectedCallback(){this.form=this.parent(n.Form),this.steps=this.find(n.Step),this.form.on([l.initialize,l.siteChanged,l.formStateChanged],()=>{const t=this.form.state,e=this.form.activePage;if(!e)return;const i=this.form.activePageIndex,n=this.form.pages.length,u=e?e.step:a,c=Math.floor(100*i/n);for(let e of this.steps){const i=e.name;t==s?(e.active=i==u,e.readonly=!1):t==r?(e.active=i==r,e.readonly=!1):(e.active=i==o,e.readonly=!0)}this.progress=t==r||t==o?100:c,this.trigger(l.progressbarChanged)})}get progress(){return this.attr("progress")}set progress(t){this.style.setProperty&&this.style.setProperty("--progress",t+"%"),this.attr("progress",Math.max(0,Math.min(t,100)))}adoptedCallback(){this.connectedCallback()}attributeChangedCallback(t,e,i){e!=i&&(this.trigger(10,l.changeAttributeEventBuilder(t)),this.trigger(10,l.change))}}window.customElements.define(n.ProgressBar,jt);const Ut=["name","use-summary-page","endpoint","method","state"],Gt=(t,e)=>{for(let i of t.pages)i.readonly=e,i.active=e};class Ht extends HTMLElement{static get observedAttributes(){return Ut}static init(t){(t=>{t.state=a,t.useSummaryPage=t.hasAttribute("use-summary-page"),t.pages=t.find(n.Page),t.activePageIndex=-1,t.pages.length>0&&t.toNextPage()})(t)}constructor(){super(),this.__data__={},this.state=a,this.useSummaryPage=this.hasAttribute("use-summary-page"),this.activePageIndex=-1,this.on(l.valueChanged,t=>{const{name:e,value:i}=t.target;e?this.__data__[e]=i:null!=i&&F.merge(this.__data__,i),this.trigger(l.executeValidate,t.detail[0]),t.preventDefault(),t.stopPropagation()})}connectedCallback(){Ht.init(this)}attributeChangedCallback(t,e,i){e!=i&&(this.trigger(10,l.changeAttributeEventBuilder(t)),this.trigger(10,l.change))}get state(){return this._state}set state(t){const e=this.state;e==s&&t!=s?Gt(this,!0):e!=s&&t==s&&(Gt(this,!1),this.activePage&&(this.activePage.active=!0)),this._state=t,e!=t&&this.trigger(l.formStateChanged),this.attr("state",this._state)}get valid(){for(let t of this.pages)if(!t.valid)return!1;return!0}get data(){return this.__data__}set data(t){if(this.state==s){this.__data__={};for(let e of this.pages)e.name?e.value=t[e.name]:e.value=t;this.trigger(l.allPublishValue)}}get activePage(){return 0<=this.activePageIndex&&this.activePageIndex<this.pages.length?this.pages[this.activePageIndex]:null}set activePage(t){const e=this.activePage;t!=e&&(e&&(e.active=!1),this.activePageIndex=this.pages.indexOf(t),t.active=!0,this.state!=s&&(this.state=s),this.trigger(l.siteChanged))}get prevPage(){for(let t=this.activePageIndex-1;t>=0;t--){const e=this.pages[t];if(e.condition)return e}return null}get nextPage(){if(this.pages){for(let t=this.activePageIndex+1;t<this.pages.length;t++){const e=this.pages[t];if(e.condition)return e}}return null}async toPrevPage(){if(this.state!=s)this.state=s;else{const t=await this.prevPage;t&&(this.activePage=t)}}async toNextPage(){const t=await this.nextPage;t?(this.activePage=t,this.state==a&&(this._state=s)):this.useSummaryPage?this.summary():this.submit()}async summary(){this.state=r}async submit(){this.state=o;const t=this.data;let e=this.attr("endpoint");if(e){e=await B.resolveText(e,t,e);const i=new URL(e,location.origin);return await fetch(i.toString(),{method:(this.attr("method")||"post").toLowerCase(),credentials:"include",mode:"cors",headers:{"content-type":"application/json"},body:JSON.stringify(t)})}this.trigger(l.submit,t)}}window.customElements.define(n.Form,Ht);var $t=Ht},,,function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){"use strict";i.r(e),function(t){const i=void 0!==t?t:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{};e.default=i}.call(this,i(3))}]);
//# sourceMappingURL=module-defaultjs-html-form.min.js.map