!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(t,e,n){"use strict";n.r(e),function(t){const n={global:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},globalVar:function(t,e){return 2===arguments.length&&void 0===n.global[t]&&(n.global[t]=e),n.global[t]}};e.default=n}.call(this,n(2))},function(t,e,n){"use strict";n.r(e),function(t){const n=void 0!==t?t:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{};e.default=n}.call(this,n(2))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";n.r(e),function(t){const n=void 0!==t?t:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{};e.default=n}.call(this,n(2))},function(t,e,n){"use strict";n.r(e);var i=n(1);var r=function(){const t=Array.from(arguments),e=t.shift();for(;t.length>0;){t.shift()(e)}},a=n(0);const s=a.default.globalVar("___DOM_API_EXTENSION_MAP___",{});var o=function(t,e){return function(n){let i=s[n.name];i||(i=s[n.name]={}),i[t]?console.warn('duplicated load of extension "'+t+'"!'):(i[t]=!0,e(n.prototype))}};const l=o("EventSupport",t=>{const e=t=>{if(!t.___EVENTHANDLES___){const e=[];t.___EVENTHANDLES___={append:(n,r,a,s)=>{n.forEach(n=>{e.push({event:n,handle:r,wrapper:a,option:s}),i.call(t,n,a,s)})},remove:(n,i)=>{e.filter(t=>(!n||n.indexOf(t.event)>=0)&&(!i||i==t.handle)).forEach(n=>{const i=e.indexOf(n);r.call(t,n.event,n.wrapper),e.splice(i,1)})}}}return t.___EVENTHANDLES___},n=t=>(t.___EVENTTRIGGERTIMEOUTS___||(t.___EVENTTRIGGERTIMEOUTS___={}),t.___EVENTTRIGGERTIMEOUTS___),i=t.addEventListener;t.addEventListener=function(e,n,i){t.on.call(this,e,n,"boolean"==typeof i?{capture:i,once:!1,passive:!1}:i)},t.on=function(){if(arguments.length<2)throw new Error("Too less arguments!");const t=Array.from(arguments);let n="string"==typeof t[0]?t.shift().split(/(\s+)|(\s*,\s*)/):t.shift();const i="string"==typeof t[0]?t.shift():null,r=t.shift(),a=void 0!==t[0]?t.shift():{capture:!1,once:!1,passive:!1},s=function(t){if(i){const e=t.target.nodeType;if(!(e||e!=Node.DOCUMENT_TYPE_NODE&&e!=Node.DOCUMENT_FRAGMENT_NODE||t.target.is(i)))return}const n=r.apply(r,arguments);return a.once&&e(t.currentTarget).remove([t.type],r),n};return e(this).append(n,r,s,a),this};const r=t.removeEventListener;t.removeEventListener=function(){return t.removeOn.apply(this,arguments)},t.removeOn=function(){const t=Array.from(arguments),n="string"==typeof t[0]?t.shift().split(/(\s+)|(\s*,\s*)/):null,i="function"==typeof t[0]?t.shift():null;e(this).remove(n,i)},t.trigger=function(){const t=Array.from(arguments),e="number"==typeof t[0]?t.shift():-1;if(e>=0){const i=t[0],r=n(this),a=r[i];a&&clearTimeout(a),r[i]=setTimeout(()=>{delete r[i],this.trigger.apply(this,t)},e)}else{const e=t.shift(),n=t[0]instanceof Event?t.shift():null,i=t.length>=1?0==t.length?t.shift():t:n,r=i?new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:i}):new Event(e,{bubbles:!0,cancelable:!0});n&&(r.delegatedEvent=n),this.dispatchEvent(r)}return this}});r(EventTarget,l);var c=o("DataSupport",t=>{t.data=function(){const t={};if(void 0!==this.dataset)for(name in this.dataset)t[name]=this.dataset[name];return this.data=function(){return 0==arguments.length?t:1==arguments.length?t[arguments[0]]:(void 0===arguments[1]||null==arguments[1]?delete t[arguments[0]]:t[arguments[0]]=arguments[1],this)}.bind(this),this.data.apply(null,arguments)}});var u=o("ManipulationSupport",t=>{t.empty=function(){let t=this.childNodes;for(;0!=t.length;)t[0].remove(!0);return this},t.content=function(){return this.childNodes},t.html=function(){return 0==arguments.length?this.innerHTML:1==arguments.length&&"boolean"==typeof arguments[0]?arguments[0]?this.outerHTML:this.innerHTML:(Array.from(arguments).forEach(t=>{this.empty(),("string"==typeof t||t instanceof Node||t instanceof NodeList||t instanceof HTMLCollection)&&this.append(t)}),this)};const e=function(){const e=t.appendChild.bind(this);for(let t=0;t<arguments.length;t++){let n=arguments[t];n instanceof Node?this.appendChild(n):"string"==typeof n?create(n).forEach(e):"function"==typeof n.forEach&&n.forEach(e)}};t.append=e;const n=function(t,e){this.insertBefore(e,t)};t.prepend=function(){if(0==this.childNodes.length)e.apply(this,arguments);else{const t=this.childNodes.first(),e=n.bind(this,t);for(let t=0;t<arguments.length;t++){const n=arguments[t];n instanceof Node?e(n):("string"==typeof n||"function"==typeof n.forEach)&&n.forEach(e)}}},t.replace=function(){if(arguments.length<1)throw new Error("Insufficient arguments! One or two nodes required!");const t=1==arguments.length?this.parentNode:this,e=1==arguments.length?this:arguments[0],n=1==arguments.length?arguments[0]:arguments[1];n instanceof Array||n instanceof NodeList||n instanceof HTMLCollection?(n.forEach(n=>t.insertBefore(n,e)),e.remove()):t.replaceChild(n,e)},t.after=function(){if(null==this.parentNode)throw new Error("Can't insert nodes after this node! Parent node not available!");const e=this.parentNode,n=this.nextSibling;n?t.before.apply(n,arguments):t.append.apply(e,arguments)},t.before=function(){if(null==this.parentNode)throw new Error("Can't insert nodes after this node! Parent node not available!");const t=this.parentNode,e=e=>{t.insertBefore(e,this)};for(let t=0;t<arguments.length;t++){const n=arguments[t];n instanceof Node?e(n):("string"==typeof n||"function"==typeof n.forEach)&&n.forEach(e)}}});r(Node,c,u);const h=/:parent(\(\"([^\)]*)\"\))?/i,d=function(t,e){let n=h.exec(e);if(!n)return t.querySelectorAll(e);{let i=t;if(n.index>0&&(i=t.querySelectorAll(e.substr(0,n.index)),0==i.length))return;if(i=i.parent(n[2]),i){let t=e.substr(n.index+n[0].length).trim();return t.length>0&&(i=i.find(t)),i}}};var f=o("QuerySupport",t=>{t.find=function(){let t=[],e=Array.from(arguments),n=e.shift();for(;n;){if("string"==typeof n){let e=d(this,n);e&&t.push(e)}n=e.shift()}let i=NodeList.from.apply(null,t);return i},t.is=function(){if(this instanceof Document)return!1;if(1==arguments.length){if("string"==typeof arguments[0])return this.matches(arguments[0]);if("number"==typeof arguments[0].length){let t=arguments[0];for(let e=0;e<t.length;e++)if(this.matches(t[e]))return!0}}else if(arguments.length>1)return this.is(Array.from(arguments));return!1},t.parent=function(){if(this.parentNode){if("string"==typeof arguments[0]){let t=this.parentNode;try{for(;t&&!t.is(arguments[0]);)t=t.parent(arguments[0])}catch(e){console.error("this:",this,"parent:",t,"error:",e)}return t}return this.parentNode}},t.parents=function(){let e=new Array,n=t.parent.apply(this,arguments);for(;n;)e.push(n),n=t.parent.apply(n,arguments);return NodeList.from(e)},t.selector=function(){if(!(this instanceof Document||this instanceof DocumentFragment)){if(this.id)return"#"+this.id;{let t=this.tagName.toLowerCase(),e=this.parent();if(e){let n=e.find(":scope>"+t);if(n instanceof NodeList){let e=n.indexOf(this);e>0&&(t+=":nth-child("+(e+1)+")")}let i=e.selector();return i?i+">"+t:t}return t}}},t.closest=function(t){let e=this;for(;e;){let n=e.find(t);if(n&&n.length>0)return n;if(e.is(t))return NodeList.from(e);e=e.parent()}},t.nested=function(t){if(this.is(t))return NodeList.from(this);let e=this.find(t);return e&&e.length>0?e:NodeList.from(this.parent(t))}});const p=o("AttributeSupport",t=>{t.attr=function(){return 0==arguments.length?this.hasAttributes()?(()=>{const t={};return this.getAttributeNames().forEach(e=>{t[e]=this.getAttribute(e)}),t})():void 0:1==arguments.length?this.getAttribute(arguments[0]):(void 0===arguments[1]||null==arguments[1]?this.removeAttribute(arguments[0]):this.setAttribute(arguments[0],arguments[1]),this)}});r(Element,f,p,u);const g=o("ReadyEventSupport",t=>{t.ready=function(t,e){return this.on("ready",t,e),"complete"==document.readyState&&this.trigger("ready"),this}});r(Document,f,g),document.addEventListener("DOMContentLoaded",()=>document.trigger("ready")),r(DocumentFragment,f,u);var v=o("HtmlClassSupport",t=>{t.addClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach(t=>this.classList.add(t)):arguments.length>1&&Array.prototype.forEach.call(arguments,t=>this.classList.add(t)),this},t.removeClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach(t=>this.classList.remove(t)):arguments.length>1&&Array.prototype.forEach.call(arguments,t=>this.classList.remove(t)),this},t.toggleClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach(t=>this.classList.toggle(t)):arguments.length>1&&Array.prototype.forEach.call(arguments,t=>this.classList.toggle(t)),this}});const m=t=>"none"===t.style.display,y=t=>{let e=m(t)?"":t.style.display;return t.show=function(){return this.style.display=e,this}.bind(t),t.hide=function(){return this.style.display="none",this}.bind(t),t},b=o("ShowHideSupport",t=>{t.show=function(){return y(this).show.apply(null,arguments)},t.hide=function(){return y(this).hide.apply(null,arguments)},t.toggleShow=function(){return m(this)?this.show():this.hide()}});r(HTMLElement,v,b);const w=[{selector:"select",get:function(){const t=[];return this.find("option").forEach(e=>{e.selected&&t.push(e.value)}),t},set:function(){let t=[];const e=Array.from(arguments);let n=e.shift();for(;n;)Array.isArray(n)?t=t.concat(n):t.push(n),n=e.shift();this.value=t,this.find("option").forEach(e=>e.selected=t.indexOf(e.value)>=0),this.trigger("changed")}},{selector:'input[type="checkbox"], input[type="radio"]',get:function(){return"on"==this.value||"off"==this.value?this.checked:this.checked?this.value:void 0},set:function(t){"boolean"==typeof t?this.checked=t:"string"==typeof t?this.checked=this.value==t:Array.isArray(t)&&(this.checked=t.indexOf(this.value)>=0),this.trigger("changed")}}],E={get:function(){return this.value},set:function(t){this.value=t,this.trigger("input")}},x=function(t){for(let e=0;e<w.length;e++)if(t.is(w[e].selector))return w[e];return E};var _=o("ValueSupport",t=>{t.val=function(){let t=x(this);return 0==arguments.length?t.get.apply(this,arguments):(t.set.apply(this,arguments),this)}});r(HTMLInputElement,_),r(HTMLTextAreaElement,o("ValueSupport",t=>{t.val=function(){return 0==arguments.length?this.value:(this.value=arguments[0],this)}})),r(HTMLSelectElement,_);var A=function(){const t=Array.from(arguments),e=t.shift(),n=t.shift();t.forEach(t=>{Object.getOwnPropertyNames(t).forEach(i=>{const r=Object.getOwnPropertyDescriptor(t,i);void 0===n[i]&&"function"==typeof r.value&&(n[i]=function(){return e.call(this,i,arguments)})})})};var T=o("ListSupport",t=>{t.indexOf=function(){for(let t=0;t<this.length;t++)if(this[t]==arguments[0])return t;return-1},t.forEach=function(){return Array.prototype.forEach.apply(Array.from(this),arguments)},t.map=function(){return Array.prototype.map.apply(Array.from(this),arguments)},t.filter=function(){return Array.prototype.filter.apply(Array.from(this),arguments)},t.first=function(){if(this.length>0)return this[0]},t.last=function(){if(this.length>0)return this[this.length-1]}});r(NodeList,T),NodeList.prototype.applyTo=function(){const t=Array.from(arguments),e=t.shift(),n="function"==typeof e,i=[];for(let r=0;r<this.length;r++){const a=this[r];let s;n?s=e.apply([a].concat(t)):"function"==typeof a[e]&&(s=a[e].apply(a,t)),s&&i.push(s)}return i},NodeList.prototype.val=function(){if(0==arguments.length){if(this.length>0){const t=new Map;return this.forEach(e=>{if("function"==typeof e.val){e.val()&&t.set(e.name||e.id||e.selector(),e.val())}}),t}}else NodeList.prototype.applyTo.apply(this,["val"].concat(Array.from(arguments)))},NodeList.from=function(){const t=Array.from(arguments),e={};let n=0;for(;t.length>0;){const i=t.shift();if(void 0!==i&&null!=i)if(i instanceof Node)e[n++]={value:i,enumerable:!0};else if(i instanceof NodeList||i instanceof HTMLCollection||i instanceof Array)for(let t=0;t<i.length;t++)i[t]&&i[t]instanceof Node&&(e[n++]={value:i[t],enumerable:!0})}return e.length={value:n},Object.create(NodeList.prototype,e)},A((function(t,e){let n=[];return this.forEach(i=>{if(i&&"function"==typeof i[t]){const r=i[t].apply(i,e);r&&(r instanceof NodeList?n=n.concat(Array.from(r)):n.push(r))}}),0===n.length?void 0:n[0]instanceof Node||n[0]instanceof NodeList?NodeList.from(n):n}),NodeList.prototype,Node.prototype,HTMLElement.prototype,HTMLInputElement.prototype,Element.prototype,EventTarget.prototype),r(HTMLCollection,T),HTMLCollection.prototype.applyTo=function(){const t=Array.from(arguments),e=t.shift(),n="function"==typeof e,i=[];for(let r=0;r<this.length;r++){const a=this[r];let s;n?s=e.apply([a].concat(t)):"function"==typeof a[e]&&(s=a[e].apply(a,t)),s&&i.push(s)}return i},HTMLCollection.prototype.val=function(){if(0==arguments.length){if(this.length>0){const t=new Map;return this.forEach(e=>{if("function"==typeof e.val){e.val()&&t.set(e.name||e.id||e.selector(),e.val())}}),t}}else HTMLCollection.prototype.applyTo.apply(this,["val"].concat(Array.from(arguments)))},HTMLCollection.from=function(){const t=Array.from(arguments),e={};let n=0;for(;t.length>0;){const i=t.shift();if(void 0!==i&&null!=i)if(i instanceof HTMLElement)e[n++]={value:i,enumerable:!0};else if(i instanceof HTMLCollection||i instanceof NodeList||i instanceof Array)for(let t=0;t<i.length;t++)i[t]&&i[t]instanceof HTMLElement&&(e[n++]={value:i[t],enumerable:!0})}return e.length={value:n},Object.create(HTMLCollection.prototype,e)},A((function(t,e){let n=[];return this.forEach(i=>{if(i&&"function"==typeof i[t]){let r=i[t].apply(i,e);r&&(r instanceof HTMLCollection?n=n.concat(Array.from(r)):n.push(r))}}),0===n.length?void 0:n[0]instanceof HTMLElement||n[0]instanceof HTMLCollection?HTMLCollection.from.apply(null,n):n}),HTMLCollection.prototype,Node.prototype,HTMLElement.prototype,HTMLInputElement.prototype,Element.prototype,EventTarget.prototype),a.default.global.defaultjs=a.default.global.defaultjs||{},a.default.global.defaultjs.extdom=a.default.global.defaultjs.extdom||{VERSION:"1.0.0-beta.1",utils:{Utils:a.default}},a.default.global.find=function(){return document.find.apply(document,arguments)},a.default.global.ready=function(){return document.ready.apply(document,arguments)},a.default.global.create=function(t,e){if("string"!=typeof arguments[0])throw new Error("The first argument must be a string!");const n=document.createElement("template");return n.innerHTML=t,e?n:document.importNode(n.content,!0).childNodes},a.default.global.script=function(t,e){return t instanceof Array?Promise.all(t.map(t=>a.default.global.script(t,e))):"string"==typeof t?new Promise((n,i)=>{const r=document.createElement("script");r.async=!0,r.onload=function(){n()},r.onerror=function(){throw new Error("load error!")},e?e.append(r):document.body.append(r),r.src=t}):Promise.reject("First parameter must be an array of strings or a string!")};const C={Form:"d-form",Control:"d-control",BackButton:"d-control-back",NextButton:"d-control-next",SummaryButton:"d-control-summary",SubmitButton:"d-control-submit",CancelButton:"d-control-cancel",Page:"d-page",Field:"d-field",WrapperField:"d-wrapper-field",List:"d-list",ListRows:"d-rows",ListRow:"d-row",ButtonAddRow:"d-add-row",ButtonDeleteRow:"d-delete-row",Container:"d-container",Validation:"d-validation",Message:"d-message"},L="init",N="input",P="summary",M="finished",V={initialize:"d-event-initialize",input:"d-event-input",valueChanged:"d-event-value-changed",executeValidate:"d-event-execute-validate",added:"d-event-added",change:"d-event-change",changeSite:"d-event-change-site",changeAttributeEventBuilder:t=>"d-event-change-attribute-"+t,changeActive:"d-event-change-active",changeValue:"d-event-change-value",changeCondition:"d-event-change-condition",changeValidation:"d-event-change-validation",listRowAdd:"d-event-list-row-add",listRowDelete:"d-event-list-row-delete"},O="$value",S="$item",k=function(){return Array.from(arguments).join(" ")},D=(t,e,n)=>{let i=null;return function(r){i&&clearTimeout(i),i=setTimeout((function(){i=null,t(r)}),200),e&&r.preventDefault(),n&&r.stopPropagation()}},H=["active","readonly","condition","condition-valid","condition-invalid"];class R extends HTMLElement{static get observedAttributes(){return H}constructor(){super()}async init(){await this.initBase()}async initBase(){this.form=this.parent(C.Form)}connectedCallback(){Promise.resolve(this.init()).then(()=>{this.trigger(100,V.initialize)})}attributeChangedCallback(t,e,n){e!=n&&(this.trigger(100,V.changeAttributeEventBuilder(t)),this.trigger(100,V.change))}get active(){return this.hasAttribute("active")}set active(t){this.active!=t&&(((t,e,n=!1)=>{const i=t.active;e?t.attr("active",""):t.attr("active",null),(i!=e||n)&&t.trigger(100,V.changeActive)})(this,t),this.activeUpdated())}activeUpdated(){}get readonly(){return this.hasAttribute("readonly")}set readonly(t){t?this.attr("readonly",""):this.attr("readonly",null),this.readonlyUpdated()}readonlyUpdated(){}get condition(){return!this.hasAttribute("condition-invalid")}get valid(){return!0}}var B=R,j=n(3);class I{constructor(t,e){this.key=t,this.context=e}get keyDefined(){return this.key in this.context}get hasValue(){return!!this.context[this.key]}get value(){return this.context[this.key]}set value(t){this.context[this.key]=t}set append(t){if(this.hasValue){const e=this.value;e instanceof Array?e.push(t):this.value=[this.value,t]}else this.value=t}remove(){delete this.context[this.key]}static load(t,e,n=!0){let i=t;const r=e.split(".");let a=r.shift().trim();for(;r.length>0;){if(!i[a]){if(!n)return null;i[a]={}}i=i[a],a=r.shift().trim()}return new I(a,i)}}const F=function(t){return void 0!==t&&null!=t&&"Object"===t.constructor.name},U=function(t){for(let e=1;e<arguments.length;e++){const n=arguments[e];Object.getOwnPropertyNames(n).forEach(e=>{F(t[e])?U(t[e],n[e]):t[e]=n[e]})}return t},z=function(){const[t,e,{deep:n=!1,recursive:i=!0,parents:r=[]}={}]=arguments,a={};for(name in t){const s=t[name],o=e(name,s,t);if(!o||n&&null!=s){if(o&&n){"object"!==typeof s||s instanceof Array||s instanceof Map||s instanceof Set||s instanceof RegExp||r.includes[s]||s==t?a[name]=s:a[name]=z(s,e,{deep:n,recursive:i,parents:r.concat(t)})}}else a[name]=s}return a};var G={isPojo:F,append:function(t,e,n){if(void 0!==e){I.load(n,t,!0).append=e}return n},merge:U,filter:z,buildPropertyFilter:function({names:t,allowed:e}){return(n,i,r)=>t.includes(n)===e}};class q{constructor(t){this.hasValue=1==arguments.length,this.value=t}}class ${constructor(t,e){this.data=t,this.resolver=e,this.cache=new Map}updateData(t){this.data=t,this.cache=new Map}resetCache(){this.cache=new Map}getPropertyDef(t,e=!0){if(this.cache.has(t))return this.cache.get(t);let n=null;if(this.data&&t in this.data)n={data:this.data,resolver:this.resolver,defined:!0};else{if(!e)return null;n=((t,e)=>{for(;t;){const n=t.proxy.handle.getPropertyDef(e,!1);if(n)return n;t=t.parent}return{data:null,resolver:null,defined:!1}})(this.resolver.parent,t)}return n.defined&&this.cache.set(t,n),n}hasProperty(t){const{defined:e}=this.getPropertyDef(t);return e}getProperty(t){const{data:e}=this.getPropertyDef(t);return e?e[t]:void 0}setProperty(t,e){const{data:n,defined:i}=this.getPropertyDef(t);i?n[t]=e:(this.data||(this.data={}),this.data[t]=e,this.cache.set(t,{data:this.data,resolver:this.resolver,defined:!0}))}deleteProperty(t){throw new Error("unsupported function!")}}class X{constructor(t,e){this.handle=new $(t,e),this.data=new Proxy(this.handle,{has:function(t,e){return t.hasProperty(e)},get:function(t,e){return t.getProperty(e)},set:function(t,e,n){return t.setProperty(e,n)},deleteProperty:function(t,e){return t.deleteProperty(e)}})}updateData(t){this.handle.updateData(t)}resetCache(){this.handle.resetCache()}}const Q=/\$\{(([a-zA-Z0-9\-_\s]+)::)?([^\{\}]+)\}/,W=new q,Y=t=>t instanceof q?t:new q(t),Z=async function(t,e,n,i){if(n&&t.name!=n)return t.parent?Z(t.parent,e,n,i):null;const r=await function(t,e){if("string"!=typeof t)return t;return new Function("context",`try{with(context){return ${t}}}catch(e){throw e;}`)(e)}(e,t.proxy.data);return null!=r?r:i instanceof q&&i.hasValue?i.value:r},J=t=>t?0==(t=t.trim()).length?null:t:null;class K{constructor({context:t=j.default,parent:e=null,name:n=null}){this.parent=e instanceof K?e:null,this.name=n,this.context=t,this.proxy=new X(this.context,this)}get chain(){return this.parent?this.parent.chain+"/"+this.name:"/"+this.name}get effectiveChain(){return this.context?this.parent?this.parent.effectiveChain+"/"+this.name:"/"+this.name:this.parent?this.parent.effectiveChain:""}get contextChain(){const t=[];let e=this;for(;e;)e.context&&t.push(e.context),e=e.parent;return t}getData(t,e){if(t){if(!e||e==this.name){const e=I.load(this.context,t,!1);return e?e.value:null}this.parent&&this.parent.getData(t,e)}}updateData(t,e,n){if(t)if(n&&n!=this.name)this.parent&&this.parent.updateData(t,e,n);else{null!=this.context&&void 0!==this.context||(this.context={},this.proxy.updateData(this.context));I.load(this.context,t).value=e,this.proxy.resetCache()}}mergeContext(t,e){e&&e!=this.name?this.parent&&this.parent.mergeContext(t,e):this.context=this.context?G.merge(this.context,t):t}async resolve(t,e){const n=2==arguments.length?Y(e):W;try{const e=Q.exec(t);return e?await Z(this,e[3],J(e[2]),n):await Z(this,J(t),null,n)}catch(e){return console.error('error at executing statment"',t,'":',e),n.hasValue?n.value:t}}async resolveText(t,e){let n=t,i=t,r=Q.exec(n);const a=2==arguments.length?Y(e):W;for(;null!=r;){const t=await this.resolve(r[0],a);i=i.split(r[0]).join(),n=n.split(r[0]).join(void 0===t?"undefined":null==t?"null":t),r=Q.exec(i)}return n}static async resolve(t,e,n,i){const r=new K({context:e}),a=arguments.length>2?Y(n):W;return"number"==typeof i&&i>0?new Promise(e=>{setTimeout(()=>{e(r.resolve(t,a))},i)}):r.resolve(t,a)}static async resolveText(t,e,n,i){const r=new K({context:e}),a=arguments.length>2?Y(n):W;return"number"==typeof i&&i>0?new Promise(e=>{setTimeout(()=>{e(r.resolveText(t,a))},i)}):r.resolveText(t,a)}static buildSecure({context:t,propFilter:e,option:n={deep:!0},name:i,parent:r}){return t=G.filter({data:t,propFilter:e,option:n}),new K({context:t,name:i,parent:r})}}const tt=["active","condition"];class et extends HTMLElement{static get observedAttributes(){return tt}static init(t){(t=>{t.active=!1})(t)}constructor(){super()}connectedCallback(){et.init(this)}attributeChangedCallback(t,e,n){e!=n&&(this.trigger(V.changeAttributeEventBuilder(t)),this.trigger(V.change))}get active(){return this.hasAttribute("active")}set active(t){t?this.attr("active",""):this.attr("active",void 0)}get condition(){return this.attr("condition")}}window.customElements.define(C.Validation,et);var nt=et;const it=({root:t,filter:e})=>{let n=[];return t.children.forEach(t=>{const{accept:i,stop:r=!1}=e(t);if(i&&n.push(t),!r){const i=it({root:t,filter:e});i instanceof Array?n=n.concat(i):i&&n.push(i)}}),n},rt=function(t){return void 0!==t&&null!=t&&"Object"===t.constructor.name},at=function(t){for(let e=1;e<arguments.length;e++){const n=arguments[e];Object.getOwnPropertyNames(n).forEach(e=>{rt(t[e])?at(t[e],n[e]):t[e]=n[e]})}return t};var st={isPojo:rt,append:function(t,e,n){if(void 0!==e){const i=t.toLowerCase().trim();if(void 0===n[i])n[i]=e;else{const t=n[i];t instanceof Array?t.push(e):n[i]=[n[i],e]}}return n},merge:at};const ot=t=>{const e={};e[O]=t.value;let n=t.parent(C.ListRow),i=e;for(;n;)i[S]=n.value,i=i[S],n=n.parent(C.ListRow);return st.merge(e,t.form.data)};var lt=class{constructor(t){var e;this.target=t,this.customChecks=[],this.validations=it({root:e=t,filter:t=>{if(e!=t){if(t instanceof ht)return{accept:!1,stop:!0};if(t instanceof nt)return{accept:!0,stop:!0}}return{accept:!1}}})||[],this.condition=t.attr("condition"),t.form.on(V.executeValidate,D(t=>{console.log("on",V.executeValidate,{event:t,target:this.target}),this.validate()}))}addCustomCheck(t){this.customChecks.push(t)}get form(){return this.target.form}async validate(){const{target:t,validations:e,customChecks:n,condition:i}=this,{hasValue:r,required:a,requiredOnlyOnActive:s}=t,o=n.length>0||e.length>0,l=ot(t),c=!i||K.resolve(i,l,!1);if(t.condition!=c&&((t,e,n=!1)=>{const i=t.condition;e?(t.attr("condition-invalid",null),t.attr("condition-valid","")):(t.attr("condition-valid",null),t.attr("condition-invalid","")),(i!=e||n)&&t.trigger(100,V.changeCondition)})(t,c),!i)return!0;if(!r&&a)return!1;if(!o)return!0;let u=!0;for(let e of this.customChecks){await e({data:l,target:t})||(u=!1)}for(let t of e)if(r&&active){const e=await K.resolve(t.condition,l,!0);t.active=!e,e||(u=!1)}else t.active=!1;return u}};const ct=["name","required","no-value"];class ut extends B{static get observedAttributes(){return ct.concat(B.observedAttributes)}constructor(){super(),this.__value__=null}async init(){await this.initBaseField()}async initBaseField(){await this.initBase(),this.parentField=(t=>{let e=t.parentNode;for(;e;){if(e instanceof ut)return e;e=e.parentNode}return null})(this),this.validator=new lt(this),this.on(V.input,D(t=>{t.target==this&&(this.__value__=t.detail?t.detail[0]:null,console.log(V.input,{value:this.__value__}),this.validate())},!0,!0)),this.on(V.changeCondition,D(t=>{t.target==this&&(this.active=this.condition,this.active&&this.validate())})),this.validate()}get name(){return this.getAttribute("name")}get required(){return this.hasAttribute("required")}get hasValue(){return null!=this.__value__&&void 0!==this.__value__}get value(){return this.__value__}set value(t){this.__value__!=t&&this.acceptValue(t)&&(t=this.normalizeValue(t),this.__value__!=t&&(this.__value__=t,this.updatedValue(t),this.validate()))}async validate(){var t;t=this.hasValue,this.attr("no-value",t?null:"");((t,e,n=!1)=>{const i=t.valid;void 0===e||null==e?(t.attr("invalid",null),t.attr("valid",null)):e?(t.attr("invalid",null),t.attr("valid","")):(t.attr("invalid",""),t.attr("valid",null)),(i!=e||n)&&t.trigger(100,V.changeValidation)})(this,await this.validator.validate()),this.publishValue()}async publishValue(){let t=null;this.condition&&(t=this.value),console.log("trigger:",V.valueChanged,{value:t,target:this}),this.trigger(100,V.valueChanged,t)}acceptValue(t){return!0}normalizeValue(t){return t}async updatedValue(){}}var ht=ut;class dt{static accept(t){}constructor(t){this.field=t,this.init()}init(){}set readonly(t){}acceptValue(t){return!0}normalizeValue(t){return t}updatedValue(){}get value(){return null}}const ft='input[type="text"], input[type="password"], input[type="email"], input[type="tel"], input:not([type]), textarea';const pt=t=>{const{field:e}=t,n=e.name+Math.floor(Math.random()*Date.now()),i=t.input=e.find('input[type="radio"]');for(let t of i)t.name=n;i.on("change",D(()=>{e.trigger(V.changeValue)}))};const gt=(t,e)=>new Promise((n,i)=>{const r=new FileReader;r.addEventListener("loadend",()=>{n({name:t.name,type:t.type,size:t.size,data:r.result})},!1),r[e](t)}),vt=async t=>{console.log("update input");const{input:e,field:n,format:i,filenameTarget:r}=t;e.files[0]?(t.file=await mt[i](e.files[0]),t.file.format=i,r&&(r.textContent=t.file.name)):t.file=null,n.trigger(V.changeValue)},mt={"form-input":async t=>t,"data-url-base64":async t=>gt(t,"readAsDataURL"),base64:async t=>{const e=await gt(t,"readAsDataURL");return e.data=e.data.substr(e.data.indexOf(",")+1),e}};const yt=[class extends dt{static accept(t){return t.find(ft).length>0}constructor(t){super(t)}init(){const{field:t}=this,e=this.input=t.find(ft).first();e.on("input",D(()=>{t.trigger(V.input,this.normalizeValue(e.value))},!1,!0)),t.trigger(V.input,this.normalizeValue(e.value))}normalizeValue(t){return t&&t.trim().length>0?t:null}acceptValue(t){return null==t||void 0===t||"string"==typeof t}updatedValue(t){this.field.value!=this.input.value&&(this.input.value=t||null)}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){return this.input.value}},class extends dt{static accept(t){return t.find('input[type="number"]').length>0}constructor(t){super(t),(t=>{const{field:e}=t;(t.input=e.find('input[type="number"]').first()).on("change input",D(()=>{e.trigger(V.changeValue)}),!1,!0)})(this)}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){return this.input.value}set value(t){this.input.value=t||null}},class extends dt{static accept(t){return t.find('input[type="checkbox"]').length>0}constructor(t){super(t),(t=>{const{field:e}=t;t.input=e.find('input[type="checkbox"]'),1==t.input.length&&(t.input=t.input.first()),t.input.on("change input",D(()=>{e.trigger(V.changeValue)}),!1,!0)})(this)}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){const t=this.input.val();if(!(t instanceof Map))return t;if(0==t.size)return null;const e=[];return t.forEach(t=>{e.push(t)}),e}set value(t){this.input.val(t)}},class extends dt{static accept(t){return t.find('input[type="radio"]').length>0}constructor(t){super(t),pt(this)}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){const t=this.input.val();return t instanceof Map?0==t.size?null:t.values().next().value:t}set value(t){this.input.val(t)}},class extends dt{static accept(t){return t.find('input[type="file"]').length>0}constructor(t){super(t),this.format=t.attr("file-format")||"form-input",this.filenameTarget=t.attr("file-name-target"),this.filenameTarget=t.find(this.filenameTarget).first(),(t=>{const{field:e}=t,n=t.input=e.find('input[type="file"]').first();n.on("input",()=>{vt(t)},!1,!0),n.files[0]&&vt(t)})(this)}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){return this.file}set value(t){t.format==this.format&&(this.file=t)}},class extends dt{static accept(t){return t.find("select").length>0}constructor(t){super(t),(t=>{const{field:e}=t;(t.input=e.find("select").first()).on("change input",D(()=>{e.trigger(V.changeValue)}),!1,!0)})(this)}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){return this.input.multiple?this.input.val():this.input.value}set value(t){this.input.val(t||null)}}],bt=["file-format"];class wt extends ht{static get observedAttributes(){return bt.concat(ht.observedAttributes)}constructor(){super()}async init(){await this.initField()}async initField(){await this.initBaseField(),this.wrapper=(t=>{for(let e of yt)if(e.accept(t))return new e(t);return null})(this)}readonlyUpdated(){this.wrapper&&(this.wrapper.readonly=this.readonly)}acceptValue(t){return!!this.wrapper&&this.wrapper.acceptValue(t)}normalizeValue(t){return this.wrapper?this.wrapper.normalizeValue(t):t}updatedValue(t){this.wrapper&&this.wrapper.updatedValue(t)}}customElements.define(C.Field,wt);var Et=wt;const xt=[];class _t extends ht{static get observedAttributes(){return xt.concat(ht.observedAttributes)}constructor(){super(),this.fields=[],this.__value__={},this.on(V.valueChanged,t=>{if(t.target!=this){const{name:e,value:n}=t.target;console.log(V.valueChanged,{name:e,value:n,event:t}),e?this.__value__[e]=n:null!=n&&st.merge(this.__value__,n),this.validate(),t.preventDefault(),t.stopPropagation()}})}async init(){await initContainer()}async initContainer(){await this.initBaseField(),this.fields=it({root:this,filter:t=>t instanceof ht?{accept:!0,stop:!0}:{accept:!1}}),this.on(V.initialize,t=>{if(t.target!=this){const e=t.target;e instanceof ht&&(this.fields.indexOf(e)<0&&(this.fields.push(e),this.validate),t.preventDefault(),t.stopPropagation())}}),this.validator.addCustomCheck(async({data:t,target:e})=>{const{fields:n}=e;if(n){const t=n.length;for(let e=0;e<t;e++){const t=n[e];if(t.active&&t.condition&&!t.valid)return!1}}return!0})}readonlyUpdated(){const{readonly:t,fields:e}=this;for(let n of e)n.readonly=t}updatedValue(){const{value:t,fields:e}=this;for(let n of e)n.name?n.value=t[n.name]:n instanceof _t&&(n.value=t)}}customElements.define(C.Container,_t);var At=_t;const Tt=["active","disabled"];class Ct extends HTMLElement{static get observedAttributes(){return Tt}static init(t){var e;(e=t).form=e.parent(C.Form),e.active=!1,e.disabled=!1,e.on("click",t=>{e.active&&!e.disabled&&e.execute(),t.preventDefault(),t.stopPropagation()})}constructor(){super()}connectedCallback(){Ct.init(this)}attributeChangedCallback(t,e,n){e!=n&&(this.trigger(TRIGGER_TIMEOUT,EVENTS.changeAttributeEventBuilder(t)),this.trigger(TRIGGER_TIMEOUT,EVENTS.change))}get active(){return this.hasAttribute("active")}set active(t){t?this.attr("active",""):this.attr("active",null)}get disabled(){return this.hasAttribute("disabled")}set disabled(t){t?this.attr("disabled",""):this.attr("disabled",null)}execute(){console.log("execute")}}var Lt=Ct;const Nt=[];class Pt extends Lt{static get observedAttributes(){return Nt.concat(Nt)}static init(t){Lt.init(t),t.active=!0}constructor(){super()}connectedCallback(){Pt.init(this)}execute(){this.trigger(100,V.listRowDelete)}}customElements.define(C.ButtonDeleteRow,Pt);const Mt=[];class Vt extends At{static get observedAttributes(){return Mt.concat(At.observedAttributes)}static init(t){At.init(t)}constructor(){super()}connectedCallback(){Vt.init(this)}get active(){return!0}set active(t){}get condition(){return!0}get name(){return null}}customElements.define(C.ListRow,Vt);var Ot=Vt;const St=[];class kt extends Lt{static get observedAttributes(){return St.concat(St)}static init(t){Lt.init(t),t.active=!0}constructor(){super()}connectedCallback(){kt.init(this)}execute(){this.trigger(100,V.listRowAdd)}}customElements.define(C.ButtonAddRow,kt);var Dt=kt;const Ht=[];class Rt extends HTMLElement{static get observedAttributes(){return Ht.concat(Ht)}static init(t){}constructor(){super()}connectedCallback(){Rt.init(this)}}customElements.define(C.ListRows,Rt);const Bt=["max"],jt=(t,e)=>{const{container:n,template:i}=t,r=new Ot;n.append(r),r.append(document.importNode(i.content,!0).childNodes),e&&(r.value=e)};class It extends ht{static get observedAttributes(){return Bt.concat(ht.observedAttributes)}static init(t){Field.init(t),(t=>{const{container:e,template:n,validator:i}=t,r=it({root:t,filter:t=>t instanceof Dt?{accept:!0,stop:!0}:t instanceof Field?{accept:!1,stop:!0}:{accept:!1}})[0];i.addCustomCheck(async({data:e,target:n})=>{const i=t.rows.length,a=t.max;return t.readonly||(i==a?r.disabled=!0:i<a&&(r.disabled=!1)),i<=a}),i.addCustomCheck(async({data:t,target:e})=>{if(e.rows)for(let t of e.rows)if(!t.valid)return!1;return!0}),t.on(V.initialize,t=>{t.preventDefault(),t.stopPropagation()}),t.on(V.listRowAdd,e=>{t.readonly||(jt(t),t.trigger(100,V.changeValue)),e.preventDefault(),e.stopPropagation()}),t.on(V.listRowDelete,e=>{if(!t.readonly){e.target.parent(C.ListRow).remove(),t.trigger(100,V.changeValue)}e.preventDefault(),e.stopPropagation()}),t.on(V.changeValue,D(t=>{}))})(t)}constructor(){super(),this.template=this.find("template").first(),this.container=this.find(C.ListRows).first()}connectedCallback(){It.init(this)}readonlyUpdated(){const{readonly:t}=this;for(let e of this.rows)e.readonly=t}get rows(){return this.container.children}get max(){return this.hasAttribute("max")?parseInt(this.attr("max")):Number.MAX_SAFE_INTEGER}get value(){if(!this.rows||null==this.rows.length)return null;const t=[];let e=!1;for(let n of this.rows)if(n.valid){const i=n.value;void 0!==i&&null!=i&&(t.push(i),e=!0)}return e?{}[this.name]=t:null}set value(t){const{rows:e}=this;if(e){let t=e.first();for(;t;)t.remove(),t=e.first()}if(t instanceof Array){for(let e of t)jt(this,e);this.trigger(100,V.changeValue)}}}customElements.define(C.List,It);const Ft=["step"];class Ut extends At{static get observedAttributes(){return Ft.concat(At.observedAttributes)}constructor(){super()}async init(){await this.initPage()}async initPage(){await this.initContainer()}}window.customElements.define(C.Page,Ut);const zt=["active","condition"],Gt=t=>{t.reference=(t=>{let e=t.parentNode;for(;e;){if(e instanceof B)return e;e=e.parentNode}return null})(t),t.form=t.parent(C.Form),t.form.on(k(V.executeValidate),D(e=>{t.update()})),t.update()};class qt extends HTMLElement{static get observedAttributes(){return zt}static init(t){Gt(t)}constructor(){super()}connectedCallback(){qt.init(this)}attributeChangedCallback(t,e,n){e!=n&&(this.trigger(100,V.changeAttributeEventBuilder(t)),this.trigger(100,V.change))}get active(){return this.hasAttribute("active")}set active(t){t?this.attr("active",""):this.attr("active",void 0)}get condition(){return this.attr("condition")}async update(){const t=ot(this.reference);this.active=await K.resolve(this.condition,t,!1)}}window.customElements.define(C.Message,qt);const $t=[];class Xt extends Lt{static get observedAttributes(){return $t}static init(t){Lt.init(t)}constructor(){super()}execute(){this.form.toPrevPage()}}window.customElements.define(C.BackButton,Xt);const Qt=[];class Wt extends Lt{static get observedAttributes(){return Qt}static init(t){Lt.init(t)}constructor(){super()}execute(){this.form.toNextPage()}}window.customElements.define(C.NextButton,Wt);const Yt=[];class Zt extends Lt{static get observedAttributes(){return Yt}static init(t){Lt.init(t)}constructor(){super()}execute(){this.form.summary()}}window.customElements.define(C.SummaryButton,Zt);const Jt=[];class Kt extends Lt{static get observedAttributes(){return Jt}static init(t){Lt.init(t)}constructor(){super()}execute(){this.form.submit()}}window.customElements.define(C.SubmitButton,Kt);const te=[];class ee extends HTMLElement{static get observedAttributes(){return te}static init(t){(t=>{t.form=t.parent(C.Form),t.back=t.find(C.BackButton).first(),t.next=t.find(C.NextButton).first(),t.summary=t.find(C.SummaryButton).first(),t.submit=t.find(C.SubmitButton).first(),t.form.on(k(V.changeCondition,V.changeValidation,V.changeSite),D(e=>{t.update()}))})(t)}constructor(){super()}connectedCallback(){ee.init(this)}attributeChangedCallback(t,e,n){e!=n&&(this.trigger(TRIGGER_TIMEOUT,V.changeAttributeEventBuilder(t)),this.trigger(TRIGGER_TIMEOUT,V.change))}update(){const{back:t,next:e,summary:n,submit:i,form:r}=this,{activePageIndex:a,activePage:s,nextPage:o,pages:l,useSummaryPage:c,state:u}=r;t.active=!0,t.disabled=a<=0,e.active=!1,e.disabled=!0,n.active=!1,n.disabled=!0,i.active=!1,i.disabled=!0,u==M?(t.disabled=!0,i.active=!0):o||!s.valid&&a+1<l.length?(e.active=!0,e.disabled=!s.valid):c&&u==N?(n.active=!0,n.disabled=!s.valid):(i.active=!0,i.disabled=!r.valid)}}window.customElements.define(C.Control,ee);const ne=["name","use-summary-page"],ie=(t,e)=>{for(let n of t.pages)n.readonly=e,n.active=e},re=t=>{t.trigger(100,V.changeSite)};class ae extends HTMLElement{static get observedAttributes(){return ne}static init(t){(t=>{t.state=L,t.useSummaryPage=t.hasAttribute("use-summary-page"),t.pages=t.find(C.Page),t.activePageIndex=-1,t.pages.length>0&&t.toNextPage()})(t)}constructor(){super(),this.__data__={},this.state=L,this.useSummaryPage=this.hasAttribute("use-summary-page"),this.activePageIndex=-1,this.on(V.valueChanged,t=>{if(t.target!=this){const{name:e,value:n}=t.target;console.log(V.valueChanged,{name:e,value:n,event:t}),e?this.__data__[e]=n:null!=n&&st.merge(this.__data__,n),this.trigger(100,V.executeValidate),t.preventDefault(),t.stopPropagation()}})}connectedCallback(){ae.init(this)}attributeChangedCallback(t,e,n){e!=n&&(this.trigger(100,V.changeAttributeEventBuilder(t)),this.trigger(100,V.change))}get state(){return this._state}set state(t){const e=this.state;e==N&&t!=N?ie(this,!0):e!=N&&t==N&&ie(this,!1),this._state=t}valid(){for(let t of this.pages)if(!t.valid)return!1;return!0}get data(){return this.__data__}set data(t){if(this.state==N){this.__data__=t;for(let e of this.pages)e.name?e.value=t[e.name]:e.value=t}}get activePage(){return 0<=this.activePageIndex&&this.activePageIndex<this.pages.length?this.pages[this.activePageIndex]:null}set activePage(t){this.state!=N&&(this.state=N);const e=this.activePage;t!=e&&(e&&(e.active=!1),this.activePageIndex=this.pages.indexOf(t),t.active=!0,re(this))}get prevPage(){for(let t=this.activePageIndex-1;t>=0;t--){const e=this.pages[t];if(e.condition)return e}return null}get nextPage(){for(let t=this.activePageIndex+1;t<this.pages.length;t++){const e=this.pages[t];if(e.condition)return e}return null}async toPrevPage(){const t=await this.prevPage;t&&(this.activePage=t)}async toNextPage(){const t=await this.nextPage;t&&(this.activePage=t)}summary(){this.state=P,re(this)}submit(){this.state=M,re(this)}}window.customElements.define(C.Form,ae);var se=ae;i.default.defaultjs=i.default.defaultjs||{},i.default.defaultjs.html=i.default.defaultjs.html||{},i.default.defaultjs.html.form=i.default.defaultjs.html.form||{VERSION:"1.0.0-beta.1",Form:se,Field:Et}}]);
//# sourceMappingURL=defaultjs-html-form.min.js.map