(()=>{"use strict";var t={d:(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})}};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),t.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var e={};t.r(e),t.d(e,{BaseField:()=>Ae,Container:()=>je,Field:()=>ke,Form:()=>bi,List:()=>ti,Page:()=>ni});const i=function(){const t=Array.from(arguments),e=t.shift();for(;t.length>0;)t.shift()(e)},n={global:"undefined"!=typeof window?window:void 0!==t.g?t.g:"undefined"!=typeof self?self:{},globalVar:function(t,e){return 2===arguments.length&&void 0===n.global[t]&&(n.global[t]=e),n.global[t]}},s=n,r=s.globalVar("___DOM_API_EXTENSION_MAP___",{}),a=function(t,e){return function(i){let n=r[i.name];n||(n=r[i.name]={}),n[t]?console.warn('duplicated load of extension "'+t+'"!'):(n[t]=!0,e(i.prototype))}},o=a("EventSupport",(t=>{const e=/(\s+)|(\s*,\s*)/,i=t=>(t.__wrapperhandlemap__||(t.__wrapperhandlemap__=new Map),t.__wrapperhandlemap__),n=t=>(t.___EVENTTRIGGERTIMEOUTS___||(t.___EVENTTRIGGERTIMEOUTS___={}),t.___EVENTTRIGGERTIMEOUTS___),s=(t,n,s)=>{const{wrapper:r,option:a,events:o,handle:l}=n,u=a.capture;if(s){s="string"==typeof s?s.split(e):s;for(let e of s){const n=o.indexOf(e);n>=0&&(t.removeEventListener(e,r,u),o.splice(n,1)),0==o.length&&i(t).delete(l)}}else{for(let e of o)t.removeEventListener(e,r,u);i(t).delete(l)}};t.on=function(){if(arguments.length<2)throw new Error("Too less arguments!");const t=Array.from(arguments);let n="string"==typeof t[0]?t.shift().split(e):t.shift();const r="string"==typeof t[0]?t.shift():null,a=t.shift(),o=void 0===t[0]?{capture:!1,once:!1,passive:!1}:"boolean"==typeof t[0]?{capture:t.shift(),once:!1,passive:!1}:t.shift(),l=function(t){if(r){const e=t.target;if("function"==typeof e.is&&!e.is(r))return}const e=a.apply(null,arguments);return o.once&&s(this,l),e};i(this).set(a,{handle:a,wrapper:l,events:n,option:o});for(let t of n)this.addEventListener(t,l,o);return this},t.removeOn=function(t,e,n){const r=i(this).get(t);return r?s(this,r,e):this.removeEventListener(t,e,n),this},t.trigger=function(){const t=Array.from(arguments),e="number"==typeof t[0]?t.shift():-1;if(e>=0){const i=t[0],s=n(this),r=s[i];r&&clearTimeout(r),s[i]=setTimeout((()=>{delete s[i],this.trigger.apply(this,t)}),e)}else{const e=t.shift(),i=t[0]instanceof Event?t.shift():null,n=t.length>=1?1==t.length?t.shift():t:i,s=n?new CustomEvent(e,{bubbles:!0,cancelable:!0,composed:!0,detail:n}):new Event(e,{bubbles:!0,cancelable:!0,composed:!0});i&&(s.delegatedEvent=i),this.dispatchEvent(s)}return this}}));i(EventTarget,o);const l=a("DataSupport",(t=>{t.data=function(){const t={};if(void 0!==this.dataset)for(name in this.dataset)t[name]=this.dataset[name];return this.data=function(){return 0==arguments.length?t:1==arguments.length?t[arguments[0]]:(void 0===arguments[1]||null==arguments[1]?delete t[arguments[0]]:t[arguments[0]]=arguments[1],this)}.bind(this),this.data.apply(null,arguments)}})),u=a("ManipulationSupport",(t=>{t.empty=function(){let t=this.childNodes;for(;0!=t.length;)t[0].remove(!0);return this},t.content=function(){return this.childNodes},t.html=function(){return 0==arguments.length?this.innerHTML:1==arguments.length&&"boolean"==typeof arguments[0]?arguments[0]?this.outerHTML:this.innerHTML:(Array.from(arguments).forEach((t=>{this.empty(),("string"==typeof t||t instanceof Node||t instanceof NodeList||t instanceof HTMLCollection)&&this.append(t)})),this)};const e=function(){const e=t.appendChild.bind(this);for(let t=0;t<arguments.length;t++){let i=arguments[t];i instanceof Node?this.appendChild(i):"string"==typeof i?create(i).forEach(e):"function"==typeof i.forEach&&i.forEach(e)}};t.append=e;const i=function(t,e){this.insertBefore(e,t)};t.prepend=function(){if(0==this.childNodes.length)e.apply(this,arguments);else{const t=this.childNodes.first(),e=i.bind(this,t);for(let t=0;t<arguments.length;t++){const i=arguments[t];i instanceof Node?e(i):("string"==typeof i||"function"==typeof i.forEach)&&i.forEach(e)}}},t.replace=function(){if(arguments.length<1)throw new Error("Insufficient arguments! One or two nodes required!");const t=1==arguments.length?this.parentNode:this,e=1==arguments.length?this:arguments[0],i=1==arguments.length?arguments[0]:arguments[1];i instanceof Array||i instanceof NodeList||i instanceof HTMLCollection?(i.forEach((i=>t.insertBefore(i,e))),e.remove()):t.replaceChild(i,e)},t.after=function(){if(null==this.parentNode)throw new Error("Can't insert nodes after this node! Parent node not available!");const e=this.parentNode,i=this.nextSibling;i?t.before.apply(i,arguments):t.append.apply(e,arguments)},t.before=function(){if(null==this.parentNode)throw new Error("Can't insert nodes after this node! Parent node not available!");const t=this.parentNode,e=e=>{t.insertBefore(e,this)};for(let t=0;t<arguments.length;t++){const i=arguments[t];i instanceof Node?e(i):("string"==typeof i||"function"==typeof i.forEach)&&i.forEach(e)}}}));i(Node,l,u);const c=/:parent(\(\"([^\)]*)\"\))?/i,h=function(t,e){let i=c.exec(e);if(!i)return t.querySelectorAll(e);{let n=t;if(i.index>0&&(n=t.querySelectorAll(e.substr(0,i.index)),0==n.length))return;if(n=n.parent(i[2]),n){let t=e.substr(i.index+i[0].length).trim();return t.length>0&&(n=n.find(t)),n}}},d=a("QuerySupport",(t=>{t.find=function(){let t=[],e=Array.from(arguments),i=e.shift();for(;i;){if("string"==typeof i){let e=h(this,i);e&&t.push(e)}i=e.shift()}let n=NodeList.from.apply(null,t);return n},t.is=function(){if(this instanceof Document||this instanceof DocumentFragment)return!1;if(1==arguments.length){if("string"==typeof arguments[0])return this.matches(arguments[0]);if("number"==typeof arguments[0].length){let t=arguments[0];for(let e=0;e<t.length;e++)if(this.matches(t[e]))return!0}}else if(arguments.length>1)return this.is(Array.from(arguments));return!1},t.parent=function(t,e){if(!this.parentNode)return null;e="boolean"==typeof t?t:e,t="string"==typeof t?t:null;let i=this.parentNode;if(i instanceof ShadowRoot&&e&&(i=i.host),t){try{for(;i&&!i.is(t);)i=i.parent(t,e)}catch(t){console.error("this:",this,"parent:",i,"error:",t)}return i}return i},t.parents=function(){let e=new Array,i=t.parent.apply(this,arguments);for(;i;)e.push(i),i=t.parent.apply(i,arguments);return NodeList.from(e)},t.selector=function(){if(!(this instanceof Document||this instanceof DocumentFragment)){if(this.id)return"#"+this.id;{let t=this.tagName.toLowerCase(),e=this.parent();if(e){let i=e.find(":scope>"+t);if(i instanceof NodeList){let e=i.indexOf(this);e>0&&(t+=":nth-child("+(e+1)+")")}let n=e.selector();return n?n+">"+t:t}return t}}},t.closest=function(t){return this.closests(t).first()},t.closests=function(t){const e=this.find(t);if(0!=e.length)return e;const i=this.parentElement;return i?i.closests(t):NodeList.from([])},t.nested=function(t){if(this.is(t))return NodeList.from(this);let e=this.find(t);return e&&e.length>0?e:NodeList.from(this.parent(t))}})),f=d,p=a("AttributeSupport",(t=>{t.attr=function(){return 0==arguments.length?this.hasAttributes()?(()=>{const t={};return this.getAttributeNames().forEach((e=>{t[e]=this.getAttribute(e)})),t})():void 0:1==arguments.length?this.getAttribute(arguments[0]):(void 0===arguments[1]||null==arguments[1]?this.removeAttribute(arguments[0]):this.setAttribute(arguments[0],arguments[1]),this)}}));i(Element,f,p,u);const g=a("ReadyEventSupport",(t=>{t.ready=function(t,e){return this.on("ready",t,e),"complete"==document.readyState&&this.trigger("ready"),this}}));i(Document,f,g),document.addEventListener("DOMContentLoaded",(()=>document.trigger("ready"))),i(DocumentFragment,f,u);const v=a("HtmlClassSupport",(t=>{t.addClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach((t=>this.classList.add(t))):arguments.length>1&&Array.prototype.forEach.call(arguments,(t=>this.classList.add(t))),this},t.removeClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach((t=>this.classList.remove(t))):arguments.length>1&&Array.prototype.forEach.call(arguments,(t=>this.classList.remove(t))),this},t.toggleClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach((t=>this.classList.toggle(t))):arguments.length>1&&Array.prototype.forEach.call(arguments,(t=>this.classList.toggle(t))),this}})),m="none",y=t=>t.style.display===m,b=t=>{let e=y(t)?"":t.style.display;return t.show=function(){return this.style.display=e,this}.bind(t),t.hide=function(){return this.style.display=m,this}.bind(t),t},_=a("ShowHideSupport",(t=>{t.show=function(){return b(this).show.apply(null,arguments)},t.hide=function(){return b(this).hide.apply(null,arguments)},t.toggleShow=function(){return y(this)?this.show():this.hide()}}));i(HTMLElement,v,_);const w=[{selector:"select",get:function(){const t=[];return this.find("option").forEach((e=>{e.selected&&t.push(e.value)})),t},set:function(){let t=[];const e=Array.from(arguments);let i=e.shift();for(;i;)Array.isArray(i)?t=t.concat(i):t.push(i),i=e.shift();this.value=t,this.find("option").forEach((e=>e.selected=t.indexOf(e.value)>=0)),this.trigger("changed")}},{selector:'input[type="checkbox"], input[type="radio"]',get:function(){return"on"==this.value||"off"==this.value?this.checked:this.checked?this.value:void 0},set:function(t){"boolean"==typeof t?this.checked=t:"string"==typeof t?this.checked=this.value==t:Array.isArray(t)&&(this.checked=t.indexOf(this.value)>=0),this.trigger("changed")}}],E={get:function(){return this.value},set:function(t){this.value=t,this.trigger("input")}},x=function(t){for(let e=0;e<w.length;e++)if(t.is(w[e].selector))return w[e];return E},A=a("ValueSupport",(t=>{t.val=function(){let t=x(this);return 0==arguments.length?t.get.apply(this,arguments):(t.set.apply(this,arguments),this)}}));i(HTMLInputElement,A),i(HTMLTextAreaElement,a("ValueSupport",(t=>{t.val=function(){return 0==arguments.length?this.value:(this.value=arguments[0],this)}}))),i(HTMLSelectElement,A);const N=function(){const t=Array.from(arguments),e=t.shift(),i=t.shift();t.forEach((t=>{Object.getOwnPropertyNames(t).forEach((n=>{const s=Object.getOwnPropertyDescriptor(t,n);void 0===i[n]&&"function"==typeof s.value&&(i[n]=function(){return e.call(this,n,arguments)})}))}))},P=a("ListSupport",(t=>{t.indexOf=function(){for(let t=0;t<this.length;t++)if(this[t]==arguments[0])return t;return-1},t.forEach=function(){return Array.prototype.forEach.apply(Array.from(this),arguments)},t.map=function(){return Array.prototype.map.apply(Array.from(this),arguments)},t.filter=function(){return Array.prototype.filter.apply(Array.from(this),arguments)},t.first=function(){if(this.length>0)return this[0]},t.last=function(){if(this.length>0)return this[this.length-1]}}));i(NodeList,P),NodeList.prototype.applyTo=function(){const t=Array.from(arguments),e=t.shift(),i="function"==typeof e,n=[];for(let s=0;s<this.length;s++){const r=this[s];let a;i?a=e.apply([r].concat(t)):"function"==typeof r[e]&&(a=r[e].apply(r,t)),a&&n.push(a)}return n},NodeList.prototype.val=function(){if(0==arguments.length){if(this.length>0){const t=new Map;return this.forEach((e=>{"function"==typeof e.val&&e.val()&&t.set(e.name||e.id||e.selector(),e.val())})),t}}else NodeList.prototype.applyTo.apply(this,["val"].concat(Array.from(arguments)))},NodeList.from=function(){const t=Array.from(arguments),e={};let i=0;for(;t.length>0;){const n=t.shift();if(void 0!==n&&null!=n)if(n instanceof Node)e[i++]={value:n,enumerable:!0};else if(n instanceof NodeList||n instanceof HTMLCollection||n instanceof Array)for(let t=0;t<n.length;t++)n[t]&&n[t]instanceof Node&&(e[i++]={value:n[t],enumerable:!0})}return e.length={value:i},Object.create(NodeList.prototype,e)},N((function(t,e){let i=[];return this.forEach((n=>{if(n&&"function"==typeof n[t]){const s=n[t].apply(n,e);s&&(s instanceof NodeList?i=i.concat(Array.from(s)):i.push(s))}})),0===i.length?void 0:i[0]instanceof Node||i[0]instanceof NodeList?NodeList.from(i):i}),NodeList.prototype,Node.prototype,HTMLElement.prototype,HTMLInputElement.prototype,Element.prototype,EventTarget.prototype),i(HTMLCollection,P),HTMLCollection.prototype.applyTo=function(){const t=Array.from(arguments),e=t.shift(),i="function"==typeof e,n=[];for(let s=0;s<this.length;s++){const r=this[s];let a;i?a=e.apply([r].concat(t)):"function"==typeof r[e]&&(a=r[e].apply(r,t)),a&&n.push(a)}return n},HTMLCollection.prototype.val=function(){if(0==arguments.length){if(this.length>0){const t=new Map;return this.forEach((e=>{"function"==typeof e.val&&e.val()&&t.set(e.name||e.id||e.selector(),e.val())})),t}}else HTMLCollection.prototype.applyTo.apply(this,["val"].concat(Array.from(arguments)))},HTMLCollection.from=function(){const t=Array.from(arguments),e={};let i=0;for(;t.length>0;){const n=t.shift();if(void 0!==n&&null!=n)if(n instanceof HTMLElement)e[i++]={value:n,enumerable:!0};else if(n instanceof HTMLCollection||n instanceof NodeList||n instanceof Array)for(let t=0;t<n.length;t++)n[t]&&n[t]instanceof HTMLElement&&(e[i++]={value:n[t],enumerable:!0})}return e.length={value:i},Object.create(HTMLCollection.prototype,e)},N((function(t,e){let i=[];return this.forEach((n=>{if(n&&"function"==typeof n[t]){let s=n[t].apply(n,e);s&&(s instanceof HTMLCollection?i=i.concat(Array.from(s)):i.push(s))}})),0===i.length?void 0:i[0]instanceof HTMLElement||i[0]instanceof HTMLCollection?HTMLCollection.from.apply(null,i):i}),HTMLCollection.prototype,Node.prototype,HTMLElement.prototype,HTMLInputElement.prototype,Element.prototype,EventTarget.prototype),s.global.defaultjs=s.global.defaultjs||{},s.global.defaultjs.extdom=s.global.defaultjs.extdom||{VERSION:"1.0.1",utils:{Utils:s}},s.global.find=function(){return document.find.apply(document,arguments)},s.global.ready=function(){return document.ready.apply(document,arguments)},s.global.create=function(t,e){if("string"!=typeof arguments[0])throw new Error("The first argument must be a string!");const i=document.createElement("template");return i.innerHTML=t,e?i:document.importNode(i.content,!0).childNodes},s.global.script=function(t,e){return t instanceof Array?Promise.all(t.map((t=>s.global.script(t,e)))):"string"==typeof t?new Promise(((i,n)=>{const s=document.createElement("script");s.async=!0,s.onload=function(){i()},s.onerror=function(){throw new Error("load error!")},e?e.append(s):document.body.append(s),s.src=t})):Promise.reject("First parameter must be an array of strings or a string!")};const T="d-form",M="d-control",V="d-control-back",C="d-control-next",L="d-control-summary",O="d-control-submit",D="d-page",k="d-field",S="d-list",z="d-rows",H="d-row",I="d-add-row",j="d-delete-row",U="d-container",F="d-validation",R="d-message",$="d-progress-bar",G="d-step",q="init",B="input",W="summary",X="finished",J="d-form-initialize",Q="d-form-field-input",Z="d-form-field-value-changed",K="d-form-execute-validate",Y="d-form-active-state-changed",tt="d-form-condition-state-changed",et="d-form-valid-state-changed",it="d-form-site-changed",nt="d-form-state-changed",st="d-form-all-publish-value",rt="d-form-submit",at="d-form-progress-bar-changed",ot="d-form-list-row-add",lt="d-form-list-row-delete",ut="d-form-editable-state-changed",ct="name",ht="endpoint",dt="method",ft="state",pt="step",gt="use-summary-page",vt="input-mode-after-submit",mt="required",yt="condition",bt="active",_t="disabled",wt="editable",Et="editable-condition",xt="readonly",At="no-value",Nt="valid",Pt="invalid",Tt="condition-valid",Mt="condition-invalid",Vt="max",Ct="progress",Lt=(t,e,i,n)=>{let s=null;const r="function"==typeof e?e:()=>e,a="function"==typeof i?i:()=>i;return e=>{r(e)&&e.preventDefault(),a(e)&&e.stopPropagation();const i=(t=>({type:t.type,target:t.target,detail:t.detail,currentTarget:t.currentTarget,explicitOriginalTarget:t.explicitOriginalTarget,originalTarget:t.originalTarget,srcElement:t.srcElement,timeStamp:t.timeStamp}))(e);s&&clearTimeout(s),s=setTimeout((()=>{s=null,t(i)}),n||10)}},Ot=(t,e,i=!1)=>{const n=t.active;e?t.attr(bt,""):t.attr(bt,null),(n!=e||i)&&t.trigger(Y)},Dt=(t,e,i=!1)=>{const n=t.editable;e?(t.attr(wt,""),t.attr(xt,null)):(t.attr(wt,null),t.attr(xt,"")),(n!=e||i)&&t.trigger(ut)},kt=new WeakMap,St=t=>{if(kt.has(t))return kt.get(t);const e={};return kt.set(t,e),e},zt=function(t,e,i){const n=St(t);if(1===arguments.length)return n;if(2===arguments.length)return n[e];if(3!==arguments.length)throw new Error("Not allowed size of arguments!");n[e]=i},Ht=(t,e,i)=>{Object.defineProperty(t,e,{value:i,writable:!1,configurable:!1,enumerable:!1})},It=(t,e,i)=>{Object.defineProperty(t,e,{get:i,configurable:!1,enumerable:!1})},jt=()=>{let t=null,e=null;const i=new Promise(((i,n)=>{t=i,e=n}));let n,s=!1,r=!1;return Ht(i,"resolve",(i=>{n=i,s=!0,n instanceof Error?(r=!0,e(n)):t(n)})),It(i,"value",(()=>n)),It(i,"error",(()=>r)),It(i,"resolved",(()=>s)),i},Ut=(t,e)=>{let i="unsupported";if("string"==typeof e)i=e;else if(e instanceof HTMLElement)i=e.nodeName;else{if("string"!=typeof e.NODENAME)throw new Error(typeof e+" is not supported as pram node!");i=e.NODENAME}return`${i.toLowerCase()}:${t}`},Ft="ready",Rt=new class{constructor(){Ht(this,"weakmap",new WeakMap)}data(t){let e=this.weakmap.get(t);return e||(e={},this.weakmap.set(t,e)),e}value(t,e,i){if(2==arguments.length)return this.data(t)[e];this.data(t)[e]=i}};class $t extends HTMLElement{constructor({shadowRoot:t=!1,content:e=null,createUID:i=!1,uidPrefix:n="id-",uidSuffix:s=""}={}){super(),zt(this,Ft,jt()),i&&this.attr("id",i(n,s)),t&&this.attachShadow({mode:open}),e&&this.root.append("function"==typeof e?e(this):e)}get root(){return this.shadowRoot||this}get ready(){return zt(this,Ft)}async init(){}async destroy(){this.ready.resolved&&zt(this,Ft,jt())}connectedCallback(){this.ownerDocument==document&&(t=>{const e=Rt.data(t);e.initialize&&clearTimeout(e.initialize),e.initialize=setTimeout((async()=>{delete e.initialize,await t.init(),t.ready.resolve(),t.trigger(Ut("initialzed",t))}),100)})(this)}adoptedCallback(){this.connectedCallback()}attributeChangedCallback(t,e,i){e!=i&&this.isConnected&&(this.trigger(100,Ut("attribute--"+t,this)),this.trigger(100,Ut("change",this)))}disconnectedCallback(){this.destroy()}}const Gt=$t,qt=[bt,xt,yt,Tt,Mt,Et],Bt=class extends Gt{static get observedAttributes(){return qt}constructor(){super()}async init(){await super.init()}get form(){return this.__form__||(this.__form__=this.parent(T)),this.__form__}get active(){return this.hasAttribute(bt)}set active(t){this.active!=t&&(Ot(this,t),this.activeUpdated())}activeUpdated(){}get readonly(){return this.hasAttribute(xt)}set readonly(t){Dt(this,!t,!this.ready.resolved),this.readonlyUpdated()}readonlyUpdated(){}get editable(){return this.hasAttribute(wt)}set editable(t){Dt(this,t,!this.ready.resolved),this.editableUpdated()}editableUpdated(){this.readonlyUpdated()}get condition(){return!this.hasAttribute(Mt)}conditionUpdated(){}get valid(){return this.hasAttribute(Nt)}},Wt=void 0!==t.g?t.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{};class Xt{constructor(t,e){this.key=t,this.context=e}get keyDefined(){return this.key in this.context}get hasValue(){return!!this.context[this.key]}get value(){return this.context[this.key]}set value(t){this.context[this.key]=t}set append(t){if(this.hasValue){const e=this.value;e instanceof Array?e.push(t):this.value=[this.value,t]}else this.value=t}remove(){delete this.context[this.key]}static load(t,e,i=!0){let n=t;const s=e.split(".");let r=s.shift().trim();for(;s.length>0;){if(!n[r]){if(!i)return null;n[r]={}}n=n[r],r=s.shift().trim()}return new Xt(r,n)}}const Jt=function(t){return void 0!==t&&null!=t&&"Object"===t.constructor.name},Qt=function(t){for(let e=1;e<arguments.length;e++){const i=arguments[e];Object.getOwnPropertyNames(i).forEach((e=>{Jt(t[e])?Qt(t[e],i[e]):t[e]=i[e]}))}return t},Zt=function(){const[t,e,{deep:i=!1,recursive:n=!0,parents:s=[]}={}]=arguments,r={};for(name in t){const a=t[name],o=e(name,a,t);!o||i&&null!=a?o&&i&&("object"!=typeof a||a instanceof Array||a instanceof Map||a instanceof Set||a instanceof RegExp||s.includes[a]||a==t?r[name]=a:r[name]=Zt(a,e,{deep:i,recursive:n,parents:s.concat(t)})):r[name]=a}return r},Kt={isPojo:Jt,append:function(t,e,i){return void 0!==e&&(Xt.load(i,t,!0).append=e),i},merge:Qt,filter:Zt,buildPropertyFilter:function({names:t,allowed:e}){return(i,n,s)=>t.includes(i)===e}};class Yt{constructor(t){this.hasValue=1==arguments.length,this.value=t}}class te{constructor(t,e){this.data=t,this.resolver=e,this.cache=new Map}updateData(t){this.data=t,this.cache=new Map}resetCache(){this.cache=new Map}getPropertyDef(t,e=!0){if(this.cache.has(t))return this.cache.get(t);let i=null;if(this.data&&t in this.data)i={data:this.data,resolver:this.resolver,defined:!0};else{if(!e)return null;i=((t,e)=>{for(;t;){const i=t.proxy.handle.getPropertyDef(e,!1);if(i)return i;t=t.parent}return{data:null,resolver:null,defined:!1}})(this.resolver.parent,t)}return i.defined&&this.cache.set(t,i),i}hasProperty(t){const{defined:e}=this.getPropertyDef(t);return e}getProperty(t){const{data:e}=this.getPropertyDef(t);return e?e[t]:void 0}setProperty(t,e){const{data:i,defined:n}=this.getPropertyDef(t);n?i[t]=e:(this.data||(this.data={}),this.data[t]=e,this.cache.set(t,{data:this.data,resolver:this.resolver,defined:!0}))}deleteProperty(t){throw new Error("unsupported function!")}}class ee{constructor(t,e){this.handle=new te(t,e),this.data=new Proxy(this.handle,{has:function(t,e){return t.hasProperty(e)},get:function(t,e){return t.getProperty(e)},set:function(t,e,i){return t.setProperty(e,i)},deleteProperty:function(t,e){return t.deleteProperty(e)}})}updateData(t){this.handle.updateData(t)}resetCache(){this.handle.resetCache()}}const ie=/(\\?)(\$\{(([a-zA-Z0-9\-_\s]+)::)?([^\{\}]+)\})/,ne=new Yt,se=t=>t instanceof Yt?t:new Yt(t),re=async function(t,e,i,n){if(i&&t.name!=i)return t.parent?re(t.parent,e,i,n):null;const s=await async function(t,e){if("string"!=typeof t)return t;const i=new Function("context",`\nreturn (async (context) => {\n\ttry{ \n\t\twith(context){\n\t\t\t return ${t}\n\t\t}\n\t}catch(e){\n\t\tthrow e;\n\t}\n})(context)`);let n,s=setTimeout((()=>{s=null,console.warn("long running statement:",t,new Error)}),1e3);try{n=await i(e)}catch(t){}return s&&clearTimeout(s),n}(e,t.proxy.data);return null!=s?s:n instanceof Yt&&n.hasValue?n.value:void 0},ae=async(t,e,i)=>e[1]?e[2]:re(t,e[5],oe(e[4]),i),oe=t=>t?0==(t=t.trim()).length?null:t:null;class le{constructor({context:t=Wt,parent:e=null,name:i=null}){this.parent=e instanceof le?e:null,this.name=i,this.context=t,this.proxy=new ee(this.context,this)}get chain(){return this.parent?this.parent.chain+"/"+this.name:"/"+this.name}get effectiveChain(){return this.context?this.parent?this.parent.effectiveChain+"/"+this.name:"/"+this.name:this.parent?this.parent.effectiveChain:""}get contextChain(){const t=[];let e=this;for(;e;)e.context&&t.push(e.context),e=e.parent;return t}getData(t,e){if(t){if(!e||e==this.name){const e=Xt.load(this.context,t,!1);return e?e.value:null}this.parent&&this.parent.getData(t,e)}}updateData(t,e,i){t&&(i&&i!=this.name?this.parent&&this.parent.updateData(t,e,i):(null!=this.context&&void 0!==this.context||(this.context={},this.proxy.updateData(this.context)),Xt.load(this.context,t).value=e,this.proxy.resetCache()))}mergeContext(t,e){e&&e!=this.name?this.parent&&this.parent.mergeContext(t,e):this.context=this.context?Kt.merge(this.context,t):t}async resolve(t,e){const i=2==arguments.length?se(e):ne;try{const e=ie.exec(t);return e?await ae(this,e,i):await re(this,oe(t),null,i)}catch(e){return console.error('error at executing statment"',t,'":',e),i.hasValue?i.value:t}}async resolveText(t,e){let i=t,n=t,s=ie.exec(i);const r=2==arguments.length?se(e):ne;for(;null!=s;){const t=await ae(this,s,r);n=n.split(s[0]).join(),i=i.split(s[0]).join(void 0===t?"undefined":null==t?"null":t),s=ie.exec(n)}return i}static async resolve(t,e,i,n){const s=new le({context:e}),r=arguments.length>2?se(i):ne;return"number"==typeof n&&n>0?new Promise((e=>{setTimeout((()=>{e(s.resolve(t,r))}),n)})):s.resolve(t,r)}static async resolveText(t,e,i,n){const s=new le({context:e}),r=arguments.length>2?se(i):ne;return"number"==typeof n&&n>0?new Promise((e=>{setTimeout((()=>{e(s.resolveText(t,r))}),n)})):s.resolveText(t,r)}static buildSecure({context:t,propFilter:e,option:i={deep:!0},name:n,parent:s}){return t=Kt.filter({data:t,propFilter:e,option:i}),new le({context:t,name:n,parent:s})}}const ue=t=>{window.customElements.get(t.NODENAME)||window.customElements.define(t.NODENAME,t)},ce="active",he="condition",de=[ce,he];class fe extends Gt{static get observedAttributes(){return de}static get NODENAME(){return F}constructor(){super()}async init(){await super.init(),this.active=!1}get active(){return this.hasAttribute(ce)}set active(t){t?this.attr(ce,""):this.attr(ce,void 0)}get condition(){return this.attr(he)}}ue(fe);const pe=fe,ge=({root:t,filter:e})=>{let i=[];return t.children.forEach((t=>{const{accept:n,stop:s=!1}=e(t);if(n&&i.push(t),!s){const n=ge({root:t,filter:e});n instanceof Array?i=i.concat(n):n&&i.push(n)}})),i};class ve{constructor(t,e){this.key=t,this.context=e}get keyDefined(){return this.key in this.context}get hasValue(){return!!this.context[this.key]}get value(){return this.context[this.key]}set value(t){this.context[this.key]=t}set append(t){if(this.hasValue){const e=this.value;e instanceof Array?e.push(t):this.value=[this.value,t]}else this.value=t}remove(){delete this.context[this.key]}static load(t,e,i=!0){let n=t;const s=e.split(".");let r=s.shift().trim();for(;s.length>0;){if(!n[r]){if(!i)return null;n[r]={}}n=n[r],r=s.shift().trim()}return new ve(r,n)}}const me=function(t){return void 0!==t&&null!=t&&"Object"===t.constructor.name},ye=function(t,...e){t||(t={});for(let i of e)me(i)&&Object.getOwnPropertyNames(i).forEach((e=>{me(t[e])?ye(t[e],i[e]):t[e]=i[e]}));return t},be=function(){const[t,e,{deep:i=!1,recursive:n=!0,parents:s=[]}={}]=arguments,r={};for(let a in t){const o=t[a],l=e(a,o,t);!l||i&&null!=o?l&&i&&("object"!=typeof o||o instanceof Array||o instanceof Map||o instanceof Set||o instanceof RegExp||s.includes[o]||o==t?r[a]=o:r[a]=be(o,e,{deep:i,recursive:n,parents:s.concat(t)})):r[a]=o}return r},_e={isPojo:me,append:function(t,e,i){return void 0!==e&&(ve.load(i,t,!0).append=e),i},merge:ye,filter:be,buildPropertyFilter:function({names:t,allowed:e}){return(i,n,s)=>t.includes(i)===e},defValue:(t,e,i)=>{Object.defineProperty(t,e,{value:i,writable:!1,configurable:!1,enumerable:!1})},defGet:(t,e,i)=>{Object.defineProperty(t,e,{get:i,configurable:!1,enumerable:!1})},defGetSet:(t,e,i,n)=>{Object.defineProperty(t,e,{get:i,set:n,configurable:!1,enumerable:!1})}},we=async t=>{const e={};e.$value=await t.value();let i=t.parent(H),n=e;for(;i;)n.$item=await i.value(),n=n.$item,i=i.parent(H);return _e.merge(e,await t.form.data())},Ee=[ct,mt,At];class xe extends Bt{static get observedAttributes(){return Ee.concat(Bt.observedAttributes)}constructor(t=null){super(),this.__value__=t,this.__valueChanged__=!0,this.on(tt,(t=>{t.target==this&&this.conditionUpdated()}))}async init(){await super.init(),this.ready.resolved||(this.parentField=(t=>{let e=this.parentNode;for(;e;){if(e instanceof xe)return e;e=e.parentNode}return null})(),this.validator=new class{constructor(t){var e;this.inital=!0,this.base=t,this.customChecks=[],this.validations=ge({root:e=t,filter:t=>{if(e!=t){if(t instanceof Ae)return{accept:!1,stop:!0};if(t instanceof pe)return{accept:!0,stop:!0}}return{accept:!1}}})||[],this.condition=t.attr(yt),this.editableCondition=t.attr(Et)}addCustomCheck(t){this.customChecks.push(t)}get form(){return this.base.form}async validate(){const{base:t,validations:e,customChecks:i,condition:n,editableCondition:s}=this,{hasValue:r,required:a,requiredOnlyOnActive:o}=t,l=(i.length>0||e.length,await we(t));this.inital,this.inital=!1;const u=!n||await le.resolve(n,l,!1);((t,e,i=!1)=>{const n=t.condition;e?(t.attr(Mt,null),t.attr(Tt,"")):(t.attr(Tt,null),t.attr(Mt,"")),(n!=e||i)&&t.trigger(tt)})(t,u,this.inital);let c=!a||r;if(u){if(c)for(let e of i)await e({data:l,base:t})||(c=!1);for(let t of e)if(c&&r){const e=await le.resolve(t.condition,l,!0);t.active=!e,e||(c=!1)}else t.active=!1;const n=(async({data:t,valid:e,base:i,condition:n})=>{const{form:s}=i;if(s.state==B)if(e){if(n){const e=await le.resolve(n,t,!1);return i.editable=e,e}}else i.readonly=!1;return e})({data:l,valid:c,base:t,condition:s});n||(c=!0),((t,e,i=!1)=>{const n=t.valid;void 0===e||null==e?(t.attr(Pt,null),t.attr(Nt,null)):e?(t.attr(Pt,null),t.attr(Nt,"")):(t.attr(Pt,""),t.attr(Nt,null)),(n!=e||i)&&t.trigger(et)})(t,c,this.inital)}return c}}(this),this.form.on(K,(async t=>{t.detail.indexOf(this)<0&&this.valid!=await this.validate()&&this.publishValue()})),this.form.on(st,(()=>{this.publishValue()}))),this.validate()}conditionUpdated(){this.active=this.condition}get name(){return this.getAttribute(ct)}get required(){return this.hasAttribute(mt)}get hasValue(){const t=this.__value__;return null!=t&&void 0!==t}async value(){if(0==arguments.length)return this.__value__;let t=arguments[0];await this.ready,await this.acceptValue(t)&&(t=await this.normalizeValue(t),this.__value__!=t&&(this.__value__=t,await this.updatedValue(t),await this.validate(),this.publishValue()))}async validate(){var t;return t=this.hasValue,this.attr(At,t?null:""),!!this.validator&&await this.validator.validate()}async publishValue(t=[]){t.push(this),this.parentField?await this.parentField.childValueChanged(this,t):this.trigger(Z,t)}async acceptValue(t){return!0}async normalizeValue(t){return t}async updatedValue(){}async childValueChanged(t,e){}}const Ae=xe;class Ne{static findInput(t){return null}constructor(t,e){this.field=t,this.input=e,this.init()}init(){}set readonly(t){}async acceptValue(t){return!0}async normalizeValue(t){return t}async updatedValue(){}get value(){return null}get valid(){return!0}}const Pe={accept:t=>t instanceof Date,value:t=>t.valueAsDate,normalize:t=>t||null},Te={text:{accept:t=>"string"==typeof t,value:t=>t.value,normalize:t=>t&&(t=t.trim()).length>0?t:null},number:{accept:t=>"number"==typeof t,value:t=>t.valueAsNumber,normalize:t=>(t=>null==t||void 0===t)(t)||Number.isNaN(t)?null:t},date:Pe,time:Pe},Me=(t,e)=>new Promise(((i,n)=>{const s=new FileReader;s.addEventListener("loadend",(()=>{i({name:t.name,type:t.type,size:t.size,data:s.result})}),!1),s[e](t)})),Ve={"form-input":async t=>(t.format="form-input",t),"data-url-base64":async t=>{const e=await Me(t,"readAsDataURL");return e.format="data-url-base64",e},base64:async t=>{const e=await Me(t,"readAsDataURL");return e.data=e.data.substr(e.data.indexOf(",")+1),e.format="base64",e}},Ce=async(t,e,i)=>{let n=[];for(let i of t)n.push(await Ve[e](i));return 0==n.length?null:i?n:n[0]},Le=[class extends Ne{static findInput(t){return t.find('input:not([type="file"]):not([type="radio"]):not([type="checkbox"]) ,input:not([type]), textarea').first()}constructor(t,e){super(t,e)}init(){const{field:t,input:e}=this,i=(t.attr("input-type")||e.attr("type")||"text").trim().toLowerCase();this.type=Te[i]||Te.text,e.on("input",Lt((()=>{t.trigger(Q,this.normalizeValue(this.value))}),!1,!0)),t.trigger(Q,this.normalizeValue(this.value))}acceptValue(t){return null==t||void 0===t||this.type.accept(t)}normalizeValue(t){return null==t&&void 0===t?null:this.type.normalize(t)}async updatedValue(t){t!=this.input.value&&this.input.val(t||null)}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){return this.type.value(this.input)}get valid(){return this.input.checkValidity()}},class extends Ne{static findInput(t){const e=t.find('input[type="checkbox"]');return 0==e.length?null:1==e.length?e.first():e}constructor(t,e){super(t,e)}init(){const{field:t,input:e}=this;this.multiple=e instanceof NodeList,e.on("input",Lt((()=>{t.trigger(Q,this.normalizeValue(this.value))}),!1,!0,500)),t.trigger(Q,this.normalizeValue(this.value))}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){const t=this.input.val();if(!(t instanceof Map))return t;if(0==t.size)return null;const e=[];return t.forEach((t=>{e.push(t)})),e}normalizeValue(t){return t?this.multiple?0!=(t=t.filter((t=>!!t))).length?t:null:t:null}acceptValue(t){if(null==t||void 0===t)return!0;if(this.multiple)return t instanceof Array;{const e=typeof t;return"string"===e||"boolean"===e}}updatedValue(t){this.field.value!=this.value&&this.input.val(t||null)}},class extends Ne{static findInput(t){const e=t.find('input[type="radio"]');return 0==e.length?null:e}constructor(t,e){super(t,e)}init(){const{field:t,input:e}=this,i=t.name+Math.floor(Math.random()*Date.now());for(let t of e)t.name=i;e.on("input",Lt((()=>{t.trigger(Q,this.normalizeValue(this.value))}),!1,!0,500)),t.trigger(Q,this.normalizeValue(this.value))}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){const t=this.input.val();return t instanceof Map?0==t.size?null:t.values().next().value:t}normalizeValue(t){return t||null}acceptValue(t){if(null==t||void 0===t)return!0;{const e=typeof t;return"string"===e||"boolean"===e}}updatedValue(t){this.field.value!=this.value&&this.input.val(t||null)}},class extends Ne{static findInput(t){return t.find('input[type="file"]').first()}constructor(t,e){super(t,e)}async init(){const{field:t,input:e}=this;this.multiple=e.multiple,this.format=t.attr("file-format")||"form-input",this.filenameTarget=t.attr("file-name-target"),this.filenameTarget=this.filenameTarget?t.find(this.filenameTarget).first():null;const{format:i,multiple:n}=this;e.on("input",Lt((async()=>{this.updatedValue(await Ce(e.files,i,n)),t.trigger(Q,this.value)}),!1,!0)),e.files&&0!=e.files.length&&this.updatedValue(await Ce(e.files,i,n)),t.trigger(Q,this.value)}set readonly(t){this.input.attr("disabled",t?"":null)}acceptValue(t){return null==t||void 0===t||(this.multiple?t instanceof Array:t instanceof"object")}normalizeValue(t){return null==t||void 0===t?null:this.multiple?0!=t.length?t:null:t}updatedValue(t){if(t!=this.__value__&&(this.__value__=t,this.filenameTarget&&t))if(this.multiple)for(let e of t)this.filenameTarget.append(`<span>${e.name}</span>`);else this.filenameTarget.append(`<span>${t.name}</span>`)}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){return this.__value__}get valid(){return this.input.checkValidity()}},class extends Ne{static findInput(t){return t.find("select").first()}constructor(t,e){super(t,e)}init(){const{field:t,input:e}=this;e.on("input, changed",Lt((()=>{t.trigger(Q,this.value)}),!1,!0,500)),t.trigger(Q,this.value)}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){return this.normalizeValue(this.input.multiple?this.input.val():this.input.value)}normalizeValue(t){return t?this.input.multiple?0!=(t=t.filter((t=>t&&t.trim().length>0))).length?t:null:0!=(t=t.trim()).length?t:null:null}acceptValue(t){return null==t||void 0===t||(this.input.multiple?t instanceof Array:"string"==typeof t)}updatedValue(t){this.field.value!=this.value&&this.input.val(t||null)}}],Oe=["file-format"];class De extends Ae{static get observedAttributes(){return Oe.concat(Ae.observedAttributes)}static get NODENAME(){return k}constructor(){super(),this.__valueChanged__=!0,this.on(Q,(t=>{t.preventDefault(),t.stopPropagation();const e=t.detail?t.detail:null,i=!!this.__valueChanged__||this.__value__!=e;i&&(this.__valueChanged__=i,this.__value__=e,(async()=>{await this.validate(),await this.publishValue()})())}))}async init(){await super.init(),this.ready.resolved||(this.wrapper=(t=>{for(let e of Le){const i=e.findInput(t);if(i)return new e(t,i)}return null})(this),this.wrapper&&this.validator.addCustomCheck((async()=>this.wrapper.valid))),this.__valueChanged__=!0,this.publishValue()}readonlyUpdated(){this.wrapper&&(this.wrapper.readonly=this.readonly)}async acceptValue(t){return!!this.wrapper&&this.wrapper.acceptValue(t)}async normalizeValue(t){return this.wrapper?this.wrapper.normalizeValue(t):t}async updatedValue(t){await this.ready,this.__valueChanged__=!0,this.wrapper&&await this.wrapper.updatedValue(t)}async publishValue(t=[]){this.__valueChanged__&&(await super.publishValue(t),this.__valueChanged__=!1)}}ue(De);const ke=De,Se=[],ze=/\./g,He=function(t,e,i){if(null==t||void 0===t)return null;const n=arguments.length>2,s=e.split(ze);for(;s.length>1;){const e=s.shift();let i=t[e];const r="undefiend"!=typeof i&&null!=i;if(!r&&!n)return null;!r&&n&&(i=t[e]={}),t=i}if(!n)return t[s[0]]?t[s[0]]:null;t[s[0]]=i};class Ie extends Ae{static get observedAttributes(){return Se.concat(Ae.observedAttributes)}static get NODENAME(){return U}constructor(t=null){super(t||{}),this.fields=[],this.on(Z,(t=>{const e=t.target;if(e!=this){t.preventDefault(),t.stopPropagation();const i=t.detail;this.childValueChanged(e,i)}}))}async init(){const t=this.ready;await super.init(),this.fields=ge({root:this,filter:t=>t instanceof Ae?{accept:!0,stop:!0}:{accept:!1}}),t.resolved||(this.on(J,(t=>{if(t.target!=this){const e=t.target;e instanceof Ae&&(this.fields.indexOf(e)<0&&this.fields.push(e),t.preventDefault(),t.stopPropagation())}})),this.validator.addCustomCheck((async({data:t,base:e})=>{const{fields:i}=e;if(i){const t=i.length;for(let e=0;e<t;e++){const t=i[e];if(t.condition&&!t.valid)return!1}}return!0})))}readonlyUpdated(){const{readonly:t,fields:e}=this;if(e)for(let i of e)i.readonly=t}async updatedValue(t){this.__value__={};const{fields:e}=this;if(e)for(let i of e)i.name?await i.value(He(t,i.name)):i instanceof Ie&&await i.value(t)}async childValueChanged(t,e){await this.ready;const i=await t.name,n=await t.value();i?He(this.__value__,i,n):null!=n&&_e.merge(this.__value__,n),this.validate(),this.publishValue(e)}}ue(Ie);const je=Ie,Ue=[bt,_t],Fe=class extends Gt{static get observedAttributes(){return Ue}static init(t){}constructor(){super(),this.active=!1,this.disabled=!1,this.on("click",(t=>{t.preventDefault(),t.stopPropagation(),this.active&&!this.disabled&&this.execute()}))}async init(){await super.init(),this.form=this.parent(T)}get active(){return this.hasAttribute(bt)}set active(t){t?this.attr(bt,""):this.attr(bt,null)}get disabled(){return this.hasAttribute(_t)}set disabled(t){t?this.attr(_t,""):this.attr(_t,null)}execute(){console.log("execute")}},Re=[];ue(class extends Fe{static get observedAttributes(){return Re.concat(Re)}static get NODENAME(){return j}constructor(){super()}async init(){await super.init(),this.active=!0}execute(){this.trigger(100,lt)}});const $e=[];class Ge extends je{static get observedAttributes(){return $e.concat(je.observedAttributes)}static get NODENAME(){return H}constructor(){super()}get active(){return!0}set active(t){}get condition(){return!0}get name(){return null}}customElements.define(Ge.NODENAME,Ge);const qe=Ge,Be=[];class We extends Fe{static get observedAttributes(){return Be.concat(Be)}static get NODENAME(){return I}constructor(){super()}async init(){await super.init(),this.active=!0}execute(){this.trigger(100,ot)}}ue(We);const Xe=We,Je=[];class Qe extends Gt{static get observedAttributes(){return Je.concat(Je)}static get NODENAME(){return z}constructor(){super()}}customElements.define(Qe.NODENAME,Qe);const Ze=[Vt],Ke=async(t,e)=>{const{container:i,template:n}=t,s=document.importNode(n.content,!0).children[0];return i.append(s),e&&await s.value(e),s};class Ye extends Ae{static get observedAttributes(){return Ze.concat(Ae.observedAttributes)}static get NODENAME(){return S}constructor(t=null){super(t||[]),this.on(Z,(t=>{const e=t.target;if(e instanceof qe){t.preventDefault(),t.stopPropagation();const i=t.detail;this.childValueChanged(e,i)}})),this.on(ot,(t=>{t.preventDefault(),t.stopPropagation();const{readonly:e,__value__:i}=this;if(!e){const t=Ke(this);i.push(t.value),this.validate(),this.publishValue()}})),this.on(lt,(t=>{t.preventDefault(),t.stopPropagation();const{rows:e,readonly:i,__value__:n}=this;if(!i){const i=t.target.parent(H),s=e.indexOf(i);s>=0&&(i.remove(),e.splice(s,1),n.splice(s,1),this.validate(),this.publishValue())}}))}async init(){if(await super.init(),this.__value__=[],!this.ready.resolved){this.template=this.find("template").first(),this.container=this.find(z).first();const{container:t,template:e,validator:i}=this,n=ge({root:this,filter:t=>t instanceof Xe?{accept:!0,stop:!0}:t instanceof Ae?{accept:!1,stop:!0}:{accept:!1}})[0];i.addCustomCheck((async({})=>{const{rows:t,max:e,readonly:i}=this,s=t.length;return i||(s==e?n.disabled=!0:s<e&&(n.disabled=!1)),s<=e})),i.addCustomCheck((async()=>{const{rows:t}=this;if(t)for(let e of t)if(!e.valid)return!1;return!0}))}this.validate(),this.publishValue()}readonlyUpdated(){const{readonly:t}=this;for(let e of this.rows)e.readonly=t}get rows(){return Array.from(this.container.children)}get max(){return this.hasAttribute(Vt)?parseInt(this.attr(Vt)):Number.MAX_SAFE_INTEGER}acceptValue(t){return!t||t instanceof Array}normalizeValue(t){return t?t.filter((t=>!!t)):null}async updatedValue(t){if(this.container.children.remove(),this.__value__=t,t)for(let e of t)await Ke(this,e)}async childValueChanged(t,e){await this.ready;const i=this.rows,n=await t.value(),s=i.indexOf(t);this.__value__||(this.__value__=[]),this.__value__[s]=n,await this.validate(),await this.publishValue(e)}}ue(Ye);const ti=Ye,ei=[pt];class ii extends je{static get observedAttributes(){return ei.concat(je.observedAttributes)}static get NODENAME(){return D}constructor(){super()}async init(){await super.init()}get step(){return this.attr(pt)}conditionUpdated(){}}ue(ii);const ni=ii,si="active",ri="condition",ai=[si,ri];ue(class extends Gt{static get observedAttributes(){return ai}static get NODENAME(){return R}constructor(){super()}async init(){await super.init(),this.ready.resolved||(this.reference=(t=>{let e=this.parentNode;for(;e;){if(e instanceof Bt)return e;e=e.parentNode}return null})(),this.form=this.parent(T),this.form.on(K,(()=>{this.update()}))),this.update()}get active(){return this.hasAttribute(si)}set active(t){t?this.attr(si,""):this.attr(si,void 0)}get condition(){return this.attr(ri)}async update(){await this.ready;const t=await we(this.reference);this.active=await le.resolve(this.condition,t,!1)}});const oi=[];ue(class extends Fe{static get observedAttributes(){return oi}static get NODENAME(){return V}constructor(){super()}execute(){this.form.toPrevPage()}});const li=[];ue(class extends Fe{static get observedAttributes(){return li}static get NODENAME(){return C}constructor(){super()}execute(){this.form.toNextPage()}});const ui=[];ue(class extends Fe{static get observedAttributes(){return ui}static get NODENAME(){return L}constructor(){super()}execute(){this.form.toNextPage()}});const ci=[];ue(class extends Fe{static get observedAttributes(){return ci}static get NODENAME(){return O}constructor(){super()}execute(){this.form.submit()}});const hi={active:!0,disabled:!0},di=[];ue(class extends Gt{static get observedAttributes(){return di}static get NODENAME(){return M}constructor(){super()}async init(){await super.init(),this.ready.resolved||(this.form=this.parent(T),this.back=this.find(V).first()||hi,this.next=this.find(C).first()||hi,this.summary=this.find(L).first()||hi,this.submit=this.find(O).first()||hi,this.form.on([et,tt],(t=>{t.target instanceof ni&&this.update()})),this.form.on([nt,it],(t=>{this.update()})))}update(){const{back:t,next:e,summary:i,submit:n,form:s}=this,{activePageIndex:r,activePage:a,nextPage:o,pages:l,useSummaryPage:u,state:c}=s;t.active=!0,t.disabled=!0,e.active=!1,e.disabled=!0,i.active=!1,i.disabled=!0,n.active=!1,n.disabled=!0,c==X?(t.disabled=!0,n.active=!0):c==W?(t.disabled=!1,n.active=!0,n.disabled=!s.valid):c==B&&(t.disabled=r<=0,o||!a.valid&&r+1<l.length?(e.active=!0,e.disabled=!a.valid):u&&c==B?(i.active=!0,i.disabled=!a.valid):(n.active=!0,n.disabled=!s.valid))}});const fi=[ct,bt,xt];class pi extends HTMLElement{static get observedAttributes(){return fi}static get NODENAME(){return G}constructor(){super()}get name(){return this.attr(ct)}get active(){return this.hasAttribute(bt)}set active(t){this.active!=t&&Ot(this,t)}get readonly(){return this.hasAttribute(xt)}set readonly(t){t?this.attr(xt,""):this.attr(xt,null)}}ue(pi);const gi=[Ct];ue(class extends Gt{static get observedAttributes(){return gi}static get NODENAME(){return $}constructor(){super(),this.on("click",(({target:t})=>{if(!this.form)return;if(t==this)return;const e=t.is(G)?t:t.parent(G).first();if(!e)return;const i=this.form.state,n=this.form.pages,s=(this.form.activePageIndex,this.form.activePage),r=e.name;if(i==B||i==W){const t=((t,e,i)=>{for(let n of t){if(n.step==e&&n.condition)return n;if(n==i)return}return null})(n,r,s);t&&(this.form.activePage=t)}}))}async init(){await super.init();const t=this.ready;this.progress=0,t.resolved||(this.form=this.parent(T),this.steps=this.find(G),this.form.on([J,it,nt],(()=>{const t=this.form.state,e=this.form.activePage;if(!e)return;const i=this.form.activePageIndex,n=this.form.pages.length,s=e?e.step:q,r=Math.floor(100*i/n);for(let e of this.steps){const i=e.name;t==B?(e.active=i==s,e.readonly=!1):t==W?(e.active=i==W,e.readonly=!1):(e.active=i==X,e.readonly=!0)}this.progress=t==W||t==X?100:r,this.trigger(at)})))}get progress(){return this.attr(Ct)}set progress(t){this.style.setProperty&&this.style.setProperty("--progress",t+"%"),this.attr(Ct,Math.max(0,Math.min(t,100)))}});const vi=[ct,gt,ht,dt,ft,vt],mi=(t,e)=>{for(let i of t.pages)i.readonly=e,i.active=e};class yi extends Gt{static get observedAttributes(){return vi}static get NODENAME(){return T}constructor(){super(),this.__data__={},this.__state__=null,this.on(Z,Lt((async t=>{const e=t.target,i=await e.name,n=await e.value();i?this.__data__[i]=n:null!=n&&_e.merge(this.__data__,n),this.trigger(K,t.detail)}),!0,!0))}async init(){await super.init(),this.state=q,this.ready.resolved||(this.useSummaryPage=this.hasAttribute(gt),this.activePageIndex=-1,this.useSummaryPage=this.hasAttribute(gt),this.pages=this.find(D)),this.activePageIndex=-1,this.pages.length>0&&this.toNextPage()}get state(){return this.__state__}set state(t){const e=this.state;e==B&&t!=B?mi(this,!0):e!=B&&t==B&&(mi(this,!1),this.activePage&&(this.activePage.active=!0)),this.__state__=t,e!=t&&this.trigger(nt),this.attr(ft,this.__state__)}get valid(){for(let t of this.pages)if(!t.valid)return!1;return!0}async data(){if(0==arguments.length)return this.__data__;const t=arguments[0];if(await this.ready,this.state==B){this.__data__={};for(let e of this.pages)await e.value(null),e.name?await e.value(t[e.name]):await e.value(t);this.trigger(st)}}get activePage(){return 0<=this.activePageIndex&&this.activePageIndex<this.pages.length?this.pages[this.activePageIndex]:null}set activePage(t){const e=this.activePage;t!=e&&(e&&(e.active=!1),this.activePageIndex=this.pages.indexOf(t),t.active=!0,this.state!=B&&(this.state=B),this.trigger(it))}get prevPage(){for(let t=this.activePageIndex-1;t>=0;t--){const e=this.pages[t];if(e.condition)return e}return null}get nextPage(){if(this.pages)for(let t=this.activePageIndex+1;t<this.pages.length;t++){const e=this.pages[t];if(e.condition)return e}return null}async toPrevPage(){if(this.state!=B)this.state=B;else{const t=await this.prevPage;t&&(this.activePage=t)}}async toNextPage(){const t=await this.nextPage;t?(this.activePage=t,this.state==q&&(this._state=B)):this.useSummaryPage?this.summary():this.submit()}async summary(){this.state=W}async submit(){this.state=this.hasAttribute(vt)?B:X;const t=this.data;let e=this.attr(ht);if(e){e=await le.resolveText(e,t,e);const i=new URL(e,location.href);return await fetch(i.toString(),{method:(this.attr(dt)||"post").toLowerCase(),credentials:"include",mode:"cors",headers:{"content-type":"application/json"},body:JSON.stringify(t)})}this.trigger(rt,t)}}ue(yi);const bi=yi})();
//# sourceMappingURL=module-bundle-defaultjs-html-form.min.js.map